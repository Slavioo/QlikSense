define(["qlik", "jquery", "text!./style.css", "text!./template.html"], function (qlik, $, cssContent, template) {
    'use strict';

    $("<style>").html(cssContent).appendTo("head");

    return {
        template: template,
        definition: {
            type: "items",
            component: "accordion",
            items: {
                dimensions: {
                    uses: "dimensions",
                    min: 1
                },
                measures: {
                    uses: "measures",
                    min: 0
                },
                sorting: {
                    uses: "sorting"
                },
                settings: {
                    uses: "settings",
                    items: {
                        hideDimensions: {
                            ref: "hideDimensions",
                            label: "Hide Dimensions",
                            type: "number",
                            defaultValue: 0
                        }
                    }
                }
            }
        },
        support: {
            snapshot: true,
            export: true,
            exportData: true
        },
        paint: function ($element, layout) {
            var hideDimensions = layout.hideDimensions;

            $element.find(".qv-object-tabletest th, .qv-object-tabletest td").show(); // Show all columns

            $element.find(".qv-object-tabletest th:lt(" + hideDimensions + "), .qv-object-tabletest td:lt(" + hideDimensions + ")").hide();

            return qlik.Promise.resolve();
        },
        controller: ["$scope", function ($scope) {
            // Controller logic here
        }]
    };
});
