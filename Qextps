# Extension metadata (Slavomír Haladej)
$qextContent = @"
{
  "name": "SimpleTableExtension",
  "description": "A simple Qlik Sense table extension",
  "author": "Slavomír Haladej",
  "version": "1.0.0",
  "homepage": "",
  "repository": {
    "url": ""
  },
  "dependencies": [],
  "type": "visualization",
  "icon": "",
  "preview": "",
  "keywords": [],
  "license": "",
  "tags": []
}
"@

# Create the extension directory
$extensionDirectory = "SimpleTableExtension"
New-Item -ItemType Directory -Force -Path $extensionDirectory

# Create the QEXT file
$qextFilePath = "$extensionDirectory\SimpleTableExtension.qext"
Set-Content -Path $qextFilePath -Value $qextContent

# Create the HTML file
$htmlContent = @"
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div id="table-container">
    <table>
      <thead>
        <tr>
          <th>Column 1</th>
          <th>Column 2</th>
          <th>Column 3</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Data 1</td>
          <td>Data 2</td>
          <td>Data 3</td>
        </tr>
        <tr>
          <td>Data 4</td>
          <td>Data 5</td>
          <td>Data 6</td>
        </tr>
        <tr>
          <td>Data 7</td>
          <td>Data 8</td>
          <td>Data 9</td>
        </tr>
      </tbody>
    </table>
  </div>

  <script src="script.js"></script>
  <script>
    define(["jquery"], function ($) {
      return {
        paint: function ($element) {
          // Call the paint function from the script.js file
          paint($element);
        }
      };
    });
  </script>
</body>
</html>
"@

$htmlFilePath = "$extensionDirectory\index.html"
Set-Content -Path $htmlFilePath -Value $htmlContent

# Create the CSS file
$cssContent = @"
/* Add your custom CSS styles here */
table {
  border-collapse: collapse;
  width: 100%;
}

table th, table td {
  border: 1px solid #ddd;
  padding: 8px;
}

table th {
  background-color: #f2f2f2;
  font-weight: bold;
  text-align: left;
}
"@

$cssFilePath = "$extensionDirectory\style.css"
Set-Content -Path $cssFilePath -Value $cssContent

# Create the JavaScript file
$jsContent = @"
function paint($element) {
  // Add your JavaScript logic here
  // For example, modifying the table dynamically
}
"@

$jsFilePath = "$extensionDirectory\script.js"
Set-Content -Path $jsFilePath -Value $jsContent

# Compress the extension directory into a ZIP file
$zipPath = "$extensionDirectory.zip"
Compress-Archive -Path $extensionDirectory -DestinationPath $zipPath

# Clean up the temporary directory
Remove-Item -Path $extensionDirectory
