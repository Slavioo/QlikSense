# Set the extension name and author
$extensionName = "TableLikeExtension"
$extensionAuthor = "Your Name"

# Create the extension directory
$extensionPath = "$extensionName\"
New-Item -ItemType Directory -Force -Path $extensionPath

# Create the QEXT file
$qextContent = @"
{
  "name": "$extensionName",
  "description": "Table-like Qlik Sense extension",
  "author": "$extensionAuthor",
  "type": "visualization",
  "version": "1.0.0",
  "icon": "extension-icon.png",
  "preview": "preview.png"
}
"@
Set-Content -Path "$extensionPath$extensionName.qext" -Value $qextContent

# Create the HTML file
$htmlContent = @"
<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="$extensionName.css">
  </head>
  <body>
    <div class="qlik-table" id="table-container"></div>
    <script src="$extensionName.js"></script>
  </body>
</html>
"@
Set-Content -Path "$extensionPath$extensionName.html" -Value $htmlContent

# Create the CSS file
$cssContent = @"
.qlik-table {
  width: 100%;
  border-collapse: collapse;
}

.qlik-table th,
.qlik-table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}

.qlik-table th {
  background-color: #f2f2f2;
}
"@
Set-Content -Path "$extensionPath$extensionName.css" -Value $cssContent

# Create the JS file
$jsContent = @"
define(['jquery'], function($) {
  'use strict';

  return {
    paint: function ($element, layout) {
      var tableData = layout.qHyperCube.qDataPages[0].qMatrix;

      var html = '<table class="qlik-table">';
      html += '<thead>';
      html += '<tr>';
      
      layout.qHyperCube.qDimensionInfo.forEach(function(dimension) {
        html += '<th>' + dimension.qFallbackTitle + '</th>';
      });
      
      layout.qHyperCube.qMeasureInfo.forEach(function(measure) {
        html += '<th>' + measure.qFallbackTitle + '</th>';
      });
      
      html += '</tr>';
      html += '</thead>';
      html += '<tbody>';

      tableData.forEach(function(row) {
        html += '<tr>';

        row.forEach(function(cell) {
          html += '<td>' + cell.qText + '</td>';
        });
        
        html += '</tr>';
      });

      html += '</tbody>';
      html += '</table>';

      $element.html(html);
    }
  };
});
"@
Set-Content -Path "$extensionPath$extensionName.js" -Value $jsContent

Write-Host "Qlik Sense extension created successfully."
