# Load the XML file
$xml = [xml](Get-Content -Path 'your_xml_file.xml')

# Create an empty array to store the results
$results = @()

# Define a function to recursively extract data
function Flatten-XML($node, $path, $id) {
    foreach ($child in $node.ChildNodes) {
        $currentPath = if ($path) { "$path.$($child.Name)" } else { $child.Name }
        if ($child.HasChildNodes) {
            Flatten-XML $child $currentPath $id
        } else {
            $result = New-Object PSObject -Property @{
                "id"          = $id
                "All Parents" = $currentPath
                "Value"       = $child.InnerText
            }
            $results += $result
        }
    }
}

# Start flattening from the root node
$idCounter = 1
Flatten-XML $xml.catalog "" $idCounter

# Export the results to a CSV file
$results | Export-Csv -Path 'output.csv' -NoTypeInformation

Write-Host "XML flattened to CSV. CSV file saved as 'output.csv'."
