[xml]$xmlData = Get-Content -Path "input.xml"  # Replace with your XML file path

$flatXml = New-Object System.Xml.XmlDocument
$flatXml.AppendChild($flatXml.CreateXmlDeclaration("1.0", $null, $null))
$flatRoot = $flatXml.CreateElement("root")
$flatXml.AppendChild($flatRoot)

function Flatten-XML($node, $flatNode) {
    foreach ($child in $node.ChildNodes) {
        $flatChild = $flatXml.CreateElement($child.Name)
        $flatNode.AppendChild($flatChild)
        
        if ($child.HasChildNodes) {
            Flatten-XML $child $flatChild
        } else {
            $flatChild.InnerText = $child.InnerText
        }
    }
}

Flatten-XML $xmlData.DocumentElement $flatRoot

$flatXml.Save("flat_output.xml")  # Save the flattened XML to a file
Write-Host "XML flattening complete."
