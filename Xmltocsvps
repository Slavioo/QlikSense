[xml]$xmlData = Get-Content -Path "input.xml"  # Replace with your XML file path
$outputFilePath = "output.csv"

$recordIds = @{}
$idCounter = 1

function GetOrCreateId($property) {
    if (-not $recordIds.ContainsKey($property)) {
        $recordIds[$property] = $idCounter++
    }
    return $recordIds[$property]
}

$csvLines = $xmlData.Descendants() | Where-Object { -not $_.HasChildNodes } | ForEach-Object {
    $property = ($_.AncestorsAndSelf | ForEach-Object { $_.Name }) -join '.'
    $value = $_.InnerText.Trim()
    $id = GetOrCreateId($property)
    [PSCustomObject]@{
        Property = $property
        Value = $value
        ID = $id
    }
}

$csvLines | Export-Csv -Path $outputFilePath -NoTypeInformation -Delimiter ',' -Encoding UTF8
Write-Host "XML to CSV conversion complete."
