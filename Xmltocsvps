[xml]$xmlData = Get-Content -Path "input.xml"  # Replace with your XML file path
$outputFilePath = "flat_output.xml"

# Create a new flat XML document
$flatXml = New-Object System.Xml.XmlDocument
$flatRoot = $flatXml.CreateElement("root")
$flatXml.AppendChild($flatRoot)

# Function to recursively flatten XML elements
function Flatten-XML($node, $flatNode, $prefix = "") {
    foreach ($child in $node.ChildNodes) {
        $childName = if ($prefix -eq "") { $child.Name } else { "$prefix.$($child.Name)" }
        $flatChild = $flatXml.CreateElement($childName)

        if ($child.HasChildNodes) {
            Flatten-XML $child $flatChild $childName
        } else {
            $flatChild.InnerText = $child.InnerText
        }

        $flatNode.AppendChild($flatChild)
    }
}

# Start flattening from the root node
Flatten-XML $xmlData.DocumentElement $flatRoot

# Save the flattened XML to a file
$flatXml.Save($outputFilePath)
Write-Host "XML flattening complete. Flat XML saved to $outputFilePath"
