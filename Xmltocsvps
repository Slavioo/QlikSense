# Load the XML file
[xml]$xml = Get-Content -Path 'your_complex_xml_file.xml'

# Create an array to store the results
$results = @()

# Function to recursively process XML nodes
function Process-XMLNode($node, $path) {
    foreach ($child in $node.ChildNodes) {
        $currentPath = if ($path) { "$path.$($child.Name)" } else { $child.Name }
        if ($child.HasChildNodes) {
            Process-XMLNode $child $currentPath
        } else {
            $result = [PSCustomObject]@{
                "Property" = $currentPath -replace "\.\d+", ""  # Remove numeric suffixes
                "Value"    = $child.InnerText
            }
            $results += $result
        }
    }
}

# Start processing from the root node
Process-XMLNode $xml ''

# Export the results to a CSV file
$results | Export-Csv -Path 'output.csv' -NoTypeInformation

Write-Host "XML properties and values extracted to CSV. CSV file saved as 'output.csv'."
