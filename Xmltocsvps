# Load the XML file (replace 'yourfile.xml' with your XML file's path)
$xmlFile = "yourfile.xml"
$xmlDoc = [System.Xml.XmlDocument]::new()
$xmlDoc.Load($xmlFile)

# Initialize an array to store the flattened data
$flattenedData = @()

# Recursive function to flatten XML
function Flatten-XML($node, $parentPath, $id) {
    foreach ($child in $node.ChildNodes) {
        $path = if ($parentPath) { "$parentPath\$($node.Name)" } else { $node.Name }
        if ($child.HasChildNodes) {
            Flatten-XML $child $path $id
        } else {
            $flattenedData += [PSCustomObject]@{
                "Id"          = $id
                "All parents" = $path
                "Value"       = $child.InnerText
            }
        }
    }
}

# Start flattening from the root node
$index = 0
foreach ($person in $xmlDoc.SelectNodes('//person')) {
    $id = $index
    $index++
    Flatten-XML $person $null $id
}

# Display the flattened data (you can also export it to a CSV file)
$flattenedData | Format-Table -AutoSize
