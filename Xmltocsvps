# Load the XML file
[xml]$xml = Get-Content -Path 'your_complex_xml_file.xml'

# Create an array to store the results
$results = @()

# Select all elements in the XML
$elements = $xml.SelectNodes("//*")

# Loop through each element and extract property and value
foreach ($element in $elements) {
    $property = $element.Name
    $value = $element.InnerText
    $result = [PSCustomObject]@{
        "Property" = $property
        "Value" = $value
    }
    $results += $result
}

# Export the results to a CSV file
$results | Export-Csv -Path 'output.csv' -NoTypeInformation

Write-Host "XML properties and values extracted to CSV. CSV file saved as 'output.csv'."
