# Load the XML file
[xml]$xml = Get-Content -Path 'your_complex_xml_file.xml'

# Create an array to store the hierarchy
$hierarchy = @()

# Function to recursively build the hierarchy
function Build-Hierarchy($node, $path) {
    $result = [PSCustomObject]@{
        "Element" = $node.Name
        "Path"    = $path
    }
    $hierarchy += $result
    foreach ($child in $node.ChildNodes) {
        $currentPath = if ($path) { "$path\$($child.Name)" } else { $child.Name }
        Build-Hierarchy $child $currentPath
    }
}

# Start building the hierarchy from the root node
Build-Hierarchy $xml ''

# Export the hierarchy to a CSV file
$hierarchy | Export-Csv -Path 'output_hierarchy.csv' -NoTypeInformation

Write-Host "XML hierarchy extracted to CSV. CSV file saved as 'output_hierarchy.csv'."
