# Load the XML file
$xmlContent = [xml](Get-Content -Path "your_complex.xml")

# Initialize an empty array to store flattened data
$flatData = @()

# Loop through each element in the XML
foreach ($record in $xmlContent.SelectNodes("//Record")) {
    $flatItem = New-Object PSObject -Property @{}

    foreach ($property in $record.ChildNodes) {
        $propertyName = $property.Name -replace '\W', '_' # Remove special characters
        $flatItem | Add-Member -MemberType NoteProperty -Name "Record_$propertyName" -Value $property.InnerText
    }

    $flatData += $flatItem
}

# Export the flattened data as XML
$flatData | Export-Clixml -Path "flattened.xml"
