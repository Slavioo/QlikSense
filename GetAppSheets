# Sample data
$appId = "123-456"
$appName = "MyApp"

$sheets = @(
    [PSCustomObject]@{
        sheetId = "1.1"
        sheetName = "MySheet A"
    },
    [PSCustomObject]@{
        sheetId = "1.2"
        sheetName = "MySheet B"
    },
    [PSCustomObject]@{
        sheetId = "1.3"
        sheetName = "MySheet C"
    }
)

# Create an array to store the XML elements
$xmlArray = @()

# Add the 'data' root element
$xmlArray += [PSCustomObject]@{
    data = [PSCustomObject]@{}
}
# Add the 'record' element for the app
$xmlArray[0].data.record += [PSCustomObject]@{
    appId = $appId
    appName = $appName
}

# Iterate through the sheets and add 'record' elements for each sheet
foreach ($sheet in $sheets) {
    $xmlArray[0].data.record += [PSCustomObject]@{
        sheetId = $sheet.sheetId
        sheetName = $sheet.sheetName
    }
}

# Convert the array of XML elements to XML
$xmlData = $xmlArray | ConvertTo-Xml -As String -NoTypeInformation

# Save the XML data to a file
$xmlData | Set-Content -Path "output.xml"
