# Sample data
$appId = "123-456"
$appName = "MyApp"

$sheets = @(
    [PSCustomObject]@{
        sheetId = "1.1"
        sheetName = "MySheet A"
    },
    [PSCustomObject]@{
        sheetId = "1.2"
        sheetName = "MySheet B"
    },
    [PSCustomObject]@{
        sheetId = "1.3"
        sheetName = "MySheet C"
    }
)

# Create an array to store the XML elements
$xmlArray = @()

# Add the app information to the XML array
$xmlArray += [PSCustomObject]@{
    record = [PSCustomObject]@{
        appId = $appId
        appName = $appName
    }
}

# Iterate through the sheets and add them to the XML array
foreach ($sheet in $sheets) {
    $xmlArray += [PSCustomObject]@{
        record = [PSCustomObject]@{
            sheetId = $sheet.sheetId
            sheetName = $sheet.sheetName
        }
    }
}

# Convert the array of XML elements to XML
$xmlData = $xmlArray | ConvertTo-Xml -As String -NoTypeInformation

# Save the XML data to a file
$xmlData | Set-Content -Path "output.xml"
