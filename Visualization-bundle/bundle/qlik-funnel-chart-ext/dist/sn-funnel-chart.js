/*
* @nebula.js/sn-funnel-chart v1.5.3
* Copyright (c) 2023 QlikTech International AB
* Released under the MIT license.
*/

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@nebula.js/stardust")):"function"==typeof define&&define.amd?define(["@nebula.js/stardust"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["sn-funnel-chart"]=e(t.stardust)}(this,(function(t){"use strict";var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;var i=function(t){var i=[],a=String(t).trim();return"M"!==a[0]&&"m"!==a[0]||a.replace(n,(function(t,n,a){var o=n.toLowerCase(),s=function(t){var e=t.match(r);return e?e.map(Number):[]}(a),u=n;if("m"===o&&s.length>2&&(i.push([u].concat(s.splice(0,2))),o="l",u="m"===u?"l":"L"),s.length<e[o])return"";for(i.push([u].concat(s.splice(0,e[o])));s.length>=e[o]&&s.length&&e[o];)i.push([u].concat(s.splice(0,e[o])));return""})),i};function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u=i;function l(t,e){var n=t.x*Math.cos(e)-t.y*Math.sin(e),r=t.y*Math.cos(e)+t.x*Math.sin(e);t.x=n,t.y=r}function c(t,e,n){t.x+=e,t.y+=n}function h(t,e){t.x*=e,t.y*=e}var f=i,d=function(t){if(void 0!==t&&t.CanvasRenderingContext2D&&(!t.Path2D||!function(t){var e=t.document.createElement("canvas").getContext("2d"),n=new t.Path2D("M0 0 L1 1");return e.strokeStyle="red",e.lineWidth=1,e.stroke(n),255===e.getImageData(0,0,1,1).data[0]}(t))){var e=function(){function t(e){var n;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.segments=[],e&&e instanceof t)?(n=this.segments).push.apply(n,o(e.segments)):e&&(this.segments=u(e))}var e,n,r;return e=t,(n=[{key:"addPath",value:function(e){var n;e&&e instanceof t&&(n=this.segments).push.apply(n,o(e.segments))}},{key:"moveTo",value:function(t,e){this.segments.push(["M",t,e])}},{key:"lineTo",value:function(t,e){this.segments.push(["L",t,e])}},{key:"arc",value:function(t,e,n,r,i,a){this.segments.push(["AC",t,e,n,r,i,!!a])}},{key:"arcTo",value:function(t,e,n,r,i){this.segments.push(["AT",t,e,n,r,i])}},{key:"ellipse",value:function(t,e,n,r,i,a,o,s){this.segments.push(["E",t,e,n,r,i,a,o,!!s])}},{key:"closePath",value:function(){this.segments.push(["Z"])}},{key:"bezierCurveTo",value:function(t,e,n,r,i,a){this.segments.push(["C",t,e,n,r,i,a])}},{key:"quadraticCurveTo",value:function(t,e,n,r){this.segments.push(["Q",t,e,n,r])}},{key:"rect",value:function(t,e,n,r){this.segments.push(["R",t,e,n,r])}}])&&a(e.prototype,n),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),n=t.CanvasRenderingContext2D.prototype.fill,r=t.CanvasRenderingContext2D.prototype.stroke;t.CanvasRenderingContext2D.prototype.fill=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i="nonzero";if(0===e.length||1===e.length&&"string"==typeof e[0])n.apply(this,e);else{2===arguments.length&&(i=e[1]);var a=e[0];s(this,a.segments),n.call(this,i)}},t.CanvasRenderingContext2D.prototype.stroke=function(t){t?(s(this,t.segments),r.call(this)):r.call(this)};var i=t.CanvasRenderingContext2D.prototype.isPointInPath;t.CanvasRenderingContext2D.prototype.isPointInPath=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("Path2D"===e[0].constructor.name){var r=e[1],a=e[2],o=e[3]||"nonzero",u=e[0];return s(this,u.segments),i.apply(this,[r,a,o])}return i.apply(this,e)},t.Path2D=e}function s(t,e){var n,r,i,a,o,s,u,f,d,p,g,v,y,m,x,b,w,k,M,_,S,C,R,q,N,A,D={x:0,y:0},O={x:0,y:0};t.beginPath();for(var E=0;E<e.length;++E){var I=e[E];switch("S"!==(_=I[0])&&"s"!==_&&"C"!==_&&"c"!==_&&(C=null,R=null),"T"!==_&&"t"!==_&&"Q"!==_&&"q"!==_&&(q=null,N=null),_){case"m":case"M":"m"===_?(g+=I[1],y+=I[2]):(g=I[1],y=I[2]),"M"!==_&&D||(D={x:g,y:y}),t.moveTo(g,y);break;case"l":g+=I[1],y+=I[2],t.lineTo(g,y);break;case"L":g=I[1],y=I[2],t.lineTo(g,y);break;case"H":g=I[1],t.lineTo(g,y);break;case"h":g+=I[1],t.lineTo(g,y);break;case"V":y=I[1],t.lineTo(g,y);break;case"v":y+=I[1],t.lineTo(g,y);break;case"a":case"A":"a"===_?(g+=I[6],y+=I[7]):(g=I[6],y=I[7]),b=I[1],w=I[2],u=I[3]*Math.PI/180,i=!!I[4],a=!!I[5],o={x:g,y:y},l(s={x:(O.x-o.x)/2,y:(O.y-o.y)/2},-u),(f=s.x*s.x/(b*b)+s.y*s.y/(w*w))>1&&(b*=f=Math.sqrt(f),w*=f),d=b*b*w*w,p=b*b*s.y*s.y+w*w*s.x*s.x,h(S={x:b*s.y/w,y:-w*s.x/b},a!==i?Math.sqrt((d-p)/p)||0:-Math.sqrt((d-p)/p)||0),r=Math.atan2((s.y-S.y)/w,(s.x-S.x)/b),n=Math.atan2(-(s.y+S.y)/w,-(s.x+S.x)/b),l(S,u),c(S,(o.x+O.x)/2,(o.y+O.y)/2),t.save(),t.translate(S.x,S.y),t.rotate(u),t.scale(b,w),t.arc(0,0,1,r,n,!a),t.restore();break;case"C":C=I[3],R=I[4],g=I[5],y=I[6],t.bezierCurveTo(I[1],I[2],C,R,g,y);break;case"c":t.bezierCurveTo(I[1]+g,I[2]+y,I[3]+g,I[4]+y,I[5]+g,I[6]+y),C=I[3]+g,R=I[4]+y,g+=I[5],y+=I[6];break;case"S":null!==C&&null!==R||(C=g,R=y),t.bezierCurveTo(2*g-C,2*y-R,I[1],I[2],I[3],I[4]),C=I[1],R=I[2],g=I[3],y=I[4];break;case"s":null!==C&&null!==R||(C=g,R=y),t.bezierCurveTo(2*g-C,2*y-R,I[1]+g,I[2]+y,I[3]+g,I[4]+y),C=I[1]+g,R=I[2]+y,g+=I[3],y+=I[4];break;case"Q":q=I[1],N=I[2],g=I[3],y=I[4],t.quadraticCurveTo(q,N,g,y);break;case"q":q=I[1]+g,N=I[2]+y,g+=I[3],y+=I[4],t.quadraticCurveTo(q,N,g,y);break;case"T":null!==q&&null!==N||(q=g,N=y),q=2*g-q,N=2*y-N,g=I[1],y=I[2],t.quadraticCurveTo(q,N,g,y);break;case"t":null!==q&&null!==N||(q=g,N=y),q=2*g-q,N=2*y-N,g+=I[1],y+=I[2],t.quadraticCurveTo(q,N,g,y);break;case"z":case"Z":g=D.x,y=D.y,D=void 0,t.closePath();break;case"AC":g=I[1],y=I[2],x=I[3],r=I[4],n=I[5],A=I[6],t.arc(g,y,x,r,n,A);break;case"AT":v=I[1],m=I[2],g=I[3],y=I[4],x=I[5],t.arcTo(v,m,g,y,x);break;case"E":g=I[1],y=I[2],b=I[3],w=I[4],u=I[5],r=I[6],n=I[7],A=I[8],t.save(),t.translate(g,y),t.rotate(u),t.scale(b,w),t.arc(0,0,1,r,n,A),t.restore();break;case"R":g=I[1],y=I[2],k=I[3],M=I[4],D={x:g,y:y},t.rect(g,y,k,M)}O.x=g,O.y=y}}};"undefined"!=typeof window&&d(window);var p={path2dPolyfill:d,parsePath:f},g=Object.prototype.hasOwnProperty,v=Object.prototype.toString,y=Object.defineProperty,m=Object.getOwnPropertyDescriptor,x=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===v.call(t)},b=function(t){if(!t||"[object Object]"!==v.call(t))return!1;var e,n=g.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&g.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||g.call(t,e)},w=function(t,e){y&&"__proto__"===e.name?y(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},k=function(t,e){if("__proto__"===e){if(!g.call(t,e))return;if(m)return m(t,e).value}return t[e]},M=function t(){var e,n,r,i,a,o,s=arguments[0],u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=k(s,n),s!==(i=k(e,n))&&(c&&i&&(b(i)||(a=x(i)))?(a?(a=!1,o=r&&x(r)?r:[]):o=r&&b(r)?r:{},w(s,{name:n,newValue:t(c,o,i)})):void 0!==i&&w(s,{name:n,newValue:i}));return s},_="1.10.0";function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){D(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,U(r.key),r)}}function A(t,e,n){return e&&N(t.prototype,e),n&&N(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function D(t,e,n){return(e=U(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function j(t,e,n){return(j=T()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&I(i,n.prototype),i}).apply(null,arguments)}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return P(t)}function F(t){var e=T();return function(){var n,r=E(t);if(e){var i=E(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z(this,n)}}function L(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function B(){return(B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=L(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(this,arguments)}function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(t,e)||W(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t){return function(t){if(Array.isArray(t))return V(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||W(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){if(t){if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(t,e):void 0}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function U(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function Y(t){return!!t.changedTouches}function X(t){return"number"==typeof t&&!isNaN(t)}function K(t){return"number"!=typeof t||isNaN(t)}function G(t){for(var e=t.length,n=NaN,r=NaN,i=NaN,a=NaN,o=0;o<e;o++)n=isNaN(n)?t[o].x:Math.min(n,t[o].x),r=isNaN(r)?t[o].x:Math.max(r,t[o].x),i=isNaN(i)?t[o].y:Math.min(i,t[o].y),a=isNaN(a)?t[o].y:Math.max(a,t[o].y);return[n,i,r,a]}function Z(t){return[{x:t.x1||0,y:t.y1||0},{x:t.x2||0,y:t.y2||0}]}function J(t){return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}]}function Q(t){var e=H(G(t),4),n=e[0],r=e[1];return{x:n,y:r,width:e[2]-n,height:e[3]-r}}function tt(t){return{x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}function et(t){var e=t||{},n=e.x,r=e.y,i=e.width,a=e.height,o=e.x1,s=e.x2,u=e.y1,l=e.y2,c=e.cx,h=e.cy,f=e.r,d=e.vertices;return X(c)&&X(h)&&X(f)?"circle":X(o)&&X(s)&&X(u)&&X(l)?"line":X(n)&&X(r)&&X(i)&&X(a)?"rect":X(n)&&X(r)?"point":Array.isArray(d)?d.every((function(t){return Array.isArray(t)}))?"geopolygon":"polygon":null}function nt(t,e){return{x:e.x-t,y:e.y-t,width:e.width+t,height:e.height+t}}function rt(t,e){var n=e.types,r=e.logger,i={},a=[];Array.isArray(t)?a.push.apply(a,$(t)):(r.warn('Deprecated: "data-source" configuration"'),a.push(t)),a.forEach((function(t,e){var a=n(t.type);if(a){var o=t.key;void 0===t.key&&(r.warn("Missing key for dataset. Using index '".concat(e,"' as key.")),o=e);var s=a({key:o,data:t.data,config:t.config});i[o]=s}}));return function(t){return t?i[t]:i[Object.keys(i)[0]]}}var it=Math.PI,at=2*it,ot=1e-6,st=at-ot;function ut(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function lt(){return new ut}function ct(t){return function(){return t}}ut.prototype=lt.prototype={constructor:ut,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,u=r-e,l=a-t,c=o-e,h=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>ot)if(Math.abs(c*s-u*l)>ot&&i){var f=n-a,d=r-o,p=s*s+u*u,g=f*f+d*d,v=Math.sqrt(p),y=Math.sqrt(h),m=i*Math.tan((it-Math.acos((p+h-g)/(2*v*y)))/2),x=m/y,b=m/v;Math.abs(x-1)>ot&&(this._+="L"+(t+x*l)+","+(e+x*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>l*d)+","+(this._x1=t+b*s)+","+(this._y1=e+b*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+o,l=e+s,c=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>ot||Math.abs(this._y1-l)>ot)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%at+at),h>st?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>ot&&(this._+="A"+n+","+n+",0,"+ +(h>=it)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var ht=Math.abs,ft=Math.atan2,dt=Math.cos,pt=Math.max,gt=Math.min,vt=Math.sin,yt=Math.sqrt,mt=1e-12,xt=Math.PI,bt=xt/2,wt=2*xt;function kt(t){return t>1?0:t<-1?xt:Math.acos(t)}function Mt(t){return t>=1?bt:t<=-1?-bt:Math.asin(t)}function _t(t){return t.innerRadius}function St(t){return t.outerRadius}function Ct(t){return t.startAngle}function Rt(t){return t.endAngle}function qt(t){return t&&t.padAngle}function Nt(t,e,n,r,i,a,o,s){var u=n-t,l=r-e,c=o-i,h=s-a,f=h*u-c*l;if(!(f*f<mt))return[t+(f=(c*(e-a)-h*(t-i))/f)*u,e+f*l]}function At(t,e,n,r,i,a,o){var s=t-n,u=e-r,l=(o?a:-a)/yt(s*s+u*u),c=l*u,h=-l*s,f=t+c,d=e+h,p=n+c,g=r+h,v=(f+p)/2,y=(d+g)/2,m=p-f,x=g-d,b=m*m+x*x,w=i-a,k=f*g-p*d,M=(x<0?-1:1)*yt(pt(0,w*w*b-k*k)),_=(k*x-m*M)/b,S=(-k*m-x*M)/b,C=(k*x+m*M)/b,R=(-k*m+x*M)/b,q=_-v,N=S-y,A=C-v,D=R-y;return q*q+N*N>A*A+D*D&&(_=C,S=R),{cx:_,cy:S,x01:-c,y01:-h,x11:_*(i/w-1),y11:S*(i/w-1)}}function Dt(){var t=_t,e=St,n=ct(0),r=null,i=Ct,a=Rt,o=qt,s=null;function u(){var u,l,c=+t.apply(this,arguments),h=+e.apply(this,arguments),f=i.apply(this,arguments)-bt,d=a.apply(this,arguments)-bt,p=ht(d-f),g=d>f;if(s||(s=u=lt()),h<c&&(l=h,h=c,c=l),h>mt)if(p>wt-mt)s.moveTo(h*dt(f),h*vt(f)),s.arc(0,0,h,f,d,!g),c>mt&&(s.moveTo(c*dt(d),c*vt(d)),s.arc(0,0,c,d,f,g));else{var v,y,m=f,x=d,b=f,w=d,k=p,M=p,_=o.apply(this,arguments)/2,S=_>mt&&(r?+r.apply(this,arguments):yt(c*c+h*h)),C=gt(ht(h-c)/2,+n.apply(this,arguments)),R=C,q=C;if(S>mt){var N=Mt(S/c*vt(_)),A=Mt(S/h*vt(_));(k-=2*N)>mt?(b+=N*=g?1:-1,w-=N):(k=0,b=w=(f+d)/2),(M-=2*A)>mt?(m+=A*=g?1:-1,x-=A):(M=0,m=x=(f+d)/2)}var D=h*dt(m),O=h*vt(m),E=c*dt(w),I=c*vt(w);if(C>mt){var T,j=h*dt(x),P=h*vt(x),z=c*dt(b),F=c*vt(b);if(p<xt&&(T=Nt(D,O,z,F,j,P,E,I))){var L=D-T[0],B=O-T[1],H=j-T[0],$=P-T[1],W=1/vt(kt((L*H+B*$)/(yt(L*L+B*B)*yt(H*H+$*$)))/2),V=yt(T[0]*T[0]+T[1]*T[1]);R=gt(C,(c-V)/(W-1)),q=gt(C,(h-V)/(W+1))}}M>mt?q>mt?(v=At(z,F,D,O,h,q,g),y=At(j,P,E,I,h,q,g),s.moveTo(v.cx+v.x01,v.cy+v.y01),q<C?s.arc(v.cx,v.cy,q,ft(v.y01,v.x01),ft(y.y01,y.x01),!g):(s.arc(v.cx,v.cy,q,ft(v.y01,v.x01),ft(v.y11,v.x11),!g),s.arc(0,0,h,ft(v.cy+v.y11,v.cx+v.x11),ft(y.cy+y.y11,y.cx+y.x11),!g),s.arc(y.cx,y.cy,q,ft(y.y11,y.x11),ft(y.y01,y.x01),!g))):(s.moveTo(D,O),s.arc(0,0,h,m,x,!g)):s.moveTo(D,O),c>mt&&k>mt?R>mt?(v=At(E,I,j,P,c,-R,g),y=At(D,O,z,F,c,-R,g),s.lineTo(v.cx+v.x01,v.cy+v.y01),R<C?s.arc(v.cx,v.cy,R,ft(v.y01,v.x01),ft(y.y01,y.x01),!g):(s.arc(v.cx,v.cy,R,ft(v.y01,v.x01),ft(v.y11,v.x11),!g),s.arc(0,0,c,ft(v.cy+v.y11,v.cx+v.x11),ft(y.cy+y.y11,y.cx+y.x11),g),s.arc(y.cx,y.cy,R,ft(y.y11,y.x11),ft(y.y01,y.x01),!g))):s.arc(0,0,c,w,b,g):s.lineTo(E,I)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-xt/2;return[dt(r)*n,vt(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ct(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ct(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ct(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ct(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ct(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:ct(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:ct(+t),u):o},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}function Ot(t){this._context=t}function Et(t){return new Ot(t)}function It(t){return t[0]}function Tt(t){return t[1]}function jt(){var t=It,e=null,n=ct(0),r=Tt,i=ct(!0),a=null,o=Et,s=null;function u(u){var l,c,h,f,d,p=u.length,g=!1,v=new Array(p),y=new Array(p);for(null==a&&(s=o(d=lt())),l=0;l<=p;++l){if(!(l<p&&i(f=u[l],l,u))===g)if(g=!g)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=l-1;h>=c;--h)s.point(v[h],y[h]);s.lineEnd(),s.areaEnd()}g&&(v[l]=+t(f,l,u),y[l]=+n(f,l,u),s.point(e?+e(f,l,u):v[l],r?+r(f,l,u):y[l]))}if(d)return s=null,d+""||null}function l(){return function(){var t=It,e=Tt,n=ct(!0),r=null,i=Et,a=null;function o(o){var s,u,l,c=o.length,h=!1;for(null==r&&(a=i(l=lt())),s=0;s<=c;++s)!(s<c&&n(u=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(u,s,o),+e(u,s,o));if(l)return a=null,l+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:ct(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:ct(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:ct(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o}().defined(i).curve(o).context(a)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:ct(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:ct(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:ct(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:ct(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:ct(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ct(+t),u):r},u.lineX0=u.lineY0=function(){return l().x(t).y(n)},u.lineY1=function(){return l().x(t).y(r)},u.lineX1=function(){return l().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:ct(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),u):a},u}function Pt(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function zt(t){return t}Ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Ft=Array.prototype.slice;function Lt(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Bt(t){this._context=t}function Ht(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function $t(t,e){this._context=t,this._k=(1-e)/6}Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Lt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Lt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},$t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ht(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ht(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Wt=function t(e){function n(t){return new $t(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Vt(t,e){this._context=t,this._alpha=e}Vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:!function(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>mt){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>mt){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ut=function t(e){function n(t){return e?new Vt(t,e):new $t(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Yt(t){return t<0?-1:1}function Xt(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Yt(a)+Yt(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Kt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Gt(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function Zt(t){this._context=t}function Jt(t){this._context=new Qt(t)}function Qt(t){this._context=t}function te(t){this._context=t}function ee(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function ne(t,e){this._context=t,this._t=e}function re(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],s=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function ie(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function ae(t,e){return t[e]}function oe(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}function se(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function ue(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unspecified",r=arguments.length>2?arguments[2]:void 0,i={},a=t||{get:function(){},has:function(){return!1},default:function(){}};function o(t,e){if(!t||"string"!=typeof t)throw new TypeError("Invalid argument: key must be a non-empty string");return!(t in i)&&(i[t]=e,!0)}function s(t){return i[t]||a.get(t)}function u(t){return!!i[t]||a.has(t)}function l(t){var e=i[t];return delete i[t],e}function c(){return Object.keys(i)}function h(){return Object.keys(i).map((function(t){return i[t]}))}function f(t){return void 0!==t&&(e=t),e}function d(t,i){if(void 0!==i)return o(t,i);var a=s(t);return r&&void 0===a&&r.warn("".concat(t," does not exist in ").concat(n," registry")),a||s(e)}return e=a.default(),d.add=o,d.get=s,d.has=u,d.remove=l,d.getKeys=c,d.getValues=h,d.default=f,d.register=o,d}function le(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ce(t){return(t=le(Math.abs(t)))?t[1]:NaN}Zt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Gt(this,this._t0,Kt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Gt(this,Kt(this,n=Xt(this,t,e)),n);break;default:Gt(this,this._t0,n=Xt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Jt.prototype=Object.create(Zt.prototype)).point=function(t,e){Zt.prototype.point.call(this,e,t)},Qt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},te.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=ee(t),i=ee(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},ne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var he,fe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function de(t){if(!(e=fe.exec(t)))throw new Error("invalid format: "+t);var e;return new pe({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function pe(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ge(t,e){var n=le(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}de.prototype=pe.prototype,pe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ve={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return ge(100*t,e)},r:ge,s:function(t,e){var n=le(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(he=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+le(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ye(t){return t}var me,xe,be,we=Array.prototype.map,ke=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Me(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ye:(e=we.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?ye:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(we.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=de(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,g=t.comma,v=t.precision,y=t.trim,m=t.type;"n"===m?(g=!0,m="g"):ve[m]||(void 0===v&&(v=12),y=!0,m="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",b="$"===f?a:/[%p]/.test(m)?u:"",w=ve[m],k=/[defgprs%]/.test(m);function M(t){var i,a,u,f=x,M=b;if("c"===m)M=w(t)+M,t="";else{var _=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:w(Math.abs(t),v),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),_&&0==+t&&"+"!==h&&(_=!1),f=(_?"("===h?h:l:"-"===h||"("===h?"":h)+f,M=("s"===m?ke[8+he/3]:"")+M+(_&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(u=t.charCodeAt(i))||u>57){M=(46===u?o+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}g&&!d&&(t=r(t,1/0));var S=f.length+t.length+M.length,C=S<p?new Array(p-S+1).join(e):"";switch(g&&d&&(t=r(C+t,C.length?p-M.length:1/0),C=""),n){case"<":t=f+t+M+C;break;case"=":t=f+C+t+M;break;case"^":t=C.slice(0,S=C.length>>1)+f+t+M+C.slice(S);break;default:t=C+f+t+M}return s(t)}return v=void 0===v?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return t+""},M}return{format:h,formatPrefix:function(t,e){var n=h(((t=de(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ce(e)/3))),i=Math.pow(10,-r),a=ke[8+r/3];return function(t){return n(i*t)+a}}}}!function(t){me=Me(t),xe=me.format,be=me.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var _e=new Date,Se=new Date;function Ce(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return Ce((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return _e.setTime(+e),Se.setTime(+r),t(_e),t(Se),Math.floor(n(_e,Se))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Re=864e5,qe=6048e5,Ne=Ce((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/Re}),(function(t){return t.getDate()-1})),Ae=Ne;function De(t){return Ce((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/qe}))}Ne.range;var Oe=De(0),Ee=De(1),Ie=De(2),Te=De(3),je=De(4),Pe=De(5),ze=De(6);Oe.range,Ee.range,Ie.range,Te.range,je.range,Pe.range,ze.range;var Fe=Ce((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Fe.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ce((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Le=Fe;Fe.range;var Be=Ce((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Re}),(function(t){return t.getUTCDate()-1})),He=Be;function $e(t){return Ce((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/qe}))}Be.range;var We=$e(0),Ve=$e(1),Ue=$e(2),Ye=$e(3),Xe=$e(4),Ke=$e(5),Ge=$e(6);We.range,Ve.range,Ue.range,Ye.range,Xe.range,Ke.range,Ge.range;var Ze=Ce((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Ze.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ce((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Je=Ze;function Qe(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function tn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function en(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function nn(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,u=t.shortMonths,l=cn(i),c=hn(i),h=cn(a),f=hn(a),d=cn(o),p=hn(o),g=cn(s),v=hn(s),y=cn(u),m=hn(u),x={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:On,e:On,f:Pn,g:Xn,G:Gn,H:En,I:In,j:Tn,L:jn,m:zn,M:Fn,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:xr,s:br,S:Ln,u:Bn,U:Hn,V:Wn,w:Vn,W:Un,x:null,X:null,y:Yn,Y:Kn,Z:Zn,"%":mr},b={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Jn,e:Jn,f:rr,g:pr,G:vr,H:Qn,I:tr,j:er,L:nr,m:ir,M:ar,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:xr,s:br,S:or,u:sr,U:ur,V:cr,w:hr,W:fr,x:null,X:null,y:dr,Y:gr,Z:yr,"%":mr},w={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return _(t,e,n,r)},d:kn,e:kn,f:qn,g:mn,G:yn,H:_n,I:_n,j:Mn,L:Rn,m:wn,M:Sn,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:bn,Q:An,s:Dn,S:Cn,u:dn,U:pn,V:gn,w:fn,W:vn,x:function(t,e,r){return _(t,n,e,r)},X:function(t,e,n){return _(t,r,e,n)},y:mn,Y:yn,Z:xn,"%":Nn};function k(t,e){return function(n){var r,i,a,o=[],s=-1,u=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(o.push(t.slice(u,s)),null!=(i=rn[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),u=s+1);return o.push(t.slice(u,s)),o.join("")}}function M(t,e){return function(n){var r,i,a=en(1900,void 0,1);if(_(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=tn(en(a.y,0,1))).getUTCDay(),r=i>4||0===i?Ve.ceil(r):Ve(r),r=He.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Qe(en(a.y,0,1))).getDay(),r=i>4||0===i?Ee.ceil(r):Ee(r),r=Ae.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?tn(en(a.y,0,1)).getUTCDay():Qe(en(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,tn(a)):Qe(a)}}function _(t,e,n,r){for(var i,a,o=0,s=e.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in rn?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),{format:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t+="",!0);return e.toString=function(){return t},e}}}Ze.range;var rn={"-":"",_:" ",0:"0"},an=/^\s*\d+/,on=/^%/,sn=/[\\^$*+?|[\]().{}]/g;function un(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function ln(t){return t.replace(sn,"\\$&")}function cn(t){return new RegExp("^(?:"+t.map(ln).join("|")+")","i")}function hn(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function fn(t,e,n){var r=an.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function dn(t,e,n){var r=an.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function pn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function gn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function vn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function yn(t,e,n){var r=an.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function mn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function xn(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function bn(t,e,n){var r=an.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function wn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function kn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Mn(t,e,n){var r=an.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function _n(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Sn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Cn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Rn(t,e,n){var r=an.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function qn(t,e,n){var r=an.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Nn(t,e,n){var r=on.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function An(t,e,n){var r=an.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Dn(t,e,n){var r=an.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function On(t,e){return un(t.getDate(),e,2)}function En(t,e){return un(t.getHours(),e,2)}function In(t,e){return un(t.getHours()%12||12,e,2)}function Tn(t,e){return un(1+Ae.count(Le(t),t),e,3)}function jn(t,e){return un(t.getMilliseconds(),e,3)}function Pn(t,e){return jn(t,e)+"000"}function zn(t,e){return un(t.getMonth()+1,e,2)}function Fn(t,e){return un(t.getMinutes(),e,2)}function Ln(t,e){return un(t.getSeconds(),e,2)}function Bn(t){var e=t.getDay();return 0===e?7:e}function Hn(t,e){return un(Oe.count(Le(t)-1,t),e,2)}function $n(t){var e=t.getDay();return e>=4||0===e?je(t):je.ceil(t)}function Wn(t,e){return t=$n(t),un(je.count(Le(t),t)+(4===Le(t).getDay()),e,2)}function Vn(t){return t.getDay()}function Un(t,e){return un(Ee.count(Le(t)-1,t),e,2)}function Yn(t,e){return un(t.getFullYear()%100,e,2)}function Xn(t,e){return un((t=$n(t)).getFullYear()%100,e,2)}function Kn(t,e){return un(t.getFullYear()%1e4,e,4)}function Gn(t,e){var n=t.getDay();return un((t=n>=4||0===n?je(t):je.ceil(t)).getFullYear()%1e4,e,4)}function Zn(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+un(e/60|0,"0",2)+un(e%60,"0",2)}function Jn(t,e){return un(t.getUTCDate(),e,2)}function Qn(t,e){return un(t.getUTCHours(),e,2)}function tr(t,e){return un(t.getUTCHours()%12||12,e,2)}function er(t,e){return un(1+He.count(Je(t),t),e,3)}function nr(t,e){return un(t.getUTCMilliseconds(),e,3)}function rr(t,e){return nr(t,e)+"000"}function ir(t,e){return un(t.getUTCMonth()+1,e,2)}function ar(t,e){return un(t.getUTCMinutes(),e,2)}function or(t,e){return un(t.getUTCSeconds(),e,2)}function sr(t){var e=t.getUTCDay();return 0===e?7:e}function ur(t,e){return un(We.count(Je(t)-1,t),e,2)}function lr(t){var e=t.getUTCDay();return e>=4||0===e?Xe(t):Xe.ceil(t)}function cr(t,e){return t=lr(t),un(Xe.count(Je(t),t)+(4===Je(t).getUTCDay()),e,2)}function hr(t){return t.getUTCDay()}function fr(t,e){return un(Ve.count(Je(t)-1,t),e,2)}function dr(t,e){return un(t.getUTCFullYear()%100,e,2)}function pr(t,e){return un((t=lr(t)).getUTCFullYear()%100,e,2)}function gr(t,e){return un(t.getUTCFullYear()%1e4,e,4)}function vr(t,e){var n=t.getUTCDay();return un((t=n>=4||0===n?Xe(t):Xe.ceil(t)).getUTCFullYear()%1e4,e,4)}function yr(){return"+0000"}function mr(){return"%"}function xr(t){return+t}function br(t){return Math.floor(+t/1e3)}var wr=ue();wr("d3-number",(function(t,e,n){var r,i;function a(t){return i(t)}function o(){a.locale({decimal:n||".",thousands:e||",",grouping:[3],currency:["$",""]})}return a.locale=function(e){return r=Me(e),i=r.format(t),this},o(),a.format=function(t,i,a,s){return(a||s)&&(e=a,n=s,o()),r.format(t)(i)},a.pattern=function(e){return e&&(t=e,i=r.format(e)),t},a})),wr("d3-time",(function(t){var e=nn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),n=e.format(t);function r(t){return n(t)}return r.format=function(t,n){return e.format(t)(n)},r.locale=function(){return e=nn.apply(void 0,arguments),n=e.format(t),this},r.parse=function(t,n){return e.parse(t)(n)},r.parsePattern=function(t){return e.parse(t)},r}));var kr={id:function(t){return"".concat(t.source,"/").concat(t.key||t.title)},key:function(t){return String(t.key||t.title)},tags:function(t){return t.tags},min:function(t){return t.min},max:function(t){return t.max},type:function(t){return t.type},title:function(t){return String(t.title)},values:function(t){return t.values},value:function(t){return t},label:function(t){return t},formatter:function(t){return function(t){if("function"==typeof t.formatter)return t.formatter();var e=t.formatter||{};return wr(e.type||"d3-number")(e.format||"")}(t)}};function Mr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id,r=void 0===n?kr.id:n,i=e.key,a=void 0===i?kr.key:i,o=e.min,s=void 0===o?kr.min:o,u=e.max,l=void 0===u?kr.max:u,c=e.type,h=void 0===c?kr.type:c,f=e.tags,d=void 0===f?kr.tags:f,p=e.title,g=void 0===p?kr.title:p,v=e.values,y=void 0===v?kr.values:v,m=e.value,x=void 0===m?kr.value:m,b=e.label,w=void 0===b?kr.label:b,k=e.formatter,M=void 0===k?kr.formatter:k,_={id:function(){return r(t)},key:function(){return a(t)},raw:function(){return t},tags:function(){return d(t)},type:function(){return h(t)},min:function(){return s(t)},max:function(){return l(t)},title:function(){return g(t)},items:function(){return y(t)},formatter:function(){return M(t)},value:x,label:w};return _}function _r(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];for(var r=0;r<n.fields.length;r++)if(n.fields[r].key()===t)return n.fields[r];for(var i=0;i<n.fields.length;i++)if(n.fields[i].title()===t)return n.fields[i];return null}var Sr=function(t){return t.filter((function(t){return"number"==typeof t&&!isNaN(t)}))},Cr=function(t){return t.reduce((function(t,e){return t+e}),0)},Rr={first:function(t){return t[0]},last:function(t){return t[t.length-1]},min:function(t){var e=Sr(t);return e.length?Math.min.apply(null,e):NaN},max:function(t){var e=Sr(t);return e.length?Math.max.apply(null,e):NaN},sum:function(t){var e=Sr(t);return e.length?e.reduce((function(t,e){return t+e}),0):NaN},avg:function(t){var e=Sr(t),n=e.length;return n?Cr(e)/n:NaN}};function qr(t,e,n,r){var i={},a=r.field||(void 0!==t.field?e.field(t.field):null);return Object.keys(n).forEach((function(o){var s=n[o],u=i[o]={};-1!==["number","string","boolean"].indexOf(R(s))?(u.type="primitive",u.value=s):"function"==typeof s?(u.type="function",u.value=s,u.label=s,u.field=a):"object"===R(s)&&(s.fields?u.fields=s.fields.map((function(n){return qr(t,e,{main:n},r).main})):void 0!==s.field?(u.type="field",u.field=e.field(s.field),u.value=u.field.value,u.label=u.field.label):a&&(u.value=a.value,u.label=a.label,u.field=a),"function"==typeof s.filter&&(u.filter=s.filter),void 0!==s.value&&(u.value=s.value),void 0!==s.label&&(u.label=s.label),"function"==typeof s.reduce?u.reduce=s.reduce:s.reduce?u.reduce=Rr[s.reduce]:u.field&&u.field.reduce&&(u.reduce="string"==typeof u.field.reduce?Rr[u.field.reduce]:u.field.reduce),"function"==typeof s.reduceLabel?u.reduceLabel=s.reduceLabel:s.reduceLabel?u.reduceLabel=Rr[s.reduceLabel]:u.field&&u.field.reduceLabel&&(u.reduceLabel="string"==typeof u.field.reduceLabel?Rr[u.field.reduceLabel]:u.field.reduceLabel))})),i}function Nr(t,e){var n=qr(t,e,{main:{value:t.value,label:t.label,reduce:t.reduce,filter:t.filter}},{}).main;return{props:qr(t,e,t.props||{},n),main:n}}function Ar(t,e,n,r){for(var i,a=Array(t.length),o=Array(t.length),s=0;s<t.length;s++)i=r?t[s][r]:t[s],a[s]=i.value,o[s]=i.label;var u=e.reduce,l=e.reduceLabel,c=u?u(a):a,h={value:c,label:l?l(o,c):n?n(c):String(c)};return r&&t[0][r].source?(h.source=t[0][r].source,h):!r&&t[0].source?(h.source=t[0].source,h):h}function Dr(t,e){var n=e.main,r=e.propsArr,i=e.props,a=[],o=n.field.formatter(),s={};return r.forEach((function(t){s[t]=i[t].field?i[t].field.formatter():function(t){return t}})),a.push.apply(a,$(t.map((function(t){var e=Ar(t.items,n,o);return r.forEach((function(n){e[n]=Ar(t.items,i[n],s[n],n)})),e})))),a}function Or(t){var e=t.cfg,n=t.itemData,r=t.obj,i=t.target,a=t.tracker,o="function"===t.trackType?e.trackBy(n):n[e.trackBy],s=a[o];s||(s=a[o]={items:[],id:o},i.push(s)),s.items.push(r)}function Er(t){if(t.length<1e4)return Math.max.apply(Math,$(t));for(var e=-1/0,n=t.length,r=0;r<n;r++)e<t[r]&&(e=t[r]);return e}function Ir(t){if(t.length<1e4)return Math.min.apply(Math,$(t));for(var e=1/0,n=t.length,r=0;r<n;r++)e>t[r]&&(e=t[r]);return e}var Tr={diverging:function(t,e){if((s=t.length)>0)for(var n,r,i,a,o,s,u=0,l=t[e[0]].length;u<l;++u)for(a=o=0,n=0;n<s;++n)(i=(r=t[e[n]][u])[1]-r[0])>=0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):r[0]=a},none:re,silhouette:function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}re(t,e)}},expand:function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}re(t,e)}},wiggle:function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,u=0,l=0;s<i;++s){for(var c=t[e[s]],h=c[o][1]||0,f=(h-(c[o-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}u+=h,l+=f*h}n[o-1][1]+=n[o-1][0]=a,u&&(a-=l/u)}n[o-1][1]+=n[o-1][0]=a,re(t,e)}}},jr={ascending:function(t){var e=t.map(se);return ie(t).sort((function(t,n){return e[t]-e[n]}))},insideout:function(t){var e,n,r=t.length,i=t.map(se),a=function(t){var e=t.map(oe);return ie(t).sort((function(t,n){return e[t]-e[n]}))}(t),o=0,s=0,u=[],l=[];for(e=0;e<r;++e)n=a[e],o<s?(o+=i[n],u.push(n)):(s+=i[n],l.push(n));return l.reverse().concat(u)},none:ie,reverse:function(t){return ie(t).reverse()}};function Pr(t,e,n){for(var r={},i=e.stackKey,a=e.value,o=e.startProp||"start",s=e.endProp||"end",u=e.offset||"none",l=e.order||"none",c=e.valueRef||"",h=0,f={},d=0;d<t.items.length;d++){var p=t.items[d],g=c?p[c]:null;if(g&&g.source){var v="".concat(g.source.key||"","/").concat(g.source.field);f[v]||(f[v]=g.source)}var y=i(p);r[y]=r[y]||{items:[]},r[y].items.push(p),h=Math.max(h,r[y].items.length)}for(var m=Array.apply(null,{length:h}).map(Number.call,Number),x=Object.keys(r).map((function(t){return r[t].items})),b=function(){var t=ct([]),e=ie,n=re,r=ae;function i(i){var a,o,s=t.apply(this,arguments),u=i.length,l=s.length,c=new Array(l);for(a=0;a<l;++a){for(var h,f=s[a],d=c[a]=new Array(u),p=0;p<u;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(a=0,o=e(c);a<l;++a)c[o[a]].index=a;return n(c,o),c}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:ct(Ft.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:ct(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?ie:"function"==typeof t?t:ct(Ft.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?re:t,i):n},i}().keys(m).value((function(t,e){return t[e]?a(t[e]):0})).order(jr[l]).offset(Tr[u])(x),w=[],k=0;k<b.length;k++)for(var M=b[k],_=0;_<M.length;_++){var S=M[_],C=M[_].data[M.key];C&&(C[o]={value:S[0]},C[s]={value:S[1]},w.push(S[0],S[1]))}var R=Object.keys(f).map((function(t){var e=n(f[t].key);return e?e.field(f[t].field):null})).filter((function(t){return!!t})),q=Mr({title:R.map((function(t){return t.title()})).join(", "),min:Ir(w),max:Er(w),type:"measure",formatter:R[0]?R[0].formatter:void 0});t.fields.push(q)}function zr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={},i=n.logger;if(Array.isArray(t))r.items=t.map((function(t){return{value:t,label:String(t)}}));else if(t){if("collection"in t)r=C({},e.collection(t.collection));else{var a=e.dataset?e.dataset(t.source):null,o=t.value||function(t){return t},s=t.label||function(t){return t};if(t.groupBy||t.mapTo)i.warn('Deprecated "data" configuration',t),r.items=[];else if(t.hierarchy)r.root=a.hierarchy?a.hierarchy(t.hierarchy):null,r.fields=a.fields();else if(t.items)r.items=t.items.map((function(t){return{value:o(t),label:String(s(t))}}));else if(t.extract){var u=Array.isArray(t.extract)?t.extract:[t.extract];r.items=[];var l=[];u.forEach((function(t){var n=t.source?e.dataset(t.source):a;n&&(r.items=[].concat($(r.items),$(n.extract(t))),void 0!==t.field&&l.push(n.field(t.field)))})),l.length&&(r.fields=l),t.amend&&Array.isArray(t.amend)&&(r.items=[].concat($(r.items),$(t.amend)))}else if(void 0!==t.field&&a){var c=a.field(t.field);c&&(r.fields||(r.fields=[]),r.fields.push(c),"value"in t||(o=c.value||function(t){return t},s=c.label||function(t){return t},r.value=o),r.items=c.items().map((function(e){return{value:o(e),label:String(s(e)),source:{field:t.field}}})))}else t.fields&&t.fields.forEach((function(t){var n,i="object"===R(t)&&t.source?e.dataset(t.source):a;i&&((n="object"===R(t)&&void 0!==t.field?i.field(t.field):i.field(t))&&(r.fields||(r.fields=[]),r.fields.push(n)))}));r.items&&t.map&&(r.items=r.items.map(t.map))}t&&t.stack&&Pr(r,t.stack,e.dataset)}return t&&!Array.isArray(t)&&"function"==typeof t.filter&&r.items&&(r.items=r.items.filter(t.filter)),t&&!Array.isArray(t)&&"function"==typeof t.sort&&r.items&&(r.items=r.items.sort(t.sort)),r}function Fr(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zr,i={};(t||[]).forEach((function(t){if(!t.key)throw new Error('Data collection is missing "key" property');if("object"===R(t.data)&&"collection"in t.data)throw new Error("Data config for collections may not reference other collections");i[t.key]=function(){return r(t.data,e,n)}}));var a=function(t){var e,n;if("string"==typeof t?e=t:"object"===R(t)&&(e=t.key,n=t),!(e in i))throw new Error("Unknown data collection: ".concat(e));"function"==typeof i[e]&&(i[e]=i[e]());var r=i[e];if(n&&n.fields&&n.fields.filter){var a=r.fields.filter(n.fields.filter);r.fields.length!==a.length&&(r=M(r,{fields:a}))}return r};return a}function Lr(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zr;if(t.data){var a=i(t.data,e,n);if(a&&a.fields&&a.fields[0])return a.fields[0].formatter()}if(r=t.formatter?"".concat(t.formatter,"-").concat(t.type||"number"):t.type||"d3-number",n.formatter.has(r)){var o=n.formatter.get(r)(t.format||"");return o}throw new Error("Formatter of type '".concat(r,"' was not found"))}function Br(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Lr,i={};return{get:function(a){var o;return"string"==typeof a&&t[a]?o=a:"object"===R(a)&&"formatter"in a&&t[a.formatter]?o=a.formatter:"object"===R(a)&&"type"in a&&t[a.type]&&(o=a.type),o?(i[o]=i[o]||r(t[o],e,n),i[o]):r(a||{},e,n)},all:function(){return Object.keys(t).forEach(this.get),i}}}function Hr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var $r,Wr=(1===($r=Hr).length&&($r=function(t){return function(e,n){return Hr(t(e),n)}}($r)),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;$r(t[i],e)<0?n=i+1:r=i}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;$r(t[i],e)>0?r=i:n=i+1}return n}}).right;function Vr(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}var Ur=Math.sqrt(50),Yr=Math.sqrt(10),Xr=Math.sqrt(2);function Kr(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Ur?10:a>=Yr?5:a>=Xr?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Ur?10:a>=Yr?5:a>=Xr?2:1)}function Gr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var Zr="$";function Jr(){}function Qr(t,e){var n=new Jr;if(t instanceof Jr)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}function ti(){}Jr.prototype=Qr.prototype={constructor:Jr,has:function(t){return Zr+t in this},get:function(t){return this[Zr+t]},set:function(t,e){return this[Zr+t]=e,this},remove:function(t){var e=Zr+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Zr&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Zr&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Zr&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Zr&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Zr&&++t;return t},empty:function(){for(var t in this)if(t[0]===Zr)return!1;return!0},each:function(t){for(var e in this)e[0]===Zr&&t(this[e],e.slice(1),this)}};var ei=Qr.prototype;ti.prototype={constructor:ti,has:ei.has,add:function(t){return this[Zr+(t+="")]=t,this},remove:ei.remove,clear:ei.clear,values:ei.keys,size:ei.size,empty:ei.empty,each:ei.each};var ni=Array.prototype,ri=ni.map,ii=ni.slice,ai={name:"implicit"};function oi(){var t=Qr(),e=[],n=[],r=ai;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==ai)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Qr();for(var r,a,o=-1,s=n.length;++o<s;)t.has(a=(r=n[o])+"")||t.set(a,e.push(r));return i},i.range=function(t){return arguments.length?(n=ii.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return oi(e,n).unknown(r)},Gr.apply(i,arguments),i}function si(){var t,e,n=oi().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,u=0,l=.5;function c(){var n=r().length,c=a[1]<a[0],h=a[c-0],f=a[1-c];t=(f-h)/Math.max(1,n-s+2*u),o&&(t=Math.floor(t)),h+=(f-h-t*(n-s))*l,e=t*(1-s),o&&(h=Math.round(h),e=Math.round(e));var d=Vr(n).map((function(e){return h+t*e}));return i(c?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],c()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,c()):o},n.padding=function(t){return arguments.length?(s=Math.min(1,u=+t),c()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),c()):s},n.paddingOuter=function(t){return arguments.length?(u=+t,c()):u},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},n.copy=function(){return si(r(),a).round(o).paddingInner(s).paddingOuter(u).align(l)},Gr.apply(c(),arguments)}function ui(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function li(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ci(){}var hi=.7,fi=1/hi,di="\\s*([+-]?\\d+)\\s*",pi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",gi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vi=/^#([0-9a-f]{3,8})$/,yi=new RegExp("^rgb\\("+[di,di,di]+"\\)$"),mi=new RegExp("^rgb\\("+[gi,gi,gi]+"\\)$"),xi=new RegExp("^rgba\\("+[di,di,di,pi]+"\\)$"),bi=new RegExp("^rgba\\("+[gi,gi,gi,pi]+"\\)$"),wi=new RegExp("^hsl\\("+[pi,gi,gi]+"\\)$"),ki=new RegExp("^hsla\\("+[pi,gi,gi,pi]+"\\)$"),Mi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _i(){return this.rgb().formatHex()}function Si(){return this.rgb().formatRgb()}function Ci(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=vi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ri(e):3===n?new Di(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?qi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?qi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=yi.exec(t))?new Di(e[1],e[2],e[3],1):(e=mi.exec(t))?new Di(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=xi.exec(t))?qi(e[1],e[2],e[3],e[4]):(e=bi.exec(t))?qi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=wi.exec(t))?Ti(e[1],e[2]/100,e[3]/100,1):(e=ki.exec(t))?Ti(e[1],e[2]/100,e[3]/100,e[4]):Mi.hasOwnProperty(t)?Ri(Mi[t]):"transparent"===t?new Di(NaN,NaN,NaN,0):null}function Ri(t){return new Di(t>>16&255,t>>8&255,255&t,1)}function qi(t,e,n,r){return r<=0&&(t=e=n=NaN),new Di(t,e,n,r)}function Ni(t){return t instanceof ci||(t=Ci(t)),t?new Di((t=t.rgb()).r,t.g,t.b,t.opacity):new Di}function Ai(t,e,n,r){return 1===arguments.length?Ni(t):new Di(t,e,n,null==r?1:r)}function Di(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Oi(){return"#"+Ii(this.r)+Ii(this.g)+Ii(this.b)}function Ei(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ii(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ti(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Pi(t,e,n,r)}function ji(t){if(t instanceof Pi)return new Pi(t.h,t.s,t.l,t.opacity);if(t instanceof ci||(t=Ci(t)),!t)return new Pi;if(t instanceof Pi)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Pi(o,s,u,t.opacity)}function Pi(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function zi(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Fi(t){return function(){return t}}function Li(t){return 1==(t=+t)?Bi:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Fi(isNaN(e)?n:e)}}function Bi(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Fi(isNaN(t)?e:t)}ui(ci,Ci,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:_i,formatHex:_i,formatHsl:function(){return ji(this).formatHsl()},formatRgb:Si,toString:Si}),ui(Di,Ai,li(ci,{brighter:function(t){return t=null==t?fi:Math.pow(fi,t),new Di(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?hi:Math.pow(hi,t),new Di(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oi,formatHex:Oi,formatRgb:Ei,toString:Ei})),ui(Pi,(function(t,e,n,r){return 1===arguments.length?ji(t):new Pi(t,e,n,null==r?1:r)}),li(ci,{brighter:function(t){return t=null==t?fi:Math.pow(fi,t),new Pi(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?hi:Math.pow(hi,t),new Pi(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Di(zi(t>=240?t-240:t+120,i,r),zi(t,i,r),zi(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Hi=function t(e){var n=Li(e);function r(t,e){var r=n((t=Ai(t)).r,(e=Ai(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Bi(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function $i(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Wi(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Zi(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function Vi(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Ui(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Yi(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Zi(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Xi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ki=new RegExp(Xi.source,"g");function Gi(t,e){var n,r,i,a=Xi.lastIndex=Ki.lastIndex=0,o=-1,s=[],u=[];for(t+="",e+="";(n=Xi.exec(t))&&(r=Ki.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Ui(n,r)})),a=Ki.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}function Zi(t,e){var n,r=typeof e;return null==e||"boolean"===r?Fi(e):("number"===r?Ui:"string"===r?(n=Ci(e))?(e=n,Hi):Gi:e instanceof Ci?Hi:e instanceof Date?Vi:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?$i:Array.isArray(e)?Wi:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Yi:Ui)(t,e)}function Ji(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Qi(t){return+t}var ta=[0,1];function ea(t){return t}function na(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function ra(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function ia(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=na(i,r),a=n(o,a)):(r=na(r,i),a=n(a,o)),function(t){return a(r(t))}}function aa(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=na(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=Wr(t,e,1,r)-1;return a[n](i[n](e))}}function oa(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function sa(t,e){return function(){var t,e,n,r,i,a,o=ta,s=ta,u=Zi,l=ea;function c(){return r=Math.min(o.length,s.length)>2?aa:ia,i=a=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),s,u)))(t(l(e)))}return h.invert=function(n){return l(e((a||(a=r(s,o.map(t),Ui)))(n)))},h.domain=function(t){return arguments.length?(o=ri.call(t,Qi),l===ea||(l=ra(o)),c()):o.slice()},h.range=function(t){return arguments.length?(s=ii.call(t),c()):s.slice()},h.rangeRound=function(t){return s=ii.call(t),u=Ji,c()},h.clamp=function(t){return arguments.length?(l=t?ra(o):ea,h):l!==ea},h.interpolate=function(t){return arguments.length?(u=t,c()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}()(t,e)}function ua(t,e,n,r){var i,a=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=Ur?i*=10:a>=Yr?i*=5:a>=Xr&&(i*=2),e<t?-i:i}(t,e,n);switch((r=de(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ce(e)/3)))-ce(Math.abs(t)))}(a,o))||(r.precision=i),be(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ce(e)-ce(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-ce(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return xe(r)}function la(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=Kr(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(t-s)/o;return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return ua(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,s=i[a],u=i[o];return u<s&&(r=s,s=u,u=r,r=a,a=o,o=r),(r=Kr(s,u,n))>0?r=Kr(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=Kr(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(u/r)*r,e(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(u*r)/r,e(i)),t},t}function ca(){var t=sa(ea,ea);return t.copy=function(){return oa(t,ca())},Gr.apply(t,arguments),la(t)}function ha(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[Wr(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=ii.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=ii.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return ha().domain(e).range(n).unknown(t)},Gr.apply(i,arguments)}function fa(t){return void 0===t?function(t){return t}:function(e){return t(e)}}function da(t){return Math.max(0,Math.min(1,t))}function pa(t){return"object"===R(t)}function ga(t,e,n){for(var r=Math.abs(e-n)/(t+1),i=[],a=1;a<=t;a++){var o=a*r;i.push(e<n?e+o:e-o)}return i}function va(t,e,n){if(1===t.length)return t;for(var r=t.concat([]),i=0;i<t.length;i++){var a=t[i],o=t[i+1];0===i&&a!==n.start()?(r.push.apply(r,$(ga(e,a,o))),a-=o-a,o=t[i],r.push.apply(r,$(ga(e,a,o)))):i===t.length-1&&o!==n.end()?(o=a+(a-t[i-1]),r.push.apply(r,$(ga(e,a,o)))):r.push.apply(r,$(ga(e,a,o)))}return r.filter((function(t){return t>=n.min()&&t<=n.max()}))}function ya(t){var e=t.distance,n=t.scale,r=t.minorCount,i=void 0===r?0:r,a=t.unitDivider,o=void 0===a?100:a,s=t.formatter,u=void 0===s?void 0:s,l=K(o)||K(e)?2:Math.max(e/o,2),c=Math.min(1e3,Math.round(l)),h=n.ticks(c);h.length<=1&&(h=n.ticks(c+1));var f=i>0?va(h,i,n):h;f.sort((function(t,e){return t-e}));var d=f.map(fa(u));return f.map((function(t,e){var r=n(t);return{position:r,start:r,end:r,label:d[e],value:t,isMinor:-1===h.indexOf(t)}}))}function ma(t){var e=t.distance,n=t.scale,r=t.minorCount,i=void 0===r?0:r,a=t.unitDivider,o=void 0===a?100:a,s=t.formatter,u=void 0===s?void 0:s,l=K(o)||K(e)?2:Math.max(e/o,2),c=Math.min(1e3,Math.round(l)),h=c>10?10:c;n.nice(h);var f=n.ticks(c),d=i>0?va(f,i,n):f;d.sort((function(t,e){return t-e}));var p=d.map(fa(u));return d.map((function(t,e){var r=n(t);return{position:r,start:r,end:r,label:p[e],value:t,isMinor:-1===f.indexOf(t)}}))}function xa(t){var e,n=t.settings,r=t.scale,i=t.distance,a=t.formatter,o=void 0===a?function(t){return t}:a,s=n.minorTicks&&!K(n.minorTicks.count)?Math.min(100,n.minorTicks.count):0;if(Array.isArray(n.ticks.values))e=function(t){var e=t.values,n=t.scale,r=t.formatter,i=void 0===r?function(t){return t}:r;return e.sort((function(t,e){return(pa(t)?t.value:t)-(pa(e)?e.value:e)})).filter((function(t,e,r){var i=pa(t)?t.value:t;return i<=n.max()&&i>=n.min()&&r.indexOf(t)===e})).map((function(t){var e=pa(t),r=e?t.value:t,a=n(r);return{position:a,value:r,label:e&&void 0!==t.label?t.label:i(r),isMinor:!!e&&!!t.isMinor,start:e&&!isNaN(t.start)?da(n(t.start)):a,end:e&&!isNaN(t.end)?da(n(t.end)):a}}))}({values:n.ticks.values.filter((function(t){return"object"===R(t)?!K(t.value):!K(t)})),scale:r.copy(),formatter:o});else if(K(n.ticks.count)){e=(n.ticks.tight?ma:ya)({distance:i,minorCount:s,unitDivider:n.ticks.distance,scale:r,formatter:o}),n.ticks.forceBounds&&function(t,e,n){var r=t.map((function(t){return t.position})),i=e.range();-1===r.indexOf(i[0])?t.splice(0,0,{position:i[0],start:i[0],end:i[0],label:n(e.start()),isMinor:!1,value:e.start()}):t[0]&&t[0].isMinor&&(t[0].isMinor=!1);var a=t[t.length-1];-1===r.indexOf(i[1])?t.push({position:i[1],start:i[1],end:i[1],label:n(e.end()),isMinor:!1,value:e.end()}):a&&a.isMinor&&(a.isMinor=!1)}(e,r,o)}else{e=function(t){var e=t.count,n=t.minorCount,r=t.scale,i=t.formatter;return r.ticks((e-1)*n+e).map((function(t,e){var a=r(t);return{position:a,start:a,end:a,label:i(t),isMinor:e%(n+1)!=0,value:t}}))}({count:Math.min(1e3,n.ticks.count),minorCount:s,scale:r.copy(),formatter:o})}return e}function ba(t){var e=t.scale,n=e.domain(),r=e.data().items,i=e.labels?e.labels():n,a=e.bandwidth();return n.map((function(t,n){var o=e(t);return{position:o+a/2,label:"".concat(i[n]),data:r?r[n]:void 0,start:o,end:o+a}}))}function wa(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return Object.keys(e).forEach((function(i){var a=R(t[i]);r[i]="function"===a?t[i](n):"undefined"===a?e[i]:t[i]})),r}var ka={min:NaN,max:NaN,expand:NaN,include:[],invert:!1},Ma={tight:!1,forceBounds:!1,values:void 0,count:NaN,distance:100},_a={count:NaN};function Sa(t,e){var n=+t.min,r=+t.max,i=0,a=1;if(e&&e[0]){var o=e.map((function(t){return t.min()})).filter((function(t){return!isNaN(t)})),s=e.map((function(t){return t.max()})).filter((function(t){return!isNaN(t)}));if(i=o.length?Math.min.apply(Math,$(o)):Number.NaN,a=s.length?Math.max.apply(Math,$(s)):Number.NaN,isNaN(i)||isNaN(a))i=-1,a=1;else if(i===a&&0===i)i=-1,a=1;else if(i===a&&i)i-=Math.abs(.1*i),a+=Math.abs(.1*a);else if(!isNaN(t.expand)){var u=a-i;i-=u*t.expand,a+=u*t.expand}if(Array.isArray(t.include)){var l=t.include.filter((function(t){return!isNaN(t)}));i=Math.min.apply(Math,$(l).concat([i])),a=Math.max.apply(Math,$(l).concat([a]))}}return{mini:isNaN(n)?i:n,maxi:isNaN(r)?a:r}}function Ca(t,e){t.instance||(t.instance=e.copy(),t.instance.domain([e.start(),e.end()]),t.instance.clamp(!0),t.instance.range(t.invert?[1,0]:[0,1]))}function Ra(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=ca(),a={instance:null,invert:!1},o={data:n,resources:r},s=wa(e,ka,o);function u(t){return K(t)?NaN:i(t)}s.ticks=wa(e.ticks,Ma,o),s.minorTicks=wa(e.minorTicks,_a,o),u.data=function(){return n},u.invert=function(t){return i.invert(t)},u.rangeRound=function(t){return i.rangeRound(t),u},u.clamp=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return i.clamp(t),u},u.cachedTicks=function(){return t},u.clearTicksCache=function(){return t=void 0,this},u.ticks=function(e){return null!==e&&"object"===R(e)?(e.settings=e.settings||{},e.settings=M(!0,{},s,e.settings),e.scale=u,t=xa(e)):t=i.ticks(e)},u.nice=function(t){return i.nice(t),u},u.tickFormat=function(t,e){return i.tickFormat(t,e)},u.interpolate=function(t){return i.interpolate(t),u},u.domain=function(t){return arguments.length?(i.domain(t),a.instance&&a.instance.domain([u.start(),u.end()]),u):i.domain()},u.range=function(t){return arguments.length?(i.range(t),u):i.range()},u.start=function(){return u.domain()[0]},u.end=function(){return u.domain()[this.domain().length-1]},u.min=function(){return Math.min(this.start(),this.end())},u.max=function(){return Math.max(this.start(),this.end())},u.classify=function(t){for(var e=(u.start()-u.end())/t,n=[u.end()],r=[],i=e/2,a=0;a<t;a++){var o=n[n.length-1]||0,s=o+e,l=u(o+i);n.push.apply(n,[s,s]),r.push.apply(r,[l,l])}return n.pop(),u.domain(n),u.range(r),u},u.copy=function(){var t=Ra(e,n,r);return t.domain(u.domain()),t.range(u.range()),t.clamp(i.clamp()),t},u.norm=function(t){return Ca(a,u),a.instance(t)},u.normInvert=function(t){return Ca(a,u),a.instance.invert(t)};var l=Sa(s,n?n.fields:[]),c=l.mini,h=l.maxi;return u.domain([c,h]),u.range(s.invert?[1,0]:[0,1]),a.invert=s.invert,u}var qa={padding:0,paddingInner:NaN,paddingOuter:NaN,align:.5,invert:!1,maxPxStep:NaN,range:[0,1]};function Na(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={data:e,resources:n},i=wa(t,qa,r),a=e.items||[],o={},s=[],u=[];function l(t,n){t.data=function(){return e},t.datum=function(t){return a[o[t]]},t.start=function(){return t.domain()[0]},t.end=function(){return t.domain()[t.domain().length-1]},t.labels=function(){return u},t.ticks=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.scale=t,ba(e,n.trackBy)}}var c=si();l(c,t),c.pxScale=function(e){var n=i.maxPxStep;if(isNaN(n))return c;var r=c.domain().length,a=Math.max(1,r-c.paddingInner()+2*c.paddingOuter());if(a*n>=e)return c;var o=c.copy();o.type=c.type,l(o,t);var s=a*n/e,u=(1-s)*c.align();return o.range(i.invert?[s+u,u]:[u,s+u]),o};for(var h="function"==typeof t.value?t.value:function(t){return t.datum.value},f="function"==typeof t.label?t.label:function(t){return t.datum.label},d=0;d<a.length;d++){var p=M({datum:a[d]},r),g=h(p,d);-1===s.indexOf(g)&&(s.push(g),u.push(f(p,d)),o[g]=d)}return c.domain(s),c.range(i.invert?i.range.slice().reverse():i.range),c.padding(isNaN(i.padding)?0:i.padding),isNaN(i.paddingInner)||c.paddingInner(i.paddingInner),isNaN(i.paddingOuter)||c.paddingOuter(i.paddingOuter),c.align(isNaN(i.align)?.5:i.align),c}var Aa={depth:0};function Da(t,e,n){return t.ancestors().map((function(t){return e(M({datum:t.data},n))})).reverse().slice(1).toString()}function Oa(t,e,n){var r=e.ticks.depth,i=e.value,a=e.label,o=[],s=[],u={},l=[],c=0;if(!t)return{values:o,labels:s,items:u,ticks:l};t.eachAfter((function(t){if(t.depth>0){var e=Da(t,i,n),h=t.leaves()||[t],f=i(M({datum:t.data},n)),d=a(M({datum:t.data},n)),p=Array.isArray(t.children),g={key:e,count:h.length,value:f,label:d,leftEdge:Da(h[0],i,n),rightEdge:Da(h[Math.max(h.length-1,0)],i,n),node:t};p?(o.push("SPACER_".concat(c,"_SPACER")),c++):(o.push(e),s.push(d)),(r<=0&&!p||t.depth===r)&&l.push(g),u[e]=g}}));var h=t.height-1;return h>0&&o.splice(-h),{values:o,labels:s,items:u,ticks:l}}var Ea=function(t){return t.min()},Ia=function(t){return t.max()};function Ta(t,e){var n=t&&!isNaN(t.min),r=t&&!isNaN(t.max),i=n?+t.min:0,a=r?+t.max:1;if(e&&e.length){if(!n){var o=e.map(Ea).filter(X);i=o.length?Math.min.apply(Math,$(o)):i}if(!r){var s=e.map(Ia).filter(X);a=s.length?Math.max.apply(Math,$(s)):a}}return[i,a]}var ja={domain:[],range:[],invert:!1,min:NaN,max:NaN};function Pa(t,e,n){var r=t.length;if(2===r)return[e,n];var i=[],a=(n-e)/(r-1);i.push(e);for(var o=1;o<r-1;o++)i.push(e+a*o);return i.push(n),i}function za(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Ra(t,e,n).clamp(!0).interpolate(Hi),i=wa(t,ja,{data:e,resources:n}),a=Array.isArray(i.domain)&&i.domain.length,o=Array.isArray(i.range)&&i.range.length,s=r;M(!0,s,r);var u=Ta(i,e?e.fields:[]),l=H(u,2),c=l[0],h=l[1],f=a?i.domain.length:-1,d=n.theme?n.theme.palette("sequential",f>0?f:2):[],p=o?i.range:d;return s.range(i.invert?p.slice().reverse():p.slice()),s.domain(a?i.domain:Pa(s.range(),c,h)),s}var Fa={domain:[],range:[],invert:!1,min:NaN,max:NaN,nice:!1};function La(t,e,n){var r=t.length;if(2===r)return[e+(n-e)/2];for(var i=[],a=(n-e)/r,o=1;o<r;o++)i.push(e+a*o);return i}function Ba(t,e,n,r){n=t[0],r=t&&t.length>=2?t[t.length-1]:r;var i=za().domain([n,r]).range(e);return[n].concat($(function(t){for(var e=[],n=0;n<t.length-1;n++)e.push((t[n]+t[n+1])/2);return e}(t)),[r]).map((function(t){return i(t)}))}function Ha(t,e,n){var r=2===t.length?10:Math.max(1,t.length),i=ca().domain([e,n]).nice(r).ticks(r);if(!t||!t.length)return i;for(var a=Math.max(0,t.length-1);i.length>a;)i[0]-e<=n-i[i.length-1]?i.shift():i.pop();return i}var $a={domain:[],range:[]};function Wa(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=oi(),i={data:e,resources:n},a=wa(t,$a,i),o="function"==typeof t.value?t.value:function(t){return t.datum.value},s="function"==typeof t.label?t.label:function(t){return t.datum.label},u=e.items||[],l={},c=[],h=[],f=0;f<u.length;f++){var d=M({datum:u[f]},i),p=o(d,f);-1===c.indexOf(p)&&(c.push(p),h.push(s(d,f)),l[p]=f)}return r.data=function(){return e},r.labels=function(){return h},r.label=function(t){return h[c.indexOf(t)]},r.datum=function(t){return u[l[t]]},r.range(a.range),Array.isArray(a.domain)&&a.domain.length?r.domain(a.domain):r.domain(c),r}var Va={domain:[],range:[],unknown:void 0},Ua={domain:[],range:[],override:!1};var Ya=ue();function Xa(t,e,n){var r=t.data;t.source&&(n.logger.warn("Deprecated: Scale data source configuration"),r={extract:[]},(Array.isArray(t.source)?t.source:[t.source]).forEach((function(t){r.extract.push({field:t})})));var i,a=zr(r,e,n),o=t.type||function(t){return t.root?"h-band":t.fields&&t.fields[0]?-1!==t.fields.map((function(t){return"dimension"===t.type()?"band":"linear"})).indexOf("linear")?"linear":"band":"linear"}(a);return"color"===o&&(o=a.fields&&a.fields[0]&&"dimension"===a.fields[0].type()?"categorical-color":"sequential-color"),n.scale.has(o)&&((i=(i=n.scale.get(o))(t,a,{theme:n.theme,logger:n.logger})).type=o),i}function Ka(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xa,i={};return{get:function(a){var o;return"string"==typeof a&&t[a]?o=a:"object"===R(a)&&"scale"in a&&t[a.scale]&&(o=a.scale),o?(i[o]=i[o]||r(t[o],e,n),i[o]):r(a,e,n)},all:function(){return Object.keys(t).forEach(this.get),i}}}Ya("linear",Ra),Ya("band",Na),Ya("h-band",(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={data:n,resources:r},a=wa(e,qa,i);a.ticks=wa(e.ticks,Aa,i),a.value="function"==typeof e.value?e.value:function(t){return t.datum.value},a.label="function"==typeof e.label?e.label:function(t){return t.datum.value};var o=Na(a),s=Oa(n.root,a,i),u=s.values,l=s.labels,c=s.items,h=s.ticks,f=function(t){var e=String(t),n=c[e];return o(n?a.invert?n.rightEdge:n.leftEdge:e)};M(!0,f,o),f.bandwidth=function(t){var e=c[String(t)],n=o.bandwidth();if(e&&!e.isLeaf){var r=f(e.leftEdge),i=f(e.rightEdge);return Math.abs(r-i)+n}return n},f.step=function(t){var e=c[String(t)],n=e?e.count:1,r=o.step();return r*=n},f.data=function(){return n},f.datum=function(t){var e=c[String(t)];return e?e.node.data:null},f.copy=function(){return t(e,n,r)},f.labels=function(){return l},f.ticks=function(){return h.map((function(t){var e=f(t.key),n=f.bandwidth(t.key);return{position:e+n/2,label:t.label,data:t.node.data,start:e,end:e+n}}))};var d=o.pxScale;return f.pxScale=function(t){return o=d(t),f},f.domain(u),f})),Ya("sequential-color",za),Ya("threshold-color",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=ha(),i=wa(t,Fa,{data:e,resources:n}),a=Array.isArray(i.domain)&&i.domain.length,o=Array.isArray(i.range)&&i.range.length;function s(t){return K(t)?NaN:r(t)}Object.keys(r).forEach((function(t){return s[t]=r[t]}));var u=e.fields,l=Ta(i,u),c=H(l,2),h=c[0],f=c[1],d=a?i.domain.length:-1,p=n.theme?n.theme.palette("sequential",d>0?d:2):[],g=o?i.range:p,v=[];return v=a?i.domain:i.nice?Ha(g,h,f):[h+(f-h)/2],g.length>v.length+1?v=La(g,h,f):g.length<v.length+1&&(g=Ba(v,g,h,f)),s.data=function(){return e},s.range(i.invert?g.slice().reverse():g),s.domain(v),s})),Ya("categorical-color",(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Wa(e,n,r),a=r.theme,o=wa(e,Va,{data:n,resources:r});if(o.explicit=wa(e.explicit,Ua,{data:n,resources:r}),t=Array.isArray(o.range)&&0!==o.range.length?o.range.slice():a?a.palette("categorical",i.domain().length).slice():[],o.unknown)i.unknown(o.unknown);else if(a&&a.palette("unknown")){var s=a.palette("unknown");i.unknown(s[0])}if(Array.isArray(o.explicit.domain)&&o.explicit.domain.length){for(var u=i.domain().slice(),l=o.explicit.domain,c=Array.isArray(o.explicit.range)?o.explicit.range:[],h=Math.floor(u.length/t.length),f=1;f<h+1;f*=2)t=t.concat(t);if(o.explicit.override)for(var d=0;d<l.length;d++){var p=u.indexOf(l[d]);p>-1&&(t[p]=c[d])}else{var g=l.map((function(t,e){return[u.indexOf(t),t,c[e]]})).sort((function(t,e){return t[0]-e[0]}));g.forEach((function(e){var n=u.indexOf(e[1]);-1!==n&&t.splice(n,0,e[2])}))}t.length=u.length}return i.range(t),i}));var Ga={};function Za(){Za.init.call(this)}Ga.isObject=function(t){return"object"==typeof t&&null!==t},Ga.isNumber=function(t){return"number"==typeof t},Ga.isUndefined=function(t){return void 0===t},Ga.isFunction=function(t){return"function"==typeof t};var Ja=Za;Za.EventEmitter=Za,Za.prototype._events=void 0,Za.prototype._maxListeners=void 0,Za.defaultMaxListeners=10,Za.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},Za.prototype.setMaxListeners=function(t){if(!Ga.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},Za.prototype.emit=function(t){var e,n,r,i,a,o;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],Ga.isUndefined(n))return!1;if(Ga.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];n.apply(this,i)}else if(Ga.isObject(n)){for(r=arguments.length,i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];for(r=(o=n.slice()).length,a=0;a<r;a++)o[a].apply(this,i)}return!0},Za.prototype.addListener=function(t,e){var n;if(!Ga.isFunction(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Ga.isFunction(e.listener)?e.listener:e),this._events[t]?Ga.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Ga.isObject(this._events[t])&&!this._events[t].warned)&&((n=Ga.isUndefined(this._maxListeners)?Za.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,Ga.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),Ga.isFunction(console.trace)&&console.trace()));return this},Za.prototype.on=Za.prototype.addListener,Za.prototype.once=function(t,e){if(!Ga.isFunction(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},Za.prototype.removeListener=function(t,e){var n,r,i,a;if(!Ga.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||Ga.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Ga.isObject(n)){for(a=i;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},Za.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],Ga.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},Za.prototype.listeners=function(t){return this._events&&this._events[t]?Ga.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},Za.listenerCount=function(t,e){return t._events&&t._events[e]?Ga.isFunction(t._events[e])?1:t._events[e].length:0};var Qa=function(t){return Object.keys(Ja.prototype).forEach((function(e){t[e]=Ja.prototype[e]})),Ja.init(t),t};function to(){var t=0,e=0,n=0,r=0;n=n||t;var i={move:function(t){this.moveTo(n+t)},moveTo:function(a){var o=Math.max(t,Math.min(e-r,a));n!==o&&(n=o,i.emit("update"))},update:function(a){var o=!1,s=a.min;t=void 0===s?t:s;var u=a.max;e=void 0===u?e:u,void 0!==a.viewSize&&a.viewSize!==r&&(r=a.viewSize,o=!0);var l=Math.max(t,Math.min(e-r,n));n!==l&&(n=l,o=!0),o&&i.emit("update")},getState:function(){return{min:t,max:e,start:n,viewSize:r}}};return Qa(i),i}function eo(t,e){var n=t.min||0,r=t.max||0,i=t.viewSize||0,a=e||to();return a.update({min:n,max:r,viewSize:i}),a}function no(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=eo(t[r],e?e[r]:null));return n}function ro(t,e){return e[t]||(e[t]=to()),e[t]}function io(t,e){return t<=e}function ao(t,e){return t<e}function oo(t,e,n){for(var r=0;r<t.length&&e>t[r];)++r;return t[r]===e&&n&&++r,r}function so(t,e,n,r){for(var i=t.length,a=1;a<i;a+=2)if(n(t[a-1],e)&&r(e,t[a]))return!0;return!1}function uo(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[];function i(){}return i.configure=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.includeMax,i=void 0===r||r,a=n.includeMin,o=void 0===a||a;t=i?io:ao,e=o?io:ao},i.add=function(t){var e,n=t.min,i=t.max,a=oo(r,n),o=oo(r,i,!0),s=[a,o-a];a%2==0&&s.push(n),o%2==0&&s.push(i);var u=r.join(",");return(e=r).splice.apply(e,s),u!==r.join(",")},i.remove=function(t){var e,n=t.min,i=t.max,a=oo(r,n),o=oo(r,i,!0),s=[a,o-a];a%2==1&&s.push(n),o%2==1&&s.push(i);var u=r.join(",");return(e=r).splice.apply(e,s),u!==r.join(",")},i.set=function(t){var e=r.join(",");return r=[],Array.isArray(t)?t.forEach(i.add):i.add(t),e!==r.join(",")},i.clear=function(){var t=r.length>0;return r=[],t},i.containsValue=function(n){return so(r,n,e,t)},i.containsRange=function(t){var e=t.min,n=t.max,i=oo(r,e,!0),a=oo(r,n);return i===a&&a%2==1},i.toggle=function(t){return i.containsRange(t)?i.remove(t):i.add(t)},i.ranges=function(){for(var t=[],e=1;e<r.length;e+=2)t.push({min:r[e-1],max:r[e]});return t},i.configure(n),i}function lo(){var t=[];function e(){}return e.add=function(e){return-1===t.indexOf(e)&&(t.push(e),!0)},e.remove=function(e){var n=t.indexOf(e);return-1!==n&&(t.splice(n,1),!0)},e.contains=function(e){return-1!==t.indexOf(e)},e.values=function(){return t.slice()},e.clear=function(){return t=[]},e.toString=function(){return t.join(";")},e}var co={key:void 0,includeMin:!0,includeMax:!0};function ho(t){for(var e,n,r=t.items,i=t.collection,a=t.vc,o={},s=[],u=0,l=r.length;u<l;u++){i[e=r[u].key]||(i[e]=a()),n=r[u].values||[r[u].value];for(var c=0;c<n.length;c++)i[e].add(n[c])&&(o[e]=o[e]||[],o[e].push(n[c]))}for(var h=Object.keys(o),f=0,d=h.length;f<d;f++)e=h[f],s.push({id:e,values:o[e]});return s}function fo(t){for(var e,n,r=t.items,i=t.collection,a={},o=[],s=0,u=r.length;s<u;s++)if(i[e=r[s].key]){n=r[s].values||[r[s].value];for(var l=0;l<n.length;l++)i[e].remove(n[l])&&(a[e]=a[e]||[],a[e].push(n[l]))}for(var c=Object.keys(a),h=0,f=c.length;h<f;h++)e=c[h],o.push({id:e,values:a[e]});return o}function po(t){for(var e,n,r={},i=0,a=t.length;i<a;i++){e=t[i].key,n=t[i].values||[t[i].value],r[e]||(r[e]=[]);for(var o=0;o<n.length;o++){-1===r[e].indexOf(n[o])&&r[e].push(n[o])}}return r}function go(t){var e=t.key,n=t.collection,r=t.obj,i=t.fn,a=t.value;n[e]||(n[e]=i()),r[e]=r[e]||[],r[e].push(a),n[e].add(a)}function vo(t){for(var e,n,r,i=t.items,a=t.values,o=t.vc,s={},u={},l=[],c=[],h=po(i),f=Object.keys(h),d=0,p=f.length;d<p;d++)for(var g=0,v=(r=h[e=f[d]]).length;g<v;g++)n=r[g],a[e]&&a[e].contains(n)?a[e]&&a[e].contains(n)&&(u[e]=u[e]||[],u[e].push(n),a[e].remove(n)):go({key:e,value:n,collection:a,obj:s,fn:o});for(var y=Object.keys(s),m=0,x=y.length;m<x;m++)e=y[m],l.push({id:e,values:s[e]});for(var b=Object.keys(u),w=0,k=b.length;w<k;w++)e=b[w],c.push({id:e,values:u[e]});return[l,c]}function yo(t,e){for(var n,r,i=[],a=Object.keys(t),o=function(t){return-1===e[n].indexOf(t)},s=0,u=a.length;s<u;s++)n=a[s],e[n]?(r=t[n].filter(o)).length&&i.push({id:n,values:r}):i.push({id:n,values:t[n]});return i}function mo(t){for(var e,n,r=t.items,i=t.vCollection,a=t.vc,o={},s=po(r),u={},l=Object.keys(i),c=0,h=l.length;c<h;c++)u[n=l[c]]=i[n].values().slice(),delete i[n];for(var f=function(t){i[n]&&i[n].contains(t)||go({key:n,value:t,collection:i,obj:o,fn:a})},d=Object.keys(s),p=0,g=d.length;p<g;p++)s[n=d[p]].forEach(f);return e=yo(u,o),[yo(o,u),e]}function xo(t,e,n){var r=function(t,e){if(!Object.keys(e).length)return t;for(var n=t.length,r=Array(n),i=0;i<n;i++)r[i]=t[i].key in e?M({},t[i],{key:e[t[i].key]}):t[i];return r}(e,n);return t&&t.length?t.reduce((function(t,e){return e(t)}),r):r}function bo(t){return t.replace(/(-[a-z])/g,(function(t){return t.toUpperCase().replace("-","")}))}function wo(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t.toLowerCase())}))}function ko(t,e,n){var r=n.ranges,i=n.interceptors,a=n.rc,o=n.aliases,s=n.rangeConfig,u=xo(i["".concat(e,"Ranges")],t,o),l=!1;return u.forEach((function(t){var n=t.key;if(r[n]||(r[n]=a(s.sources[n]||s.default)),"set"===e)l=r[n][e](t.ranges||t.range)||l;else for(var i=t.ranges||[t.range],o=0;o<i.length;o++)l=r[n][e](i[o])||l})),l}function Mo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vc,n=void 0===e?lo:e,r=t.rc,i=void 0===r?uo:r,a=!1,o={},s={},u={},l={sources:{},default:M({},co)},c={addValues:[],removeValues:[],toggleValues:[],setValues:[],addRanges:[],setRanges:[],removeRanges:[],toggleRanges:[]},h=function(){var t={values:{},ranges:{}};return Object.keys(s).forEach((function(e){t.values[e]=s[e].values()})),Object.keys(o).forEach((function(e){t.ranges[e]=o[e].ranges()})),t},f={ls:[],clear:function(){this.ls.forEach((function(t){return t.clear()}))},start:function(){this.ls.forEach((function(t){return t.start()}))},end:function(){this.ls.forEach((function(t){return t.end()}))},update:function(){var t=h();this.ls.forEach((function(e){return e._state(t)}))},updateValues:function(){var t=h();this.ls.forEach((function(e){return e._state({values:t.values})}))},updateRanges:function(){var t=h();this.ls.forEach((function(e){return e._state({ranges:t.ranges})}))}},d={configure:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Array.isArray(t.ranges)&&t.ranges.length&&(l={sources:{},default:M({},co)},t.ranges.forEach((function(t){var e={};Object.keys(co).filter((function(t){return"key"!==t})).forEach((function(n){e[n]=void 0!==t[n]?t[n]:co[n]})),void 0!==t.key?l.sources[t.key]=e:l.default=e})),Object.keys(o).forEach((function(t){return o[t].configure(l.sources[t]||l.default)})),d.emit("update",[],[]))},link:function(t){if(d===t)throw new Error("Can't link to self");f.ls.push(t),t._state(h())},_state:function(t){if(!t)return h();if(t.values){var e=[];Object.keys(t.values).forEach((function(n){s[n]&&t.values[n].join(";")===s[n].toString()||e.push({key:n,values:t.values[n]})})),Object.keys(s).forEach((function(n){t.values[n]||e.push({key:n,values:[]})})),e.length&&d.setValues(e)}if(t.ranges){var n=[];Object.keys(t.ranges).forEach((function(e){o[e]&&t.ranges[e].join(";")===o[e].toString()||n.push({key:e,ranges:t.ranges[e]})})),Object.keys(o).forEach((function(e){t.ranges[e]||n.push({key:e,ranges:[]})})),n.length&&d.setRanges(n)}},start:function(){if(!a){a=!0;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];d.emit.apply(d,["start"].concat(e)),f.start()}},end:function(){if(a){a=!1,o={},s={};for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];d.emit.apply(d,["end"].concat(e)),f.end()}},isActive:function(){return a},clear:function(){var t=d.brushes().filter((function(t){return"value"===t.type&&t.brush.values().length})).map((function(t){return{id:t.id,values:t.brush.values()}})),e=Object.keys(o).length>0||t.length;o={},s={},e&&(d.emit("update",[],t),f.clear())},brushes:function(){var t=[];return t=(t=t.concat(Object.keys(o).map((function(t){return{type:"range",id:t,brush:o[t]}})))).concat(Object.keys(s).map((function(t){return{type:"value",id:t,brush:s[t]}})))},addValue:function(t,e){d.addValues([{key:t,value:e}])},addValues:function(t){var e=xo(c.addValues,t,u),r=ho({vc:n,collection:s,items:e});d.emit("add-values",e),r.length&&(a||(a=!0,d.emit("start")),d.emit("update",r,[]),f.updateValues())},setValues:function(t){var e=xo(c.setValues,t,u),r=mo({items:e,vCollection:s,vc:n});d.emit("set-values",e),(r[0].length>0||r[1].length>0)&&(a||(a=!0,d.emit("start")),d.emit("update",r[0],r[1]),f.updateValues())},removeValue:function(t,e){d.removeValues([{key:t,value:e}])},removeValues:function(t){var e=xo(c.removeValues,t,u),n=fo({collection:s,items:e});d.emit("remove-values",e),n.length&&(d.emit("update",[],n),f.updateValues())},addAndRemoveValues:function(t,e){var r=xo(c.addValues,t,u),i=xo(c.removeValues,e,u),o=ho({vc:n,collection:s,items:r}),l=fo({collection:s,items:i});d.emit("add-values",r),d.emit("remove-values",i),(o.length||l.length)&&(a||(a=!0,d.emit("start")),d.emit("update",o,l),f.updateValues())},toggleValue:function(t,e){d.toggleValues([{key:t,value:e}])},toggleValues:function(t){var e=xo(c.toggleValues,t,u),r=vo({items:e,values:s,vc:n});d.emit("toggle-values",e),(r[0].length>0||r[1].length>0)&&(a||(a=!0,d.emit("start")),d.emit("update",r[0],r[1]),f.updateValues())},containsValue:function(t,e){var n=u[t]||t;return!!s[n]&&s[n].contains(e)},addRange:function(t,e){d.addRanges([{key:t,range:e}])},addRanges:function(t){ko(t,"add",{ranges:o,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(a||(a=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},removeRange:function(t,e){d.removeRanges([{key:t,range:e}])},removeRanges:function(t){ko(t,"remove",{ranges:o,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(a||(a=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},setRange:function(t,e){d.setRanges([{key:t,range:e}])},setRanges:function(t){ko(t,"set",{ranges:o,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(a||(a=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},toggleRange:function(t,e){d.toggleRanges([{key:t,range:e}])},toggleRanges:function(t){ko(t,"toggle",{ranges:o,rc:i,interceptors:c,aliases:u,rangeConfig:l})&&(a||(a=!0,d.emit("start")),d.emit("update",[],[]),f.updateRanges())},containsRangeValue:function(t,e){var n=u[t]||t;return!!o[n]&&o[n].containsValue(e)},containsRange:function(t,e){var n=u[t]||t;return!!o[n]&&o[n].containsRange(e)},containsMappedData:function(t,e,n){for(var r,i,a,l,c=[],h=Object.keys(t),f=0,d=h.length;f<d;f++){if("value"===(r=h[f]))i=t,c[f]={key:"",i:f,bool:!1};else{if("source"===r)continue;i=t[r],c[f]={key:r,i:f,bool:!1}}void 0!==(a=i.source&&i.source.field)&&(void 0!==i.source.key&&(a="".concat(i.source.key,"/").concat(a)),a in u&&(a=u[a]),l=i.value,o[a]?c[f].bool=Array.isArray(l)?o[a].containsRange({min:l[0],max:l[1]}):o[a].containsValue(l):s[a]&&s[a].contains(l)&&(c[f].bool=!0))}return e?(c=c.filter((function(t){return-1!==e.indexOf(t.key)})),"and"===n?!!c.length&&!c.some((function(t){return!1===t.bool})):"xor"===n?!!c.length&&c.some((function(t){return t.bool}))&&c.some((function(t){return!1===t.bool})):c.some((function(t){return t.bool}))):c.some((function(t){return t.bool}))},intercept:function(t,e){var n=bo(t);c[n]&&c[n].push(e)},removeInterceptor:function(t,e){var n=bo(t);if(c[n]){var r=c[n].indexOf(e);-1!==r&&c[n].splice(r,1)}},removeAllInterceptors:function(t){var e=[];if(t){var n=bo(t);c[n]&&c[n].length&&e.push({name:t,handlers:c[n]})}else Object.keys(c).forEach((function(t){c[t].length&&e.push({name:wo(t),handlers:c[t]})}));e.forEach((function(t){t.handlers.slice().forEach((function(e){return d.removeInterceptor(t.name,e)}))}))},addKeyAlias:function(t,e){u[t]=e},removeKeyAlias:function(t){delete u[t]}};return Qa(d),d}function _o(t){return t*t*t}function So(t){return--t*t*t+1}function Co(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function Ro(t,e){return t.data?t.data.value:"text"===t.type?t.text:e}ue();var qo={shouldBeRemoved:!1,isInit:!1};function No(t,e,n){var r,i=t.old,a=t.current,o=e.renderer,s=[],u={nodes:[],ips:[]},l={nodes:[],ips:[]},c={nodes:[],ips:[]},h=[],f=null,d=n.trackBy||Ro,p={start:function(){var t={};if(i.forEach((function(e,n){var r=d(e,n);t[r]=e})),a.forEach((function(e,n){var r=d(e,n);t[r]?(c.ips.push(Yi(t[r],e)),c.nodes.push(e),s.push(t[r]),t[r]=!1):(u.nodes.push(e),u.ips.push(Yi(M({},e,{r:.001,opacity:0}),e)))})),Object.keys(t).forEach((function(e){t[e]&&(l.nodes.push(t[e]),l.ips.push(Yi(t[e],M({},t[e],{r:1e-4,opacity:0}))))})),h.push({name:"exiting",easing:_o,duration:200,tweens:l.ips,nodes:[].concat(s)}),h.push({name:"updating",easing:Co,duration:400,tweens:c.ips,nodes:[]}),h.push({name:"entering",easing:So,duration:200,tweens:u.ips,nodes:$(c.nodes)}),n.isMainComponent){var e,g=null===(e=n.isMainComponent)||void 0===e?void 0:e.filterFn,v=g?s.filter(g).length:s.length;!1===qo.isInit?(qo.shouldBeRemoved=0===v,qo.isInit=!0):qo.shouldBeRemoved=qo.shouldBeRemoved&&0===v}h.length&&(f=o.getScene(a),h[0].started=Date.now(),"undefined"!=typeof window&&(r=window.requestAnimationFrame(p.tick)))},tick:function(){var t=h[0];t||p.stop(),t.started||(t.started=Date.now());var e=(Date.now()-t.started)/t.duration,n=[],i=t.tweens.map((function(n){return n(t.easing(Math.min(1,e)))}));n.push.apply(n,$(i)),n.push.apply(n,$(t.nodes)),o.render(n),e>=1&&(h.shift(),h.length?"updating"===h[0].name&&qo.shouldBeRemoved&&h.shift():(!0===qo.isInit&&(qo.isInit=!1),p.stop())),r&&(r=window.requestAnimationFrame(p.tick))},stop:function(){r&&(window.cancelAnimationFrame(r),r=!1)},inProgress:function(){return!!r},get targetScene(){return f}};return p}var Ao={fontFamily:"Arial",fontSize:"13px",color:"#595959",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0,$fill:"#333333"},Do=/^\$/;function Oo(t){var e=R(t);return"object"!==e&&"function"!==e&&"undefined"!==e}function Eo(t,e,n){var r=t[e];r&&r.scale&&r.scale.pxScale?r.scale=r.scale.pxScale(n):r&&r.pxScale&&(t[e]=r.pxScale(n))}function Io(t,e){return t.pxScale?t.pxScale(e):t}var To={normalizeSettings:function(t,e,n){var r=M({},t),i=M({},e);return Object.keys(r).forEach((function(t){i[t]={};var a=r[t],o=R(a);if("function"==typeof a)i[t].fn=a;else if(Oo(a)){var s=e[t];"string"==typeof s&&Do.test(s)&&(s=Ao[s]);var u=R(s);i[t]="undefined"===u||u===o?a:s}else a&&"object"===R(a)&&("function"==typeof a.fn&&(i[t].fn=a.fn),void 0!==a.scale&&(i[t].scale=n.scale(a.scale)),"string"==typeof a.ref&&(i[t].ref=a.ref))})),Object.keys(e).forEach((function(t){if(!(t in r)){var n=e[t];"string"===R(n)&&Do.test(n)?i[t]=Ao[n]:i[t]=n}})),i},resolveForItem:function(t,e,n){for(var r={},i=Object.keys(e),a=i.length,o=t.datum,s=t.datum,u=0;u<a;u++){var l=i[u],c=e[l],h="object"===R(s)&&void 0!==c,f=h&&"string"==typeof c.ref,d=h&&l in s,p=f?s[c.ref]:d?s[l]:o;Oo(c)?r[l]=c:h&&c.fn?(c.scale&&(t.scale=c.scale),r[l]=c.fn.call(null,t,n)):h&&c.scale&&p?(r[l]=c.scale(p.value),c.scale.bandwidth&&(r[l]+=c.scale.bandwidth()/2)):f&&p?r[l]=p.value:c.fn?r[l]=c.fn.call(null,t,n):r[l]=c}return r},updateScaleSize:Eo};function jo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:To,n={};function r(r){var i=r.data,a=r.settings,o=r.defaults,s=void 0===o?{}:o,u=r.scaled,l=n.norm=e.normalizeSettings(a,s,t.chart),c={scale:t.chart.scale,formatter:t.chart.formatter};u&&Object.keys(u).forEach((function(t){l[t]&&e.updateScaleSize(l,t,u[t])}));var h=[];if(!i||!Array.isArray(i.items)){var f={data:i,resources:c},d=e.resolveForItem(f,n.norm,-1);return{settings:n.norm,item:d}}for(var p,g=0,v=i.items.length;g<v;g++){p={datum:i.items[g],data:i,resources:c};var y=e.resolveForItem(p,n.norm,g);y.data=i.items[g],h.push(y)}return{settings:n.norm,items:h}}return{resolve:r}}function Po(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.reduce((function(t,e){return Array.isArray(e.children)?(t.push.apply(t,$(Po(e.children))),t):(t.push(e),t)}),[])}function zo(t,e){var n=e.context,r=e.data,i=e.style,a=e.filter,o=e.mode,s=t.chart.brush(n),u=r,l=i.active||{},c=i.inactive||{},h=[];Object.keys(l).forEach((function(t){h.push(t)})),Object.keys(c).forEach((function(t){-1===h.indexOf(t)&&h.push(t)}));var f=[],d=!1,p=function(){var e=Po(t.nodes);return"function"==typeof a&&(e=e.filter(a)),e},g=function(){for(var t,e=p(),n=e.length,r=!1,i="function"==typeof u?u({brush:s}):u,a=function(n){if(!(t=e[n].data))return"continue";e[n].__style||(e[n].__style={},h.forEach((function(t){e[n].__style[t]=e[n][t]})));var r=s.containsMappedData(t,i,o),a=f.indexOf(e[n]),u=!1;r&&-1===a?(f.push(e[n]),u=!0):r||-1===a||(f.splice(a,1),u=!0),e[n].needToUpdate=u||d,e[n].isActive=r},g=0;g<n;g++)a(g);for(var v=function(n){if(!(t=e[n].data))return"continue";if(e[n].needToUpdate){var i=M({},e[n],e[n].__style),a=e[n].isActive;h.forEach((function(t){e[n][t]=a&&t in l?"function"==typeof l[t]?l[t].call(null,i,f):l[t]:!a&&t in c?"function"==typeof c[t]?c[t].call(null,i,f):c[t]:e[n].__style[t]})),r=!0}delete e[n].needToUpdate},y=0;y<n;y++)v(y);return d=!1,r},v=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{suppressRender:!1},n=e.suppressRender,r=p(),i=r.length,a=function(t){if(!r[t].data)return"continue";r[t].__style=r[t].__style||{},h.forEach((function(e){r[t].__style[e]=r[t][e],e in c&&(r[t][e]="function"==typeof c[e]?c[e].call(null,r[t]):c[e])}))},o=0;o<i;o++)a(o);d=!0,f.length=0,n||t.renderer.render(t.nodes)},y=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{suppressRender:!1},n=e.suppressRender,r=p(),i=r.length,a=function(t){r[t].__style&&(Object.keys(r[t].__style).forEach((function(e){r[t][e]=r[t].__style[e]})),r[t].__style=void 0)},o=0;o<i;o++)a(o);f.length=0,n||t.renderer.render(t.nodes)},m=function(){if(g()){var e="function"==typeof t.config.sortNodes?t.config.sortNodes(t):t.nodes;"function"==typeof t.config.customRender?t.config.customRender({render:t.renderer.render,nodes:e}):t.renderer.render(e)}};return s.on("start",v),s.on("end",y),s.on("update",m),{isActive:function(){return s.isActive()},update:function(){f.length=0,d=!0,g()},cleanUp:function(){s.removeListener("start",v),s.removeListener("end",y),s.removeListener("update",m)}}}function Fo(t){for(var e=t.nodes,n=t.action,r=t.chart,i=t.trigger,a=[],o=0;o<e.length;o++){var s=e[o].data;null!==s&&a.push(s)}!function(t){var e=t.dataPoints,n=t.action,r=t.chart,i=t.trigger;if(i){var a=i.data||[""],o={items:[],actionFn:"toggleRanges"},s={items:[],actionFn:"toggleValues"};-1!==["add","remove","set","toggle"].indexOf(n)&&(o.actionFn="".concat(n,"Ranges"),s.actionFn="".concat(n,"Values"));for(var u=function(t){var n=e[t];if(!n)return"continue";a.forEach((function(t){var e=n&&!t?n:n[t];if(e){var r={key:e.source.field};void 0!==e.source.key&&(r.key="".concat(e.source.key,"/").concat(e.source.field)),Array.isArray(e.value)?(r.range={min:e.value[0],max:e.value[1]},o.items.push(r)):(r.value=e.value,s.items.push(r))}}))},l=0;l<e.length;l++)u(l);i.contexts.forEach((function(t){o.items.length?r.brush(t)[o.actionFn](o.items):r.brush(t)[s.actionFn](s.items)}))}}({dataPoints:a,action:n,chart:r,trigger:i})}function Lo(t){var e=t.collisions,n=t.t,r=t.config,i=t.action,a=[],o=!1;return e.length>0&&(a=e,o=!0,"stop"===n.propagation&&(a=[e[e.length-1]])),Fo({nodes:a.map((function(t){return t.node})),action:i,chart:r.chart,data:r.data,trigger:n}),o}function Bo(t,e,n){var r=n.element().getBoundingClientRect(),i=Y(t)?function(t,e){return 1!==t.changedTouches.length?null:{x:t.changedTouches[0].clientX-e.left,y:t.changedTouches[0].clientY-e.top}}(t,r):function(t,e){return{x:t.clientX-e.left,y:t.clientY-e.top}}(t,r);return null===i||i.x<0||i.y<0||i.x>r.width||i.y>r.height?[]:(e.touchRadius>0&&Y(t)?i={cx:i.x,cy:i.y,r:e.touchRadius}:e.mouseRadius>0&&!Y(t)&&(i={cx:i.x,cy:i.y,r:e.mouseRadius}),n.itemsAt(i))}function Ho(t,e,n){return t?"function"==typeof t?t(e):t:n}function $o(t){var e=t.e,n=t.t,r=t.config;return Lo({collisions:Bo(e,n,r.renderer),t:n,config:r,action:Ho(n.action,e,"toggle")})}function Wo(t){var e=t.e,n=t.t,r=t.config;return Lo({collisions:Bo(e,n,r.renderer),t:n,config:r,action:Ho(n.action,e,"set")})}var Vo={fill:"fill",stroke:"stroke",opacity:"opacity",strokeWidth:"stroke-width",strokeLinejoin:"stroke-linejoin",fontFamily:"font-family",fontSize:"font-size",fontWeight:"font-weight",baseline:"dominant-baseline",dominantBaseline:"dominant-baseline",anchor:"text-anchor",textAnchor:"text-anchor",maxWidth:"maxWidth",transform:"transform",strokeDasharray:"stroke-dasharray",id:"id"};function Uo(t,e){Object.keys(Vo).forEach((function(n){var r=e[n];void 0!==r&&(t[Vo[n]]=r)}))}function Yo(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",r=0;r<t.length;r++){var i=t[r];n+=0===r?"M".concat(i.x," ").concat(i.y):"L".concat(i.x," ").concat(i.y),n+=" "}return e&&(n+="Z"),n}function Xo(t,e,n,r){var i=n/2,a=t-r/2,o=e-r/2,s=t-i,u=e-i;return[{x:a,y:o},{x:a,y:u},{x:a+r,y:u},{x:a+r,y:o},{x:s+n,y:o},{x:s+n,y:o+r},{x:a+r,y:o+r},{x:a+r,y:u+n},{x:a,y:u+n},{x:a,y:o+r},{x:s,y:o+r},{x:s,y:o}]}function Ko(t){return-t/180*Math.PI}function Go(t){return function(t){var e=(.5*(Math.floor(t/Math.PI*2)+2)+.25)*Math.PI,n=Math.cos(Math.abs(e-t))*Math.sqrt(2),r=n*Math.cos(t),i=n*Math.sin(t);return{x1:r<0?1:0,y1:i<0?1:0,x2:r>=0?r:r+1,y2:i>=0?i:i+1}}(Ko(t))}function Zo(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Jo(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Qo(t,e){return{x:t.x*e,y:t.y*e}}function ts(t,e){return t.x-e.x}function es(t,e){return t.y-e.y}function ns(t,e){return Math.pow(ts(t,e),2)+Math.pow(es(t,e),2)}function rs(t,e){return Math.sqrt(ns(t,e))}function is(t,e){return t.x*e.x+t.y*e.y}function as(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=Math.cos(e),i=Math.sin(e),a=Jo(t,n),o={x:r*a.x-i*a.y,y:i*a.x+r*a.y};return Zo(o,n)}var os={up:0,down:180,left:90,right:-90};function ss(t){var e=t.x,n=t.y,r=t.size,i=r/2;return{type:"rect",x:e-i,y:n-i,width:r,height:r}}var us=ue();function ls(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(n){void 0!==Vo[n]&&"transform"!==n&&(t[n]=e[n])}))}us.add("circle",(function(t){return{type:"circle",fill:"black",cx:t.x,cy:t.y,r:t.size/2}})),us.add("diamond",(function(t){var e=t.size,n=t.x-e/2,r=t.y-e/2;return{type:"path",fill:"black",d:Yo([{x:n,y:r+e/2},{x:n+e/2,y:r},{x:n+e,y:r+e/2},{x:n+e/2,y:r+e},{x:n,y:r+e/2}])}})),us.add("saltire",(function(t){var e=Ko(45),n=t.size/2,r=isNaN(t.width)?n/2:t.width,i=Math.min(r,n),a=t.size,o=Math.sin(Math.asin(-e))*(i/2);a+=2*(n/Math.sin(-e)-n),a-=2*o;var s={x:t.x,y:t.y};return{type:"path",fill:"black",d:Yo(Xo(t.x,t.y,a,i).map((function(t){return as(t,e,s)})))}})),us.add("square",(function(t){var e=t.size;return{type:"rect",fill:"black",x:t.x-e/2,y:t.y-e/2,width:e,height:e}})),us.add("triangle",(function(t){var e=t.size,n={x:t.x,y:t.y},r=os[t.direction]||0,i=e/2,a=t.x-i,o=t.y-i,s=[{x:a,y:o+e},{x:a+i,y:o},{x:a+e,y:o+e},{x:a,y:o+e}],u=Ko(r);return{type:"path",fill:"black",d:Yo(s=s.map((function(t){return as(t,u,n)})))}})),us.add("line",(function(t){var e="vertical"===t.direction,n=t.size/2,r=t.x,i=t.y;return{type:"line",stroke:"black",strokeWidth:1,x1:r-(e?0:n),y1:i-(e?n:0),x2:r+(e?0:n),y2:i+(e?n:0),collider:ss(t)}})),us.add("star",(function(t){for(var e=t.size,n=[],r=e/2,i=t.points||5,a=Math.min(t.innerRadius||e/2,e)/2,o=isNaN(t.startAngle)?90:t.startAngle,s=360/i,u=1;u<=i;u++){var l=s*u+o,c=Ko(l),h=Ko(l+s/2),f=Math.sin(c),d=Math.cos(c),p=Math.sin(h),g=Math.cos(h);n.push({x:t.x+d*r,y:t.y+f*r}),n.push({x:t.x+g*a,y:t.y+p*a})}return{type:"path",fill:"black",d:Yo(n)}})),us.add("n-polygon",(function(t){for(var e=[],n=t.size/2,r=Math.max(isNaN(t.sides)?6:t.sides,3),i=360/r,a=isNaN(t.startAngle)?0:t.startAngle,o=1;o<=r;o++){var s=Ko(i*o+a),u=Math.sin(s),l=Math.cos(s);e.push({x:t.x+l*n,y:t.y+u*n})}return{type:"path",fill:"black",d:Yo(e)}})),us.add("cross",(function(t){var e=t.x,n=t.y,r=t.size/2,i=isNaN(t.width)?r/2:t.width,a=Math.min(i,r);return{type:"path",fill:"black",d:Yo(Xo(e,n,t.size,a))}})),us.add("bar",(function(t){var e={x:t.x,y:t.y},n="vertical"===t.direction,r=t.size/2,i=r/2/2,a=[{x:e.x-r,y:e.y+i},{x:e.x-r,y:e.y-i},{x:e.x+r,y:e.y-i},{x:e.x+r,y:e.y+i}];if(n){var o=Ko(90);a=a.map((function(t){return as(t,o,e)}))}var s=Q(a);return s.type="rect",s.fill="black",s})),us.add("rect",(function(t){var e=t.x,n=t.y,r=t.size,i=void 0===t.width?r:t.width,a=void 0===t.height?r:t.height;return{type:"rect",fill:"black",x:e-i/2,y:n-a/2,width:i,height:a}}));var cs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:us;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.get(e.type);if(n){var r=n(e);return ls(r,e),void 0!==e.data&&(r.data=e.data),r}return n}};function hs(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.dock,r=void 0===n?"center":n,i=t.displayOrder,a=void 0===i?0:i,o=t.prioOrder,s=void 0===o?0:o,u=t.preferredSize,l=void 0===u?0:u,c=t.minimumLayoutMode,h=t.show,f=void 0===h||h;r=r||"center";var d={computePreferredSize:function(t){var n=t.inner,r=t.outer,i=t.children;return"function"==typeof l?l({inner:n,outer:r,children:i,dock:this.dock()},e):l},dock:function(t){return void 0!==t?(r=t,this):"function"==typeof r?r(e):r},displayOrder:function(t){return void 0!==t?(a=t,this):"function"==typeof a?a(e):a},prioOrder:function(t){return void 0!==t?(s=t,this):"function"==typeof s?s(e):s},minimumLayoutMode:function(t){return void 0!==t?(c=t,this):"function"==typeof c?c(e):c},show:function(t){return void 0!==t?(f=t,this):"function"==typeof f?f(e):f}};return d}function fs(t,e,n){var r=e.require,i=void 0===r?[]:r,a=e.mediator||{},o=n.settings,s=n.formatter,u=n.scale,l=n.data,c=n.renderer,h=n.chart,f=n.dockConfig,d=n.mediator,p=n.instance,g=n.rect,v=n.style,y=n.registries,m=n.resolver,x=n.update,b=n._DO_NOT_USE_getInfo,w=n.symbol,k=n.isVisible;t.emit=function(){},k&&(t.isVisible=k),Object.defineProperty(t,"settings",{get:o}),Object.defineProperty(t,"data",{get:l}),Object.defineProperty(t,"formatter",{get:s}),Object.defineProperty(t,"scale",{get:u}),Object.defineProperty(t,"mediator",{get:d}),Object.defineProperty(t,"style",{get:v}),Object.defineProperty(t,"registries",{get:y}),g&&Object.defineProperty(t,"rect",{get:g}),b&&(t._DO_NOT_USE_getInfo=b),Object.keys(e).forEach((function(n){var r;r=n,["on","preferredSize","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeUnmount","beforeDestroy","destroyed","defaultSettings","data","settings","formatter","scale","chart","dockConfig","mediator","style","resolver","registries","_DO_NOT_USE_getInfo","symbol","isVisible"].some((function(t){return t===r}))||("function"==typeof e[n]?t[n]=e[n].bind(t):t[n]=e[n])})),i.forEach((function(e){"renderer"===e?Object.defineProperty(t,"renderer",{get:c}):"chart"===e?Object.defineProperty(t,"chart",{get:h}):"dockConfig"===e?Object.defineProperty(t,"dockConfig",{get:f}):"instance"===e?Object.defineProperty(t,"instance",{get:p}):"update"===e&&x?Object.defineProperty(t,"update",{get:x}):"resolver"===e?Object.defineProperty(t,"resolver",{get:m}):"symbol"===e&&Object.defineProperty(t,"symbol",{get:w})})),Object.keys(a).forEach((function(e){t.mediator.on(e,a[e].bind(t))}))}function ds(t,e,n){var r=function(e){return t[e]?(n.warn("Deprecation Warning the ".concat(e," property should be moved into layout: {} property")),t[e]):t.layout?t.layout[e]:void 0},i={};return i.displayOrder=r("displayOrder"),i.dock=r("dock"),i.prioOrder=r("prioOrder"),i.minimumLayoutMode=r("minimumLayoutMode"),t.layout=t.layout||{},t.layout.displayOrder=void 0!==i.displayOrder?i.displayOrder:t.layout.displayOrder,t.layout.prioOrder=void 0!==i.prioOrder?i.prioOrder:t.layout.prioOrder,t.layout.dock=i.dock||t.layout.dock,t.layout.minimumLayoutMode=i.minimumLayoutMode||t.layout.minimumLayoutMode,i.show=t.show,i.preferredSize=e,i}function ps(t,e,n){Object.keys(n.on||{}).forEach((function(r){t.eventListeners=t.eventListeners||[];var i=n.on[r].bind(t);t.eventListeners.push({event:r,listener:i}),e.on(r,i)})),t.emit=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.emit.apply(e,[t].concat(r))}}function gs(t,e){t.eventListeners&&(t.eventListeners.forEach((function(t){var n=t.event,r=t.listener;e.removeListener(n,r)})),t.eventListeners.length=0),t.emit=function(){}}function vs(t,e,n){return Zo(function(t,e){var n=is(t,e)/is(e,e)||1;return{x:e.x*n,y:e.y*n}}(Jo(n,t),Jo(e,t)),t)}function ys(t,e,n){return rs(t,n)+rs(e,n)-rs(t,e)<1e-12}function ms(t,e){return t.x>=e.x&&t.x+t.width<=e.x+e.width&&t.y>=e.y&&t.y+t.height<=e.y+e.height}function xs(t){return t.x1===t.x2&&t.y1===t.y2}function bs(t){return t.width<=0||t.height<=0}function ws(t){return t.r<=0}function ks(t){return t.edges.length<=2}function Ms(t,e){for(var n=0,r=e.edges.length;n<r;n++)if(!0===As(t,tt(e.edges[n])))return!0;return!1}function _s(t,e){for(var n=e.numPolygons,r=e.polygons,i=0;i<n;i++){if(!0===Fs(t,r[i]))return!0}return!1}function Ss(t,e){return!ws(t)&&ns({x:t.cx,y:t.cy},e)<=Math.pow(t.r,2)}function Cs(t,e){if(bs(e)||ws(t))return!1;var n=e.width/2,r=e.height/2,i=e.x+n,a=e.y+r,o=t.r,s=t.cx,u=t.cy,l=Math.abs(s-i),c=Math.abs(u-a);return!(l>n+o||c>r+o)&&(l<=n||c<=r||Math.pow(l-n,2)+Math.pow(c-r,2)<=Math.pow(o,2))}function Rs(t,e){if(ws(t)||xs(e))return!1;var n=H(Z(e),2),r=n[0],i=n[1];if(Ss(t,r)||Ss(t,i))return!0;var a={x:t.cx,y:t.cy},o=vs(r,i,a);return ns(o,a)<=Math.pow(t.r,2)&&ys(r,i,o)}function qs(t,e){if(ks(e)||ws(t))return!1;if(Ns(e,{x:t.cx,y:t.cy}))return!0;for(var n=e.edges.length,r=0;r<n;r++){if(Rs(t,tt(e.edges[r])))return!0}return!1}function Ns(t,e){if(ks(t)||!Is(t.boundingRect(),e))return!1;var n,r,i,a,o,s=e.x,u=e.y,l=t.vertices;for(n=!1,a=-1,i=(r=l.length)-1;++a<r;i=a){if(l[a].x===s&&l[a].y===u)return!0;if(l[a].y===l[i].y&&l[a].y===u&&(s-l[a].x)*(s-l[i].x)<=0)return!0;if(l[a].y<u&&u<=l[i].y||l[i].y<u&&u<=l[a].y){if(s===(o=(l[i].x-l[a].x)*(u-l[a].y)/(l[i].y-l[a].y)+l[a].x))return!0;s<o&&(n=!n)}}return n}function As(t,e){if(ks(t))return!1;for(var n=0,r=t.edges.length;n<r;n++){if(js(e,tt(t.edges[n])))return!0}var i=H(Z(e),2),a=i[0],o=i[1];return Ns(t,a)||Ns(t,o)}function Ds(t,e){if(ks(t))return!1;for(var n=0,r=t.edges.length;n<r;n++){if(Ts(e,tt(t.edges[n])))return!0}var i=H(J(e),4),a=i[0],o=i[1],s=i[2],u=i[3];return Ns(t,a)||Ns(t,o)||Ns(t,s)||Ns(t,u)}function Os(t,e){return!bs(t)&&!bs(e)&&(t.x<=e.x+e.width&&e.x<=t.x+t.width&&t.y<=e.y+e.height&&e.y<=t.y+t.height)}function Es(t,e){return!bs(t)&&!bs(e)&&[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}].every((function(e){return Is(t,e)}))}function Is(t,e){return!bs(t)&&(e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height)}function Ts(t,e){if(xs(e)||bs(t))return!1;var n=H(Z(e),2),r=n[0],i=n[1];if(Is(t,r)||Is(t,i))return!0;for(var a=J(t),o=a.length,s=0;s<o;s++){if(js(tt([a[s],a[3!==s?s+1:0]]),e))return!0}return!1}function js(t,e){var n,r,i=H(Z(t),2),a=i[0],o=i[1],s=H(Z(e),2),u=s[0],l=s[1],c=ts(o,a),h=es(o,a),f=ts(l,u),d=es(l,u),p=ts(a,u),g=es(a,u),v=d*c-f*h,y=f*g-d*p,m=c*g-h*p;if(0===c&&0===h)return!1;if(0===f&&0===d)return!1;if(0===v){if(0===y&&0===m){if(0===c){if(0===h)return a.x===o.x&&a.y===o.y;n=es(u,a)/h,r=es(l,a)/h}else n=(u.x-a.x)/c,r=(l.x-a.x)/c;return!(n<0&&r<0||n>1&&r>1)}return!1}var x=y/v;return v=m/v,x>=0&&x<=1&&v>=0&&v<=1}function Ps(t,e){if(xs(t))return!1;var n=H(Z(t),2);return ys(n[0],n[1],e)}function zs(t,e){var n=t.boundingRect(),r=e.boundingRect();return!!Os(n,r)&&(Es(n,r)?Ms(t,e):Ms(e,t))}function Fs(t,e){var n=t.boundingRect(),r=e.boundingRect();return!!Os(n,r)&&(Es(r,n)?function(t,e){for(var n=t.numPolygons,r=t.polygons,i=0;i<n;i++)if(!0===zs(e,r[i]))return!0;return!1}(t,e):function(t,e){for(var n=0,r=e.edges.length;n<r;n++)if(!0===Hs(t,tt(e.edges[n])))return!0;return!1}(t,e))}function Ls(t,e){if(ws(t))return!1;if(Bs(e,{x:t.cx,y:t.cy}))return!0;for(var n=e.numPolygons,r=e.polygons,i=0;i<n;i++)for(var a=r[i],o=a.edges.length,s=0;s<o;s++){if(Rs(t,tt(a.edges[s])))return!0}return!1}function Bs(t,e){if(!Is(t.boundingRect(),e))return!1;var n,r,i,a,o,s,u=e.x,l=e.y,c=t.numPolygons,h=!1;for(r=0;r<c;r++)for(o=-1,a=(i=(n=t.vertices[r]).length)-1;++o<i;a=o){if(n[o].x===u&&n[o].y===l)return!0;if(n[o].y===n[a].y&&n[o].y===l&&(u-n[o].x)*(u-n[a].x)<=0)return!0;if(n[o].y<l&&l<=n[a].y||n[a].y<l&&l<=n[o].y){if(u===(s=(n[a].x-n[o].x)*(l-n[o].y)/(n[a].y-n[o].y)+n[o].x))return!0;u<s&&(h=!h)}}return h}function Hs(t,e){var n=H(Z(e),2),r=n[0],i=n[1];if(Bs(t,r)||Bs(t,i))return!0;for(var a=t.numPolygons,o=t.polygons,s=0;s<a;s++)for(var u=o[s],l=0,c=u.edges.length;l<c;l++){if(js(e,tt(u.edges[l])))return!0}return!1}function $s(t,e){var n=H(J(e),4),r=n[0],i=n[1],a=n[2],o=n[3];if(Bs(t,r)||Bs(t,i)||Bs(t,a)||Bs(t,o))return!0;for(var s=t.numPolygons,u=t.polygons,l=0;l<s;l++)for(var c=u[l],h=0,f=c.edges.length;h<f;h++){if(Ts(e,tt(c.edges[h])))return!0}return!1}var Ws=/^\$/,Vs="@extend";function Us(t){throw new Error('Cyclical reference for "'.concat(t,'"'))}function Ys(t,e,n){if("string"==typeof t){var r=e[t];return-1!==n.indexOf(t)&&Us(t),Ws.test(r)?(n.push(t),Ys(r,e,n)):r}var i=t,a=M(!0,{},e,t),o={};if(t[Vs]){var s=t[Vs];-1!==n.indexOf(s)&&Us(s);var u=n.slice();u.push(s),i=M(!0,{},Ys(a[s],e,u),t)}return Object.keys(i).forEach((function(t){var e=n.slice();if(t!==Vs&&!Ws.test(t)){o[t]=i[t];var r=o[t];Ws.test(r)&&r in a?(-1!==n.indexOf(r)&&Us(r),e.push(r),"object"===R(r=a[r])||Ws.test(r)&&r in a?o[t]=Ys(r,a,e):o[t]=r):"object"===R(r)&&(o[t]=Ys(r,a,e))}})),o}function Xs(t,e){return Ys(t,e,[])}function Ks(t){t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height)}function Gs(t,e){var n={x:0,y:0,width:0,height:0},r={x:0,y:0,width:0,height:0};return n.width=t.width||0,n.height=t.height||0,void 0!==e.size&&(n.width=isNaN(e.size.width)?n.width:e.size.width,n.height=isNaN(e.size.height)?n.height:e.size.height),void 0!==e.logicalSize?(r.width=isNaN(e.logicalSize.width)?n.width:e.logicalSize.width,r.height=isNaN(e.logicalSize.height)?n.height:e.logicalSize.height,r.align=isNaN(e.logicalSize.align)?.5:Math.min(Math.max(e.logicalSize.align,0),1),r.preserveAspectRatio=e.logicalSize.preserveAspectRatio):(r.width=n.width,r.height=n.height,r.preserveAspectRatio=!1),Ks(r),Ks(n),{logicalContainerRect:r,containerRect:n}}function Zs(t){var e={center:{minWidthRatio:.5,minHeightRatio:.5,minWidth:0,minHeight:0}};return M(!0,e,t),e.center.minWidthRatio=Math.min(Math.max(e.center.minWidthRatio,0),1),e.center.minHeightRatio=Math.min(Math.max(e.center.minHeightRatio,0),1),e.center.minWidth=Math.max(e.center.minWidth,0),e.center.minHeight=Math.max(e.center.minHeight,0),e}function Js(t,e,n,r,i){return{x:isNaN(t)?0:t,y:isNaN(t)?0:e,width:isNaN(t)?0:n,height:isNaN(t)?0:r,margin:isNaN(i)?0:i}}function Qs(t,e,n){if(void 0===t.cachedSize){var r,i=t.config.dock(),a=t.comp.preferredSize({inner:e,outer:n,dock:i});isNaN(a)?a&&!isNaN(a.size)&&(a.width=a.size,a.height=a.size):a={width:a,height:a},r="top"===i||"bottom"===i?a.height:"right"===i||"left"===i?a.width:Math.max(a.width,a.height),t.cachedSize=Math.ceil(r),t.edgeBleed=a.edgeBleed||0}return t.cachedSize}function tu(t,e){switch(e.config.dock()){case"top":t.y+=e.cachedSize,t.height-=e.cachedSize;break;case"bottom":t.height-=e.cachedSize;break;case"left":t.x+=e.cachedSize,t.width-=e.cachedSize;break;case"right":t.width-=e.cachedSize}}function eu(t,e){var n=e.edgeBleed;n&&(t.left=Math.max(t.left,n.left||0),t.right=Math.max(t.right,n.right||0),t.top=Math.max(t.top,n.top||0),t.bottom=Math.max(t.bottom,n.bottom||0))}function nu(t,e,n){e.x<n.left&&(e.width-=n.left-e.x,e.x=n.left);var r=t.width-(e.x+e.width);r<n.right&&(e.width-=n.right-r),e.y<n.top&&(e.height-=n.top-e.y,e.y=n.top);var i=t.height-(e.y+e.height);i<n.bottom&&(e.height-=n.bottom-i)}function ru(t,e,n,r,i){var a=M({},e),o=M({},n);return tu(a,r),eu(o,r),nu(t,a,o),!!function(t,e,n){var r=Math.min(n.center.minWidth,t.width)||Math.max(t.width*n.center.minWidthRatio,1),i=Math.min(n.center.minHeight,t.height)||Math.max(t.height*n.center.minHeightRatio,1);return e.width>=r&&e.height>=i}(t,a,i)&&(tu(e,r),eu(n,r),!0)}function iu(t){var e=t.layoutRect,n=t.visible,r=t.hidden,i=t.settings,a=Js(e.x,e.y,e.width,e.height),o={left:0,right:0,top:0,bottom:0},s=n.slice();s.sort((function(t,e){return t.config.prioOrder()-e.config.prioOrder()}));for(var u=0;u<s.length;++u){var l=s[u];Qs(l,a,e),ru(e,a,o,l,i)||(r.push(s.splice(u,1)[0]),--u)}!function(t,e){if(0!==e.length)for(var n=0;n<t.length;++n){var r=t[n];r.referencedDocks.length&&r.referencedDocks.every((function(t){return e.some((function(e){return e.key===t}))}))&&e.push(t.splice(n,1)[0])}}(n,r);var c=n.filter((function(t){return-1!==s.indexOf(t)}));return n.length=0,n.push.apply(n,$(c)),nu(e,a,o),a}function au(t){return{x:t.margin.left+t.x*t.scaleRatio.x,y:t.margin.top+t.y*t.scaleRatio.y,width:t.width*t.scaleRatio.x,height:t.height*t.scaleRatio.y}}function ou(t){var e;return Q((e=[]).concat.apply(e,$(t.map(J))))}function su(t){var e=t.visible,n=t.layoutRect,r=t.reducedRect,i=t.containerRect,a=t.translation,o=Js(r.x,r.y,r.width,r.height),s=Js(r.x,r.y,r.width,r.height),u={},l=e.slice(),c=l.slice().sort((function(t,e){return t.config.displayOrder()-e.config.displayOrder()}));return e.sort((function(t,e){if(t.referencedDocks.length>0&&e.referencedDocks.length>0)return 0;if(e.referencedDocks.length>0)return-1;if(t.referencedDocks.length>0)return 1;var n=t.config.displayOrder()-e.config.displayOrder();return 0===n?l.indexOf(t)-l.indexOf(e):n})).forEach((function(t){var e={},l={};switch(t.config.dock()){case"top":e.height=l.height=t.cachedSize,e.width=n.width,l.width=o.width,e.x=n.x,l.x=o.x,e.y=l.y=o.y-t.cachedSize,o.y-=t.cachedSize,o.height+=t.cachedSize;break;case"bottom":e.x=n.x,l.x=o.x,e.y=l.y=o.y+o.height,e.width=n.width,l.width=o.width,e.height=l.height=t.cachedSize,o.height+=t.cachedSize;break;case"left":e.x=l.x=s.x-t.cachedSize,e.y=n.y,l.y=s.y,e.width=l.width=t.cachedSize,e.height=n.height,l.height=s.height,s.x-=t.cachedSize,s.width+=t.cachedSize;break;case"right":e.x=l.x=s.x+s.width,e.y=n.y,l.y=s.y,e.width=l.width=t.cachedSize,e.height=n.height,l.height=s.height,s.width+=t.cachedSize;break;case"center":e.x=l.x=r.x,e.y=l.y=r.y,e.width=l.width=r.width,e.height=l.height=r.height;break;default:if(t.referencedDocks.length>0){var c=t.referencedDocks.map((function(t){return u[t]})).filter((function(t){return!!t}));c.length>0&&(e=ou(c.map((function(t){return t.outerRect}))),l=ou(c.map((function(t){return t.r}))))}}t.key&&(u[t.key]={r:l,outerRect:e}),function(t,e,n,r){var i={x:r.width/n.width,y:r.height/n.height},a={left:0,top:0};if(n.preserveAspectRatio){var o=i.x<i.y,s=Math.min(i.x,i.y);i.x=s,i.y=s;var u=o?"height":"width",l=(r[u]-n[u]*i.x)*n.align;a.left=o?0:l,a.top=o?l:0}t.scaleRatio=i,t.margin=a,e.scaleRatio=i,e.margin=a,n.scaleRatio=i,n.margin=a}(l,e,n,i),l.edgeBleed=t.edgeBleed,l.computed=au(l),e.edgeBleed=t.edgeBleed,e.computed=au(e),l.x+=a.x,l.y+=a.y,e.x+=a.x,e.y+=a.y,t.comp.resize(l,e),t.cachedSize=void 0,t.edgeBleed=void 0})),c}function uu(t){if(!t.resize||"function"!=typeof t.resize)throw new Error("Component is missing resize function");if(!t.dockConfig&&!t.preferredSize)throw new Error("Component is missing preferredSize function")}function lu(t,e,n){for(var r,i,a,o,s,u=[],l=[],c=0;c<t.length;++c){var h=t[c];uu(h);var f=h.dockConfig,d=h.key,p=f.dock(),g=/@/.test(p)?p.split(",").map((function(t){return t.replace(/^\s*@/,"")})):[];r=f,i=n,a=void 0,o=void 0,s=void 0,a=e.layoutModes||{},o=r.minimumLayoutMode(),(s=r.show())&&"object"===R(o)?s=a[o.width]&&a[o.height]&&i.width>=a[o.width].width&&i.height>=a[o.height].height:s&&void 0!==o&&(s=a[o]&&i.width>=a[o].width&&i.height>=a[o].height),s?u.push({comp:h,key:d,config:f,referencedDocks:g}):l.push({comp:h,key:d,config:f,referencedDocks:g})}return[u,l]}var cu=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.hasKey&&r.key===e)return t[n]}return null},hu=function t(e){return null==e?void 0:e.map((function(e){var n=e.instance.dockConfig();return{preferredSize:function(r){return n.computePreferredSize(C(C({},r),{},{children:t(e.children)}))}}}))},fu=function(t,e){return{visible:[],hidden:e,ordered:[]}},du=function(t){return function(e,n){var r,i=n.map((function(t,e){var n=t.instance.dockConfig();return{index:e,key:t.key,dockConfig:n,resize:t.instance.resize,preferredSize:function(e){return n.computePreferredSize(C(C({},e),{},{children:hu(t.children)}))}}})),a=function(t){return n[t.index]},o=null!==(r=t(e,i))&&void 0!==r?r:{},s=o.visible,u=void 0===s?i:s,l=o.hidden,c=void 0===l?[]:l,h=o.ordered,f=void 0===h?u:h;return{visible:u.map(a),hidden:c.map(a),ordered:f.map(a)}}},pu=function(t){var e=function(t){var e=Zs(t);return{layout:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||isNaN(t.x)||isNaN(t.y)||isNaN(t.width)||isNaN(t.height))throw new Error("Invalid rect");if(!n.length)return{visible:[],hidden:[],ordered:[]};var r=Gs(t,e),i=r.logicalContainerRect,a=r.containerRect,o=H(lu(n,e,i),2),s=o[0],u=o[1],l=su({visible:s,layoutRect:i,reducedRect:iu({layoutRect:i,visible:s,hidden:u,settings:e}),containerRect:a,translation:{x:t.x,y:t.y}});return u.forEach((function(t){t.comp.visible=!1;var e=Js();t.comp.resize(e,e)})),{visible:s.map((function(t){return t.comp})),hidden:u.map((function(t){return t.comp})),ordered:l.map((function(t){return t.comp}))}},settings:function(t){e=Zs(t)}}}(t);return du((function(t,n){return e.layout(t,n)}))},gu=function(t){return"function"==typeof t?du(t):pu(t)};function vu(t){var e=t.createComponent,n={},r=[],i=[],a=function t(n){var i=e(n);return i&&(r.push(i),n.components&&(i.children=n.components.map((function(e){return t(e)})).filter((function(t){return!!t})))),i},o=function t(e,n){for(var i=function(i){var a=e[i],o=n.find((function(t){return a.hasKey&&a.key===t.key}));o?a.children&&o.components&&t(a.children,o.components):(e.splice(i,1),function(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}(a),a.children&&t(a.children,[]),a.instance.destroy())},a=e.length-1;a>=0;a--)i(a)},s=function t(e){var n=e.compList,r=e.data,i=e.excludeFromUpdate,o=e.formatters,s=e.scales;return e.settingsList.map((function(e){var u=cu(n,e.key);return i.indexOf(e.key)>-1?(delete u.updateWith,u):u?(e.rendererSettings&&"function"==typeof u.instance.renderer().settings&&u.instance.renderer().settings(e.rendererSettings),e.rendererSettings&&"function"==typeof e.rendererSettings.transform&&e.rendererSettings.transform()?(u.applyTransform=!0,u):(u.updateWith={formatters:o,scales:s,data:r,settings:e},e.components&&(u.children=t({compList:u.children||[],data:r,excludeFromUpdate:i,formatters:o,scales:s,settingsList:e.components})),u)):a(e)})).filter((function(t){return!!t}))},u=function t(e){var n=e.components,r=e.hidden,i=e.layoutFn,a=e.ordered,o=e.rect,s=e.visible,u=i(o,n),l=u.visible,c=u.hidden,h=u.ordered;s.push.apply(s,$(l)),r.push.apply(r,$(c)),a.push.apply(a,$(h)),l.forEach((function(e){if(e.children){var n,i,o=gu(null!==(n=null===(i=e.settings)||void 0===i?void 0:i.strategy)&&void 0!==n?n:{});t({components:e.children,hidden:r,layoutFn:o,ordered:a,rect:e.instance.getRect(),visible:s})}})),c.forEach((function(e){e.children&&t({components:e.children,hidden:r,layoutFn:fu,ordered:a,rect:null,visible:s})}))};return n.destroy=function(){r.forEach((function(t){return t.instance.destroy()})),r=[],i=[]},n.findComponentByKey=function(t){return cu(r,t)},n.forEach=function(t){r.forEach(t)},n.layout=function(t){var e=t.layoutSettings,n=t.rect,r=[],a=[],o=[],s=gu(e);return u({components:i,hidden:a,layoutFn:s,ordered:o,rect:n,visible:r}),{visible:r,hidden:a,ordered:o}},n.set=function(t){var e=t.components;i=e.map((function(t){return a(t)})).filter((function(t){return!!t}))},n.update=function(t){var e=t.components,n=t.data,r=t.excludeFromUpdate,a=t.formatters,u=t.scales;o(i,e),i=s({compList:i,data:n,excludeFromUpdate:r,formatters:a,scales:u,settingsList:e})},n}function yu(t,e,n){var r=e.left-n.left,i=e.top-n.top,a=et(t),o=M(!0,{},t);switch(a){case"circle":o.cx+=r,o.cy+=i;break;case"polygon":for(var s=0,u=o.vertices.length;s<u;s++){var l=o.vertices[s];l.x+=r,l.y+=i}break;case"geopolygon":for(var c=0;c<o.vertices.length;c++)for(var h=o.vertices[c],f=0,d=h.length;f<d;f++){var p=h[f];p.x+=r,p.y+=i}break;case"line":o.x1+=r,o.y1+=i,o.x2+=r,o.y2+=i;break;case"point":case"rect":o.x+=r,o.y+=i}return o}function mu(t,e){var n=[],r=0;e.forEach((function(t){n.push(r),r++;var e=t.instance.def.additionalElements&&t.instance.def.additionalElements();e&&(r+=e.length)})),e.forEach((function(e,r){return function(t,e,n){var r=e.instance.renderer().element();if(!isNaN(n)&&r&&t&&t.children){var i=t.children[Math.max(0,n)];if(r!==i){var a=e.instance.def.additionalElements&&e.instance.def.additionalElements().filter(Boolean);t.insertBefore&&void 0!==i?(t.insertBefore(r,i),a&&a.forEach((function(e){t.insertBefore(e,r)}))):(a&&a.forEach((function(e){t.appendChild(e,r)})),t.appendChild(r))}}}(t,e,n[r])}))}function xu(t,e){var n=t.element,r=t.data,i=void 0===r?[]:r,a=t.settings,o=void 0===a?{}:a,s=t.on,u=void 0===s?{}:s,l=e.registries,c=e.logger,h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=t,r=function(t){t.forEach((function(t){var n=Array.isArray(t.colors[0])?t.colors:[t.colors];e[t.key]={colors:n,sizes:n.map((function(t){return t?t.length:0}))}}))},i=function(t,n){var r=e[t];if(!r)return[];for(var i=r.sizes,a=0;a<i.length;a++)if(n<=i[a])return r.colors[a];return r.colors[i.length-1]},a={palette:function(t,e){return i(t,e)},setPalettes:r,style:function(t){return Xs(t,n)},setStyle:function(e){n=M({},t,e)}};return r(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]),a}(e.style,e.palettes),f=[],d=M({},t),p=function(){var t={};return Qa(t),t}(),g=[],v=null,y=null,m=null,x=[],b=function(){},w=function(){},k={},_=!1,S=vu({createComponent:function(t){return l.component.has(t.type)?{instance:function(t){var e,n,r,i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.defaultSettings,u=void 0===s?{}:s,l=t._DO_NOT_USE_getInfo,c=void 0===l?function(){return{}}:l,h=o.chart,f=o.container,d=o.mediator,p=o.registries,g=o.theme,v=o.renderer,y=Qa({}),m=o.settings||{},x=M(!0,{},u,m),b=[],w=jo({chart:h}),k=!1,_={nodes:[],chart:h,config:x.brush||{},renderer:null},S={tap:[],over:[]},q=[],N={},A=M({},m);function D(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){for(var i,a,o,s=void 0!==t[e],u=void 0!==m[e],l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return s&&("function"==typeof t[e]?i=(a=t[e]).call.apply(a,[N].concat(c)):r&&(i=t[e])),u&&("function"==typeof m[e]?i=(o=m[e]).call.apply(o,[A].concat(c)):r&&(i=m[e])),s||u||(i=n.call.apply(n,[N].concat(c))),i}}var O=D("preferredSize",(function(){return 0}),!0),E=D("resize",(function(t){return t.inner})),I=D("created"),T=D("beforeMount"),j=D("mounted"),P=D("beforeUnmount"),z=D("beforeUpdate"),F=D("updated"),L=D("beforeRender"),B=D("beforeDestroy"),H=D("destroyed"),W=t.render,V=function(){x.brush&&(x.brush.consume||[]).forEach((function(t){t.context&&t.style&&q.push(zo(_,t))}))},U=function(){x.brush&&(x.brush.trigger||[]).forEach((function(t){"over"===t.on?S.over.push(t):S.tap.push(t)}))};Object.defineProperty(_,"data",{get:function(){return b}});var Y=x.renderer||t.renderer,X=Y?v||p.renderer(Y)():v||p.renderer()();"function"==typeof X.settings&&X.settings(x.rendererSettings),_.renderer=X;var K={resources:h.logger?{logger:h.logger()}:{}},G=hs(ds(x,O,h.logger()),K),Z=function(t){t.key=x.key,t.element=X.element()},J=function(){};J.dockConfig=function(){return G},J.set=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.settings&&(m=t.settings,x=M(!0,{},u,t.settings),G=hs(ds(x,O,h.logger()),K),_.config=x.brush||{}),x.scale&&(e=h.scale(x.scale)),x.data){var r=x.rendererSettings,i="function"==typeof(null==r?void 0:r.progressive)&&r.progressive(),o=zr(x.data,{dataset:h.dataset,collection:h.dataCollection},{logger:h.logger()},h.dataCollection);i?i.isFirst?(b=o).items&&(b.items=$(o.items)):b.items&&(b.items=[].concat($(b.items),$(o.items||[]))):b=o}else b=e?e.data():[];"string"==typeof x.formatter||"object"===R(x.formatter)?n=h.formatter(x.formatter):e&&e.data().fields&&(n=e.data().fields[0].formatter()),a=g.style(x.style||{})},J.resize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=E({inner:t,outer:e});i=n?X.size(n):X.size(t),A.rect=M(!0,{computedPhysical:i.computedPhysical,computedOuter:e.computed||e,computedInner:t.computed||t},t),i=M(!0,{computedOuter:e.computed||e,computedInner:t.computed||t},i)},J.getRect=function(){return A.rect};var Q,tt,et,nt=function(){var t=X.renderArgs?X.renderArgs.slice(0):[],e=x.rendererSettings,n=b,r="function"==typeof(null==e?void 0:e.progressive)&&e.progressive();return b.items&&r&&(n=C(C({},b),{},{items:b.items.slice(r.start,r.end)})),t.push({data:n}),t};function rt(t){var e=x.rendererSettings,n="function"==typeof(null==e?void 0:e.progressive)&&e.progressive();n?n.isFirst?_.nodes=$(t||[]):_.nodes&&(_.nodes=[].concat($(_.nodes),$(t||[]))):_.nodes=t}J.beforeMount=T,J.beforeRender=function(){L({size:i})},J.render=function(){var t=W.call.apply(W,[N].concat($(nt())));rt(t),X.render(t),Q=t,tt=A.rect.computed},J.hide=function(){J.unmount(),X.size({x:0,y:0,width:0,height:0}),X.clear()},J.beforeUpdate=function(){z({settings:x,data:b})},J.update=function(){et&&et.stop();var t=x,e=t.rendererSettings,n=t.brush,r=t.animations;if("function"==typeof(null==e?void 0:e.transform)&&e.transform())return X.render(),void(Q=null);var i=W.call.apply(W,[N].concat($(nt())));rt(i),q.forEach((function(t){return t.cleanUp()})),q.length=0,S.tap=[],S.over=[],n&&(V(),U()),q.forEach((function(t){t.isActive()&&t.update()})),Q&&r&&("function"==typeof r.enabled?r.enabled():r.enabled)?(r.compensateForLayoutChanges&&r.compensateForLayoutChanges({currentNodes:Q,currentRect:A.rect.computed,previousRect:tt}),(et=No({old:Q,current:i},{renderer:X},r)).start()):X.render(i),Q=i,tt=A.rect.computed,X.setKey&&"string"==typeof m.key&&X.setKey(m.key)},J.updated=F,J.destroy=function(){J.unmount(),B(r),X.destroy(),H(),r=null};var it=function(t){_.nodes=t,q.forEach((function(t){t.isActive()&&t.update()})),X.render(t)};return fs(N,t,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return X},chart:function(){return h},dockConfig:function(){return G},mediator:function(){return d},instance:function(){return A},rect:function(){return A.rect},style:function(){return a},update:function(){return it},registries:function(){return p},resolver:function(){return w},symbol:function(){return cs(p.symbol)}}),fs(A,m,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return X},chart:function(){return h},dockConfig:function(){return G},mediator:function(){return d},style:function(){return a},_DO_NOT_USE_getInfo:c.bind(N),isVisible:function(){return k}}),J.getBrushedShapes=function(t,e,n){var r=[];if(x.brush&&x.brush.consume){var i=h.brush(t),a=X.findShapes("*");x.brush.consume.filter((function(e){return e.context===t})).forEach((function(t){for(var o=0;o<a.length;o++){var s=a[o];s.data&&i.containsMappedData(s.data,n||t.data,e)&&(Z(s),r.push(s),a.splice(o,1),o--)}}))}return r},J.findShapes=function(t){for(var e,n=(null!==(e=et)&&void 0!==e&&e.inProgress()?et.targetScene:X).findShapes(t),r=0,i=n.length;r<i;r++)Z(n[r]);return n},J.shapesAt=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=X.itemsAt(t);e=n&&"stop"===n.propagation&&r.length>0?[r.pop().node]:r.map((function(t){return t.node}));for(var i=0,a=e.length;i<a;i++)Z(e[i]);return e},J.brushFromShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.contexts=Array.isArray(e.contexts)?e.contexts:[],Fo({nodes:t,action:e.action||"toggle",trigger:e,chart:h,data:_.data})},J.mount=function(){r=X.element&&X.element()?r:X.appendTo(f),X.setKey&&"string"==typeof m.key&&X.setKey(m.key),x.brush&&(V(),U()),ps(A,y,m),ps(N,y,t),k=!0},J.mounted=function(){return j(r)},J.unmount=function(){[A,N].forEach((function(t){gs(t,y)})),S.tap=[],S.over=[],q.forEach((function(t){t.cleanUp()})),q.length=0,P(),k=!1},J.onBrushTap=function(t){S.tap.forEach((function(e){$o({e:t,t:e,config:_})&&"stop"===e.globalPropagation&&h.toggleBrushing(!0)}))},J.onBrushOver=function(t){S.over.forEach((function(e){Wo({e:t,t:e,config:_})&&"stop"===e.globalPropagation&&h.toggleBrushing(!0)}))},J.def=N,J.ctx=A,J.renderer=function(){return X},J.set({settings:m}),I(),J}(l.component(t.type),{settings:t,chart:d,mediator:p,registries:l,theme:h,container:n}),settings:M(!0,{},t),key:t.key,hasKey:void 0!==t.key}:(c.warn("Unknown component: ".concat(t.type)),!1)}});function q(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var r,i,a="function"==typeof t[e],o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];a?r=(i=t[e]).call.apply(i,[d].concat(s)):r=n.call.apply(n,[d].concat(s));return r}}var N=function(){var t;o.dockLayout?(c.warn('Deprecation Warning: "dockLayout" property should be renamed to "strategy"'),t=o.dockLayout):t=o.strategy;var e=function(t){if("function"==typeof t.getBoundingClientRect){var e=t.getBoundingClientRect();return{x:0,y:0,width:e.width,height:e.height}}return{x:0,y:0,width:0,height:0}}(n);return S.layout({layoutSettings:t,rect:e})},A=q("created"),D=q("beforeMount"),O=q("mounted"),E=q("beforeUpdate"),I=q("updated"),T=q("beforeRender"),j=q("beforeDestroy"),P=q("destroyed"),z=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.partialData,i=e.formatters,a=void 0===i?{}:i,o=e.scales,s=void 0===o?{}:o,u=e.scroll,f=void 0===u?{}:u;b=rt(t,{logger:c,types:l.data}),r||Object.keys(k).forEach((function(t){return k[t].clear()})),e.palettes&&h.setPalettes(e.palettes),e.style&&h.setStyle(e.style),w=Fr(e.collections,{dataset:b},{logger:c});var d={theme:h,logger:c};v=Ka(s,{dataset:b,collection:w},C(C({},d),{},{scale:l.scale})),y=Br(a,{dataset:b,collection:w},C(C({},d),{},{formatter:l.formatter})),m=no(f,m)};function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={},r=t.filter((function(t){return!!t.key})).map((function(t){return t.key}));x.forEach((function(t){t.key&&-1!==r.indexOf(t.key)?e[t.key]=t:t.destroy()})),x=t.map((function(t){var r=t.key&&e[t.key]?e[t.key]:l.interaction(t.type)(d,p,n);return r.set(t),r}))}var L=function(t){var e=n.getBoundingClientRect(),r="clientX"in t?t.clientX:t.x,i="clientY"in t?t.clientY:t.y,a={x:r-e.left,y:i-e.top},o=[];return g.forEach((function(t){var e=t.instance.getRect();Is(e.computedPhysical?e.computedPhysical:{x:e.margin.left+e.x*e.scaleRatio.x,y:e.margin.top+e.y*e.scaleRatio.y,width:e.width*e.scaleRatio.x,height:e.height*e.scaleRatio.y},a)&&o.push(t)})),o},B=function(){if(!f.length&&n){Object.keys(u).forEach((function(t){var e=u[t].bind(d);n.addEventListener(t,e),f.push({key:t,listener:e})}));var t={},e=function(e){e.touches?(t.x=e.touches[0].clientX,t.y=e.touches[0].clientY,t.multiTouch=e.touches.length>1):(t.x=e.clientX,t.y=e.clientY,t.multiTouch=!1),t.time=Date.now(),t.comps=L(t)},r=function(e){var n=t.comps||L(e);if(!n.every((function(t){return t.instance.def.disableTriggers}))&&("touchend"===e.type&&e.preventDefault(),function(t,e){var n=Y(t),r=n?t.changedTouches[0]:t,i=Date.now()-e.time,a=isNaN(e.x)?0:Math.abs(r.clientX-e.x),o=isNaN(e.y)?0:Math.abs(r.clientY-e.y);return(0===t.button||n)&&!e.multiTouch&&a<=12&&o<=12&&i<=300}(e,t)))for(var r=n.length-1;r>=0;r--){if(n[r].instance.onBrushTap(e),_){_=!1;break}}},i=[];i.push({key:"mousedown",listener:e}),i.push({key:"mouseup",listener:r}),function(t){return"ontouchstart"in t&&"ontouchend"in t||navigator.maxTouchPoints>1}(n)&&(i.push({key:"touchstart",listener:e}),i.push({key:"touchend",listener:r})),i.push({key:"mousemove",listener:function(t){for(var e=L(t),n=e.length-1;n>=0;n--){if(e[n].instance.onBrushOver(t),_){_=!1;break}}}}),i.forEach((function(t){n.addEventListener(t.key,t.listener),f.push(t)}))}},H=function(){f.forEach((function(t){var e=t.key,r=t.listener;return n.removeEventListener(e,r)})),f.length=0};return d.layoutComponents=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.excludeFromUpdate,n=void 0===e?[]:e;t.data&&(i=t.data),t.settings&&(o=t.settings,F(t.settings.interactions)),E(),z(i,o);var r=o,a=r.formatters,s=r.scales,u=r.components,l=void 0===u?[]:u;S.update({components:l,data:i,excludeFromUpdate:n,formatters:a,scales:s}),S.forEach((function(t){t.updateWith&&t.instance.set(t.updateWith)})),S.forEach((function(t){t.updateWith&&t.instance.beforeUpdate()})),N()},d.update=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.partialData,a=e.excludeFromUpdate,s=void 0===a?[]:a;e.data&&(i=e.data),e.settings&&(o=e.settings,F(e.settings.interactions)),E(),z(i,o,{partialData:r});var u=o,l=u.formatters,c=u.scales,h=u.components,f=void 0===h?[]:h;S.update({components:f,data:i,excludeFromUpdate:s,formatters:l,scales:c}),S.forEach((function(t){t.updateWith&&t.instance.set(t.updateWith)})),S.forEach((function(t){t.updateWith&&t.instance.beforeUpdate()}));var d,p=[],v=[];if(r)S.forEach((function(t){(t.updateWith||t.applyTransform)&&t.visible&&p.push(t)})),d=p;else{var y=N(),m=y.visible,x=y.hidden,b=y.ordered;g=m,d=m,t=b,m.forEach((function(t){t.updateWith&&t.visible?p.push(t):v.push(t)})),x.forEach((function(t){t.instance.hide(),t.visible=!1,delete t.updateWith,t.applyTransform=!1}))}v.forEach((function(t){return t.instance.beforeMount()})),v.forEach((function(t){return t.instance.mount()})),d.forEach((function(t){return t.instance.beforeRender()})),d.forEach((function(t){(t.updateWith||t.applyTransform)&&t.visible?t.instance.update():t.instance.render()})),r||mu(n,t),v.forEach((function(t){return t.instance.mounted()})),p.forEach((function(t){return t.instance.updated()})),g.forEach((function(t){delete t.updateWith,t.visible=!0,t.applyTransform=!1})),I()},d.destroy=function(){j(),S.destroy(),H(),F(),delete d.update,delete d.destroy,P()},d.getAffectedShapes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=[];return g.filter((function(t){return null==r||t.key===r})).forEach((function(r){var a=r.instance.getBrushedShapes(t,e,n);i=[].concat($(i),$(a))})),i},d.findShapes=function(t){var e=[];return g.forEach((function(n){var r=n.instance.findShapes(t);e=[].concat($(e),$(r))})),e},d.componentsFromPoint=function(t){return L(t).map((function(t){return t.instance.ctx}))},d.shapesAt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i=n.getBoundingClientRect(),a=g;if(Array.isArray(e.components)&&e.components.length>0){var o=e.components.map((function(t){return t.key}));a=g.filter((function(t){return-1!==o.indexOf(t.key)})).map((function(t){return{instance:t.instance,opts:e.components[o.indexOf(t.key)]}}))}for(var s=a.length-1;s>=0;s--){var u=a[s],l=u.instance.renderer().element().getBoundingClientRect(),c=yu(t,i,l),h=u.instance.shapesAt(c,u.opts),f=h.length>0&&"stop"===e.propagation;if((r=[].concat($(r),$(h))).length>0&&f)return r}return r},d.brushFromShapes=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{components:[]},n=function(n){var r=e.components[n].key;g.filter((function(t){return r===t.key})).forEach((function(r){var i=t.filter((function(t){return t.key===r.key}));r.instance.brushFromShapes(i,e.components[n])}))},r=0;r<e.components.length;r++)n(r)},d.scroll=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return ro(t,m)},d.dataset=function(t){return b(t)},d.dataCollection=function(t){return w(t)},d.scales=function(){return v.all()},d.formatters=function(){return y.all()},d.brush=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return k[t]||(k[t]=Mo()),k[t]},d.scale=function(t){return v.get(t)},d.formatter=function(t){return y.get(t)},d.toggleBrushing=function(t){_=void 0!==t?t:!_},d.component=function(t){var e=S.findComponentByKey(t);return null==e?void 0:e.instance.ctx},d.logger=function(){return c},d.theme=function(){return h},Object.defineProperty(d,"interactions",{get:function(){return{instances:x,on:function(){B(),x.forEach((function(t){return t.on()}))},off:function(){H(),x.forEach((function(t){return t.off()}))}}}}),A(),n&&(D(),n.innerHTML="",function(){var t=o.components,e=void 0===t?[]:t;T(),z(i,o),S.set({components:e});var r=N(),a=r.visible,s=r.hidden,u=r.ordered;g=a,s.forEach((function(t){t.instance.hide(),t.visible=!1})),a.forEach((function(t){return t.instance.beforeMount()})),a.forEach((function(t){return t.instance.mount()})),a.forEach((function(t){return t.instance.beforeRender()})),a.forEach((function(t){return t.instance.render()})),a.forEach((function(t){return t.instance.mounted()})),a.forEach((function(t){t.visible=!0})),mu(n,u)}(),B(),F(o.interactions),O(n),d.element=n),d}var bu=function(t){var e=ue(t);return e.prio=function(t){return t?e.default(t[0]):[e.default()]},e.types=function(){return e.getKeys()},e},wu=ue();function ku(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function Mu(t,e){var n=Array.isArray(t)?t:[t],r=[];return n.forEach((function(t){void 0!==t.field&&function(){var n=e.field(t.field),i=e.key();if(!n)throw Error("Field '".concat(t.field,"' not found"));for(var a=Nr(t,e),o=a.props,s=a.main,u=Object.keys(o),l=!!t.trackBy,c=R(t.trackBy),h={},f=[],d=n.items(),p=[],g=function(e){var n=d[e];if(s.filter&&!s.filter(n))return"continue";var r=ku(s,n,{key:i});u.forEach((function(t){var a=o[t],s=a.field?a.field.items()[e]:n;r[t]=ku(a,s,{key:i})})),l&&Or({cfg:t,itemData:n,obj:r,target:f,tracker:h,trackType:c}),p.push(r)},v=0;v<d.length;v++)g(v);r=[].concat($(r),l?$(Dr(f,{main:s,propsArr:u,props:o})):p)}()})),r}var _u=function(t){return t.filter((function(t){return"number"==typeof t&&!isNaN(t)}))};var Su=function(t){var e=t.key,n=t.data,r=t.cache,i=t.config;if(n){var a=n;"string"==typeof a&&(a=function(t){var e=t.data,n=t.config,r=e.split("\n"),i=r[0],a=r[1],o=",";if(n&&n.parse&&n.parse.delimiter)o=n.parse.delimiter;else if(i)for(var s=[/,/,/\t/,/;/],u=0;u<s.length;u++){var l=s[u];if(i&&a){if(l.test(i)&&l.test(a)&&i.split(l).length===a.split(l).length){o=l;break}}else l.test(i)&&(o=l)}return r.map((function(t){return t.split(o)}))}({data:n,config:i})),Array.isArray(a)&&function(t){var e,n=t.source,r=t.data,i=t.cache,a=t.config,o=r,s=a&&a.parse;Array.isArray(r[0])?s&&!1===s.headers?e=r[0].map((function(t,e){return e})):(e=r[0],o=r.slice(1)):e=Object.keys(r[0]);var u,l=!!s&&"function"==typeof s.row&&s.row,c=e;c=s&&"function"==typeof s.fields?s.fields(c.slice()):e.map((function(t){return{key:t,title:t}})),Array.isArray(r[0])?u=c.map((function(){return[]})):(u={},c.forEach((function(t){u[t.key]=[]})));for(var h=0;h<o.length;h++){var f=l?l(o[h],h,c):o[h];if(f)if(Array.isArray(f))for(var d=0;d<c.length;d++)u[d].push(f[d]);else for(var p=0;p<c.length;p++)u[c[p].key].push(f[c[p].key])}for(var g=Array.isArray(u)?function(t){return u[t]}:function(t){return u[c[t].key]},v=0;v<c.length;v++){var y=g(v),m=_u(y),x=m.length>0,b=x?"measure":"dimension",w=x?Math.min.apply(Math,$(m)):NaN,k=x?Math.max.apply(Math,$(m)):NaN;i.fields.push(Mr(M({source:n,key:v,title:c[v].title,values:y,min:w,max:k,type:b},c[v]),{value:c[v].value,label:c[v].label}))}}({data:a,cache:r,source:e,config:i})}};function Cu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.data,r=t.config,i={fields:[]},a={key:function(){return e},raw:function(){return n},field:function(t){return _r(t,{cache:i,matrix:n})},fields:function(){return i.fields.slice()},extract:function(t){return Mu(t,a)},hierarchy:function(){return null}};return Su({key:e,data:n,config:r,cache:i}),a}Cu.util={normalizeConfig:Nr,collect:Dr,track:Or};var Ru=ue();Ru.default("matrix"),Ru("matrix",Cu),Ru("default",Cu);var qu=ue();function Nu(t,e,n){return Math.max(t,Math.min(e,n))}function Au(t){var e,n=t.item,r=t.value,i=t.boxCenter,a=t.rendWidth,o=t.rendHeight,s="x",u="y",l=a,c=o,h=r<.5?90:-90;return t.flipXY&&(s="y",u="x",l=o,c=a,h=r<.5?180:0),(0,t.symbol)(M({},n.oob,(D(e={},s,i*l),D(e,u,Math.max(n.oob.size/2,Math.min(r*c,c-n.oob.size/2))),D(e,"startAngle",h),e)))}function Du(t){var e,n=t.item,r=t.boxWidth,i=t.boxPadding,a=t.rendWidth,o=t.rendHeight,s="x",u="y",l="width",c="height",h=a,f=o;t.flipXY&&(s="y",u="x",l="height",c="width",h=o,f=a);var d=function(t){var e=t.start,n=t.end,r=t.minPx,i=void 0===r?.1:r,a=t.maxPx,o=void 0===a?1:a,s=Math.max(e,n),u=Math.min(e,n),l=Nu(-.1,1.2,s),c=Nu(-.1,1.2,u),h=l*o-c*o,f=Math.max(i,h),d=(f-h)/2;return{actualDiff:f,startModifier:d,actualLow:c*o-d}}({start:n.start,end:n.end,minPx:n.box.minHeightPx,maxPx:f}),p=d.actualDiff,g=d.actualLow;return M({},n.box,(D(e={type:"rect"},s,(i+n.major)*h),D(e,u,g),D(e,c,p),D(e,l,r*h),D(e,"data",n.data||{}),D(e,"collider",{type:null}),e))}function Ou(t){var e,n=t.item,r=t.from,i=t.to,a=t.boxCenter,o=t.rendWidth,s=t.rendHeight,u="x1",l="y1",c="x2",h="y2",f=o,d=s;return t.flipXY&&(u="y1",l="x1",c="y2",h="x2",f=s,d=o),M({},n.line,(D(e={type:"line"},h,Math.floor(r*d)),D(e,u,a*f),D(e,l,Math.floor(i*d)),D(e,c,a*f),D(e,"data",n.data||{}),D(e,"collider",{type:null}),e))}function Eu(t){var e,n=t.item,r=t.key,i=t.position,a=t.width,o=t.boxCenter,s=t.rendWidth,u=t.rendHeight,l="x1",c="y1",h="x2",f="y2",d=s,p=u;t.flipXY&&(l="y1",c="x1",h="y2",f="x2",d=u,p=s);var g=a/2;return M({type:"line"},n[r],(D(e={},c,Math.floor(i*p)),D(e,l,(o-g)*d),D(e,f,Math.floor(i*p)),D(e,h,(o+g)*d),D(e,"r",g*d),D(e,"cx",o*d),D(e,"cy",i*p),D(e,"width",a*d),D(e,"data",n.data||{}),D(e,"collider",{type:null}),e))}function Iu(t,e,n){var r=e.box,i=r.width,a=r.maxWidthPx,o=r.minWidthPx,s=t>=0?1:-1,u=Math.min(s*t*i,isNaN(a)?n:a/n);return(u=isNaN(o)?u:Math.max(o/n,u))*s}qu("native",(function(t,e,n){var r,i,a={chart:t,mediator:e,element:n},o=[],s=!0;function u(){"function"==typeof r.enable&&(r.enable=r.enable.bind(a)()),r.enable&&Object.keys(r.events).forEach((function(t){var e=r.events[t].bind(a);n.addEventListener(t,e),o.push({key:t,listener:e})}))}function l(){o.forEach((function(t){var e=t.key,r=t.listener;n.removeEventListener(e,r)})),o=[]}return{get key(){return i},set:function(t){!function(t){i=t.key,(r=t).events=r.events||[],void 0===r.enable&&(r.enable=!0)}(t),l(),s&&u()},off:function(){s=!1,l()},on:function(){s=!0,0===o.length&&u()},destroy:function(){l(),a=null,r=null}}}));var Tu={oob:{show:!0,type:"n-polygon",fill:"#999",stroke:"#000",strokeWidth:0,size:10,sides:3,startAngle:-90},box:{show:!0,fill:"#fff",stroke:"#000",strokeWidth:1,strokeLinejoin:"miter",width:1,maxWidthPx:void 0,minWidthPx:1,minHeightPx:1},line:{show:!0,stroke:"#000",strokeWidth:1},median:{show:!0,stroke:"#000",strokeWidth:1},whisker:{show:!0,stroke:"#000",strokeWidth:1,fill:"",type:"line",width:1}},ju=Object.keys(Tu),Pu={require:["chart","resolver","symbol"],defaultSettings:{settings:{},data:{},style:{box:"$shape",line:"$shape-guide",whisker:"$shape-guide",median:"$shape-guide--inverted"}},created:function(){this.state={}},render:function(t){var e=this,n=t.data,r=this.rect,i=r.width,a=r.height,o="horizontal"===this.settings.settings.orientation,s=this.style,u=this.resolver,l=this.symbol,c=ju.filter((function(t){return!e.settings.settings[t]||!1!==e.settings.settings[t].show})),h={};c.forEach((function(t){return h[t]=Tu[t]}));var f=function(t){var e,n=t.keys,r=t.data,i=t.defaultSettings,a=t.style,o=t.settings,s=t.width,u=t.height,l=t.resolver,c=M(!0,{},i||{},a||{}),h={major:"horizontal"===o.orientation?u:s,minor:"horizontal"===o.orientation?s:u},f=o.major;e="object"===R(f)&&"object"===R(f.ref)&&void 0!==f.ref.start&&void 0!==f.ref.end?l.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:M(!0,{},{binStart:{scale:o.major.scale,ref:o.major.ref.start},binEnd:{scale:o.major.scale,ref:o.major.ref.end}})}):"object"===R(f)&&void 0!==f.binStart&&void 0!==f.binEnd?l.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:M(!0,{},{binStart:{scale:o.major.scale,ref:"binStart"},binEnd:{scale:o.major.scale,ref:"binEnd"}},o.major)}):l.resolve({data:r,scaled:h,defaults:{major:.5},settings:{major:o.major}});var d=o.minor||{},p={};["start","end","min","max","med"].forEach((function(t){(d[t]||r.items&&r.items.length&&r.items[0][t])&&(p[t]={scale:d.scale,ref:t})}));for(var g,v={major:e,minor:l.resolve({data:r,defaults:{start:0,end:1},scaled:h,settings:M(!0,{},p,d)})},y=0,m=n.length;y<m;y++)o[g]&&!1===o[g].show||(v[g=n[y]]=l.resolve({data:r,defaults:c[g],settings:o[g],scaled:h}));return v}({keys:c,data:n,defaultSettings:h,style:s,settings:this.settings.settings,width:i,height:a,resolver:u}),d=f.settings;return function(t){var e=t.width,n=t.height,r=t.flipXY,i=t.resolved,a=t.keys,o=t.symbol,s=[],u=i.major.items;if(!u.length)return s;var l,c,h,f,d,p,g,v,y,m=e,x=n,b=r?n:e,w=i.major.settings,k=["start","end","min","max","med"].filter((function(t){return void 0!==i.minor.settings[t]})),_=k.length,S=a.filter((function(t){return"oob"!==t})),C=a?a.length:0,R=S?S.length:0,q={box:function(){h.box&&X(h.start)&&X(h.end)&&l.push(Du({item:h,boxWidth:f,boxPadding:d,rendWidth:m,rendHeight:x,flipXY:r}))},line:function(){X(h.min)&&X(h.start)&&l.push(Ou({item:h,from:h.min,to:h.start,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r})),X(h.max)&&X(h.end)&&l.push(Ou({item:h,from:h.max,to:h.end,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r}))},median:function(){h.median&&X(h.med)&&l.push(Eu({item:h,key:"median",position:h.med,width:f,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r}))},whisker:function(){if(h.whisker){var t=f*h.whisker.width;X(h.min)&&l.push(Eu({item:h,key:"whisker",position:h.min,width:t,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r})),X(h.max)&&l.push(Eu({item:h,key:"whisker",position:h.max,width:t,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r}))}}};function N(){for(var t,e=-Number.MAX_VALUE,n=Number.MAX_VALUE,r=0;r<_;r++)X(t=h[k[r]])&&(e<t&&(e=t),n>t&&(n=t));g=e<0&&e!==-Number.MAX_VALUE,v=n>1&&n!==Number.MAX_VALUE,y=g||v}for(var A=0,D=u.length;A<D;A++){l=[],c=null;var O=u[A],E=O.data,I=null,T=null;void 0!==w.binStart?(I=O.binStart,T=O.binEnd,c=w.binStart.scale):I=(c=w.major.scale)?O.major:0;var j=0;c?c.bandwidth?I-=(j=c.bandwidth())/2:j=T-I:j=1,h=M({},{major:I,majorEnd:T},i.minor.items[A]);for(var P=0;P<C;P++)h[a[P]]=i[a[P]].items[A];if(f=Iu(j,h,b),p=(d=(j-f)/2)+h.major+f/2,N(),y)h.oob&&(g?l.push(Au({item:h,value:0,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r,symbol:o})):v&&l.push(Au({item:h,value:1,boxCenter:p,rendWidth:m,rendHeight:x,flipXY:r,symbol:o})));else for(var z=0;z<R;z++)h[S[z]]&&!1===h[S[z]].show||q[S[z]]();var F={type:"container",data:E,collider:{type:"bounds"},children:l};s.push(F)}return s}({items:f.items,settings:d,width:i,height:a,flipXY:o,resolved:f,keys:c,symbol:l})}};var zu={shape:"saltire",width:2,size:.5,fill:"#333",stroke:"#333",strokeWidth:0},Fu=/px$/,Lu={shape:"circle",label:"",fill:"#333",stroke:"#ccc",strokeDasharray:"",strokeWidth:0,strokeLinejoin:"miter",opacity:1,x:.5,y:.5,size:1,show:!0},Bu={maxPx:1e4,minPx:1,maxRelExtent:.1,minRelExtent:.01,maxRelDiscrete:1,minRelDiscrete:.1};function Hu(t,e){return t&&"function"==typeof t.bandwidth?{isBandwidth:!0,value:Math.max(1,t.bandwidth()*e)}:{isBandwidth:!1,value:Math.max(1,e)}}function $u(t,e,n,r){var i=e.width,a=e.height;return t.filter((function(t){return!1!==t.show&&!isNaN(t.x+t.y)})).map((function(t){var e=t,o=Fu.test(t.size)?parseInt(t.size,10):n.min+e.size*(n.max-n.min);K(o)&&(e=zu,o=n.min+e.size*(n.max-n.min));var s=H(function(t){var e=Lu.shape,n={};return"object"===R(t.shape)&&"string"==typeof t.shape.type?(e=t.shape.type,n=t.shape):"string"==typeof t.shape&&(e=t.shape),[e,n]}(e),2),u=s[0],l=C(C({},s[1]),{},{type:u,label:t.label,x:t.x*i,y:t.y*a,fill:e.fill,size:Math.min(n.maxGlobal,Math.max(n.minGlobal,o)),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeDasharray:e.strokeDasharray,opacity:e.opacity});e===t.errorShape&&(l.width=e.width);var c=r(l);return c.data=t.data,c}))}var Wu={require:["chart","resolver","symbol"],defaultSettings:{settings:{},data:{},animations:{enabled:!1,trackBy:function(t){return t.data.value}},style:{item:"$shape"}},render:function(t){var e=t.data,n=this.resolver.resolve({data:e,defaults:M({},Lu,this.style.item),settings:this.settings.settings,scaled:{x:this.rect.width,y:this.rect.height}}),r=this.rect,i=r.width,a=r.height,o=M({},Bu,this.settings.settings.sizeLimits),s=n.items,u=function(t,e,n,r,i){var a=Hu(t?t.scale:void 0,n),o=Hu(e?e.scale:void 0,r),s=Math.min(a.value*i[a.isBandwidth?"maxRelDiscrete":"maxRelExtent"],o.value*i[o.isBandwidth?"maxRelDiscrete":"maxRelExtent"]),u=Math.min(a.value*i[a.isBandwidth?"minRelDiscrete":"minRelExtent"],o.value*i[o.isBandwidth?"minRelDiscrete":"minRelExtent"]);return{min:Math.max(1,Math.floor(u)),max:Math.max(1,Math.floor(s)),maxGlobal:i.maxPx,minGlobal:i.minPx}}(n.settings.x,n.settings.y,i,a,o);return $u(s,this.rect,u,this.settings.shapeFn||this.symbol)}};Math.PI;var Vu={label:"",arc:1,show:!0,fill:"#333",stroke:"#ccc",strokeWidth:1,strokeLinejoin:"round",opacity:1,innerRadius:0,outerRadius:.8,cornerRadius:0,offset:0};function Uu(t,e,n,r){var i=e.x,a=e.y,o=e.width,s=e.height,u=Dt(),l={x:i+o/2,y:a+s/2},c=Math.min(o,s)/2,h=Math.min(o,s)/2,f=h/100;return t.map((function(t,e){var i=n[e];i.type="path";var a=h*i.outerRadius,o=c*i.innerRadius,s=f*i.cornerRadius;u.innerRadius(o),u.outerRadius(a),u.cornerRadius(s),i.arcDatum=t;var d=u.centroid(t),p=i.offset?function(t,e,n,r){var i=H(t,2),a=i[0],o=i[1],s=Math.sqrt(a*a+o*o),u=n-r;return{x:(a/=s)*e*u,y:(o/=s)*e*u}}(d,i.offset,a,o):{x:0,y:0};return i.transform="translate(".concat(p.x,", ").concat(p.y,") translate(").concat(l.x,", ").concat(l.y,")"),i.desc={share:t.value/r,slice:{start:t.startAngle,end:t.endAngle,innerRadius:o,outerRadius:a,cornerRadius:s,offset:{x:l.x+p.x,y:l.y+p.y}}},i}))}function Yu(t,e){return t.slice&&"arc"in t.slice?e.arc:e.data.value}var Xu={require:["chart","resolver"],defaultSettings:{settings:{startAngle:0,endAngle:2*Math.PI,padAngle:0,slice:{}},style:{slice:"$shape"},data:{}},render:function(t){for(var e=t.data,n=[],r=[],i=this.settings.settings,a=this.resolver.resolve({data:e,defaults:M({},Vu,this.style.slice),settings:i.slice}).items,o=0,s=0,u=a.length;s<u;s++){var l=Yu(i,a[s]);l>0&&a[s].outerRadius>=a[s].innerRadius&&(n.push(l),r.push(a[s]),o+=l)}var c=function(){var t=zt,e=Pt,n=null,r=ct(0),i=ct(wt),a=ct(0);function o(o){var s,u,l,c,h,f=o.length,d=0,p=new Array(f),g=new Array(f),v=+r.apply(this,arguments),y=Math.min(wt,Math.max(-wt,i.apply(this,arguments)-v)),m=Math.min(Math.abs(y)/f,a.apply(this,arguments)),x=m*(y<0?-1:1);for(s=0;s<f;++s)(h=g[p[s]=s]=+t(o[s],s,o))>0&&(d+=h);for(null!=e?p.sort((function(t,n){return e(g[t],g[n])})):null!=n&&p.sort((function(t,e){return n(o[t],o[e])})),s=0,l=d?(y-f*x)/d:0;s<f;++s,v=c)u=p[s],c=v+((h=g[u])>0?h*l:0)+x,g[u]={data:o[u],index:s,value:h,startAngle:v,endAngle:c,padAngle:m};return g}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:ct(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:ct(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:ct(+t),o):i},o.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:ct(+t),o):a},o}().sortValues(null);return c.startAngle(i.startAngle),c.endAngle(i.endAngle),c.padAngle(i.padAngle),Uu(c(n),M({},this.rect,{x:0,y:0}),r,o)}};var Ku=function(t){function e(e){if(t[e.type]&&t[e.type].condition(e)){var n=t[e.type],r=void 0===n.conditionAppend||n.conditionAppend(e);n.items.forEach((function(t){var n=Math.round(e[t.key]),i=e[t.key]-n;e[t.key]=n,r&&"append"===t.type&&(i>0?e[t.key]+=.5:e[t.key]-=.5)}))}}return void 0===t&&((t={}).line={append:["x1","x2","y1","y2"],round:[],condition:function(t){return t.x1===t.x2||t.y1===t.y2},conditionAppend:function(t){return t.strokeWidth%2!=0}},t.rect={append:["x","y"],round:["width","height"],condition:function(){return!0},conditionAppend:function(t){return t.strokeWidth%2!=0}}),Object.keys(t).forEach((function(e){var n=t[e];n.items=[],n.append.forEach((function(t){n.items.push({key:t,type:"append"})})),n.round.forEach((function(t){n.items.push({key:t,type:"round"})}))})),e.multiple=function(t){return t.forEach((function(t){return e(t)}))},e}(),Gu=function(){function t(){q(this,t),this.reset(),this.push.apply(this,arguments)}return A(t,[{key:"transposeCoordinate",value:function(t,e,n){if("number"==typeof e&&isFinite(e)){var r=t.substring(0,1);if("x"===r||"cx"===t)return e*this.width;if("width"===t)return e*this.width;if("r"===t)return e*(n?this.height:this.width);if("y"===r||"cy"===t)return e*this.height;if("height"===t)return e*this.height}return e}},{key:"push",value:function(){var t;return(t=this.storage).push.apply(t,arguments),this}},{key:"processItem",value:function(e){var n={},r=void 0!==e.flipXY?e.flipXY:this.flipXY,i=void 0!==e.crisp?e.crisp:this.crisp;if(e.fn&&"function"==typeof e.fn){var a=r?this.height:this.width,o=r?this.width:this.height;e=e.fn({width:a,height:o,flipXY:r});for(var s=Object.keys(e),u=0,l=s.length;u<l;u++){var c=s[u];n[t.evaluateKey(c,r)]=e[c]}}else for(var h=Object.keys(e),f=0,d=h.length;f<d;f++){var p=h[f],g=t.evaluateKey(p,r),v=this.transposeCoordinate(g,e[p],r);n[g]=v}return i&&Ku(n),n}},{key:"output",value:function(){for(var t=[],e=0,n=this.storage.length;e<n;e++){var r=this.processItem(this.storage[e]);t.push(r)}return t}},{key:"reset",value:function(){this.storage=[],this.flipXY=!1,this.crisp=!1,this.width=0,this.height=0}}],[{key:"evaluateKey",value:function(t,e){if(e){var n=t.substring(0,1),r=t.substring(1);if("x"===n)return"y".concat(r);if("y"===n)return"x".concat(r);if("cx"===t)return"cy";if("cy"===t)return"cx";if("width"===t)return"height";if("height"===t)return"width"}return t}}]),t}();function Zu(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Gu,e)}function Ju(t,e){return t&&e?t.cachedTicks&&t.cachedTicks()||t.ticks({distance:e}):[]}var Qu={created:function(){},require:["chart","renderer","resolver"],defaultSettings:{layout:{displayOrder:0},style:{ticks:"$guide-line",minorTicks:"$guide-line--minor"}},beforeRender:function(){this.blueprint=Zu(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this;if(this.x=this.settings.x?this.chart.scale(this.settings.x):null,this.y=this.settings.y?this.chart.scale(this.settings.y):null,Eo(this,"x",this.rect.width),Eo(this,"y",this.rect.height),!this.x&&!this.y)return[];this.settings.ticks=M({show:!0},this.style.ticks,this.settings.ticks||{}),this.settings.minorTicks=M({show:!1},this.style.minorTicks,this.settings.minorTicks||{}),this.lines={x:[],y:[]},this.lines.x=Ju(this.x,this.rect.width),this.lines.y=Ju(this.y,this.rect.height),this.lines.y=this.lines.y.map((function(t){return M(t,{flipXY:!0})}));var e=function(e){var n=e.dir,r=e.isMinor,i=t.lines[n].filter((function(t){return!!t.isMinor===r})),a=r?t.settings.minorTicks:t.settings.ticks;t.resolver.resolve({settings:a,data:{items:i,dir:n}}).items.forEach((function(e){var r,i,a=e.data;e.show&&t.blueprint.push({type:"line",x1:a.position,y1:0,x2:a.position,y2:1,stroke:e.stroke||"black",strokeWidth:void 0!==e.strokeWidth?e.strokeWidth:1,strokeDasharray:void 0!==e.strokeDasharray?e.strokeDasharray:void 0,flipXY:a.flipXY||!1,value:null!==(r=a.value)&&void 0!==r?r:null===(i=a.data)||void 0===i?void 0:i.value,dir:n})}))};return e({dir:"x",isMinor:!1}),e({dir:"x",isMinor:!0}),e({dir:"y",isMinor:!1}),e({dir:"y",isMinor:!0}),this.blueprint.output()}};function tl(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.8,"left"===r||"right"===r){var i="right"===r;return"\n      M ".concat(t," ").concat(e-n,"\n      A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(i?0:1,", ").concat(t," ").concat(e+n,"\n      L ").concat(i?t+n:t-n," ").concat(e," Z\n    ")}var a="bottom"===r;return"\n    M ".concat(t-n," ").concat(e,"\n    A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(a?1:0,", ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(a?e+n:e-n," Z\n  ")}function el(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.75,"left"===r||"right"===r){var i="right"===r;return"\n      M ".concat(t+=i?1.5*n:-1.5*n," ").concat(e-n,"\n      L ").concat(t," ").concat(e+n,"\n      L ").concat(i?t+n:t-n," ").concat(e," Z\n    ")}var a="bottom"===r;return e+=a?1.5*n:-1.5*n,"\n    M ".concat(t-n," ").concat(e,"\n    L ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(a?e+n:e-n," Z\n  ")}function nl(t){if(void 0===t)return 0;if("number"==typeof t&&isFinite(t))return t;if("string"==typeof t)switch(t){case"center":case"middle":return.5;case"bottom":case"right":return 1;case"top":case"left":default:return 0}return 0}function rl(t){var e={value:t.value};return t.label&&(e.label=t.label.text),e}function il(t){return void 0!==("function"==typeof t.value?t.value():t.value)}function al(t,e){var n=t.min();if(n===t.max()){var r=function(t){var e=t.range();return 2===(null==e?void 0:e.length)&&e[0]>e[1]}(t);if(e<n)return r?2:-1;if(e>n)return r?-1:2}return t(e)}var ol={require:["chart","renderer"],defaultSettings:{layout:{displayOrder:0},style:{oob:{show:!0,width:10,fill:"#1A1A1A",stroke:"transparent",strokeWidth:0,opacity:1,text:{fontFamily:"Arial",stroke:"transparent",fill:"#fff",strokeWidth:0,opacity:1},triangle:{fill:"#4D4D4D",stroke:"transparent",strokeWidth:0,opacity:1},padding:{x:28,y:5}},line:{stroke:"#000"},label:{strokeWidth:0}}},preferredSize:function(){return 30},beforeRender:function(){this.blueprint=Zu(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var t=this,e=this.settings;if(this.lines={x:[],y:[]},this.lines.x=e.lines&&e.lines.x||[],this.lines.y=e.lines&&e.lines.y||[],0===this.lines.x.length&&0===this.lines.y.length)return[];var n={x0:[],x1:[],y0:[],y1:[]};this.lines.x=this.lines.x.filter(il).map((function(e){if("function"==typeof e.value&&(e.value=e.value()),e.scale){var n=t.chart.scale(e.scale),r=al(n,e.value);return M(e,{scale:n,position:r})}return M(e,{position:e.value})})),this.lines.y=this.lines.y.filter(il).map((function(e){if("function"==typeof e.value&&(e.value=e.value()),e.scale){var n=t.chart.scale(e.scale),r=al(n,e.value);return M(e,{scale:n,position:r,flipXY:!0})}return M(e,{position:e.value,flipXY:!0})})),this.lines.x=this.lines.x.filter((function(t){return!(t.position<0||t.position>1)||(n["x".concat(t.position>1?1:0)].push(rl(t)),!1)})),this.lines.y=this.lines.y.filter((function(t){return!(t.position<0||t.position>1)||(n["y".concat(t.position>1?1:0)].push(rl(t)),!1)}));var r=[];return[].concat($(this.lines.x),$(this.lines.y)).forEach((function(n){(!0===n.show||void 0===n.show)&&function(t){var e,n=t.chart,r=t.blueprint,i=t.renderer,a=t.p,o=t.settings,s=t.items,u=!0,l=!1,c=!1,h=!1,f=M(!0,{},o.style.line,a.line||{});if(e=r.processItem({type:"line",x1:a.position,y1:0,x2:a.position,y2:1,stroke:f.stroke||"black",strokeWidth:f.strokeWidth||1,strokeDasharray:f.strokeDasharray,flipXY:a.flipXY||!1,value:a.valueInfo?a.valueInfo.id:a.value}),a.label){var d,p=M(!0,{fill:"#000",fontFamily:"Arial",fontSize:"12px",opacity:1,maxWidth:1,maxWidthPx:9999,padding:5,background:{fill:"#fff",stroke:"transparent",strokeWidth:0,opacity:.5}},o.style.label||{},{fill:f.stroke},a.label),g={width:0,height:0},v="";if("string"==typeof a.formatter)d=n.formatter(a.formatter);else if("object"===R(a.formatter))d=n.formatter(a.formatter);else if(void 0!==a.scale&&a.scale.data){var y=a.scale.data()&&a.scale.data().fields;d=y&&y[0]?y[0].formatter():null}!1!==a.label.showValue&&(d?v=" (".concat(d(a.value),")"):a.scale&&(v=" (".concat(a.value,")"))),v&&(g=i.measureText({text:v,fontFamily:p.fontFamily,fontSize:p.fontSize}));var m=i.measureText({text:p.text||"",fontFamily:p.fontFamily,fontSize:p.fontSize}),x={width:m.width+g.width,height:Math.max(m.height,g.height)},b=p.padding,w=nl(a.flipXY?p.vAlign:p.align),k=nl(a.flipXY?p.align:p.vAlign),_=Math.min(1+x.width+2*b,p.maxWidth*r.width,p.maxWidthPx),S=x.height+2*b,C=a.flipXY?S:_,q=a.flipXY?_:S;if((l=r.processItem({fn:function(t){var e=t.width,n=t.height,i=a.position*e-(a.flipXY?S:_)*(1-w);return{type:"rect",x:i=a.flipXY?i:Math.max(i,0),y:Math.max(Math.abs(k*n-q*k),0),width:a.flipXY?C:Math.min(C,r.width-i),height:q,stroke:p.background.stroke,strokeWidth:p.background.strokeWidth,fill:p.background.fill,opacity:p.background.opacity}},flipXY:a.flipXY||!1})).x<-1||l.x+l.width>r.width+1||l.y<-1||l.y+l.height>r.height+1)l=void 0;else{c={type:"text",text:p.text||"",fill:p.fill,opacity:p.opacity,fontFamily:p.fontFamily,fontSize:p.fontSize,x:l.x+b,y:l.y+l.height/2+x.height/3,maxWidth:l.width-2*b-g.width,anchor:"start"},v&&(h={type:"text",text:v||"",fill:p.fill,opacity:p.opacity,fontFamily:p.fontFamily,fontSize:p.fontSize,x:c.x+3+(l.width-(g.width+2*b)),y:c.y});for(var N=0,A=s.length;N<A;N++){var D=s[N];"rect"===D.type?Os(l,D)&&(u=!1):"line"===D.type&&a.flipXY===D.flipXY&&Ts(l,D)&&(u=!1)}}}s.push(e),u&&l&&c&&(s.push(l,c),h&&s.push(h))}({chart:t.chart,blueprint:t.blueprint,renderer:t.renderer,p:n,settings:e,items:r})})),e.style.oob.show&&function(t){for(var e=t.blueprint,n=t.oob,r=t.settings,i=t.items,a=Object.keys(n),o=r.style.oob||{},s=function(t,r){var s=a[t],u=n[s];if(u.length>0){var l=s.charAt(1),c="y"===s.charAt(0),h=o.padding.x+o.width,f=o.padding.y+o.width,d="bottom";d=c?"1"===l?"bottom":"top":"1"===l?"right":"left";var p=e.processItem({fn:function(t){var e=t.width,n=t.height,r=l*e+("1"===l?-h:h),i=c?f:n-f;return"arc"===o.type?{type:"path",d:tl(c?i:r,c?r:i,o.width,d),x:r,y:i,stroke:o.stroke,fill:o.fill,strokeWidth:o.strokeWidth||0}:{type:"circle",cx:r,cy:i,r:o.width,stroke:o.stroke,fill:o.fill,strokeWidth:o.strokeWidth||0,opacity:o.opacity,data:u}},flipXY:c}),g=p.cx||p.x,v=p.cy||p.y,y={type:"text",text:u.length||"",x:g-.4*o.width,y:v+.4*o.width,fontFamily:o.text.fontFamily,fontSize:"".concat(1.3*o.width,"px"),stroke:o.text.stroke,fill:o.text.fill,strokeWidth:o.text.strokeWidth||0,opacity:o.text.opacity},m={type:"path",d:el(g,v,o.width,d),x:g,y:v,stroke:o.triangle.stroke,fill:o.triangle.fill,strokeWidth:o.triangle.strokeWidth||0,opacity:o.triangle.opacity};i.push(p,y,m)}},u=0,l=a.length;u<l;u++)s(u)}({blueprint:this.blueprint,oob:n,settings:e,items:r}),r}};function sl(t){var e={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===t.align||"bottom"===t.align?(e.x1=t.innerRect.x-t.outerRect.x,e.x2=e.x1+t.innerRect.width,e.y1=e.y2="top"===t.align?t.innerRect.height-t.padding:t.padding):(e.x1=e.x2="left"===t.align?t.innerRect.width-t.padding:t.padding,e.y1=t.innerRect.y-t.outerRect.y,e.y2=e.y1+t.innerRect.height),function(t,e){M(t,e.style)}(e,t),e}function ul(t){return"string"==typeof t||"number"==typeof t?t:"-"}function ll(t,e,n){n.layered||!n.stepSize?function(t,e){e.collider={type:"polygon",vertices:[{x:e.boundingRect.x,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y},{x:e.boundingRect.x+e.boundingRect.width,y:e.boundingRect.y+e.boundingRect.height},{x:e.boundingRect.x,y:e.boundingRect.y+e.boundingRect.height}]}}(0,e):n.tilted?function(t,e,n){var r=n.angle*(Math.PI/180),i=Math.max(n.stepSize/2,e.boundingRect.height/2),a="start"===e.anchor,o="end"===e.anchor&&r<0,s="start"===e.anchor&&r>=0,u=e.boundingRect.y+(s||o?e.boundingRect.height:0),l=[{x:e.x-i,y:u},{x:e.x+i,y:u}].map((function(t){return as(t,r,{x:e.x,y:e.y})})),c={x:a?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y+e.boundingRect.height},h={x:a?e.boundingRect.x+e.boundingRect.width+10:e.boundingRect.x-10,y:e.boundingRect.y},f=r>=0?[c,h]:[h,c];l.push.apply(l,f),e.collider={type:"polygon",vertices:l}}(0,e,n):function(t,e,n){if("bottom"===n.align||"top"===n.align){var r=t.position*n.innerRect.width+(n.innerRect.x-n.outerRect.x-n.stepSize/2);e.collider={type:"rect",x:r,y:0,width:r<0?n.stepSize+r:n.stepSize,height:n.innerRect.height}}else{var i=t.position*n.innerRect.height+(n.innerRect.y-n.outerRect.y-n.stepSize/2);e.collider={type:"rect",x:0,y:i,width:n.innerRect.width,height:i<0?n.stepSize+i:n.stepSize}}var a=e.collider;a.x=Math.max(a.x,0),a.y=Math.max(a.y,0);var o=a.x+a.width-(n.outerRect.x+n.outerRect.width);a.width=o>0?a.width-o:a.width;var s=a.y+a.height-(n.outerRect.y+n.outerRect.height);a.height=s>0?a.height-s:a.height}(t,e,n)}function cl(t,e){var n=isNaN(t.style.align)?.5:Math.min(Math.max(t.style.align,0),1),r=0;if(t.tilted)r=t.stepSize*n;else{var i=e?t.textRect.height:t.textRect.width;r=Math.max(0,t.stepSize-i)*n}return r}function hl(t,e){var n,r,i={type:"text",text:ul(t.label),x:0,y:0,maxWidth:e.maxWidth,maxHeight:e.maxHeight,tickValue:null!==(n=t.value)&&void 0!==n?n:null===(r=t.data)||void 0===r?void 0:r.value};return"top"===e.align||"bottom"===e.align?(i.x=t.start*e.innerRect.width+(e.innerRect.x-e.outerRect.x)+cl(e,!1),i.y="top"===e.align?e.innerRect.height:0,i.anchor=e.stepSize?"start":"middle",i.x+=isNaN(e.style.offset)?0:+e.style.offset):(i.y=t.start*e.innerRect.height+(e.innerRect.y-e.outerRect.y)+cl(e,!0),i.x="left"===e.align?e.innerRect.width:0,i.anchor="left"===e.align?"end":"start",i.baseline=e.stepSize?"text-before-edge":"central",i.y+=isNaN(e.style.offset)?0:+e.style.offset),function(t,e){["fill","fontSize","fontFamily"].forEach((function(n){t[n]=e.style[n]}))}(i,e),function(t,e){if(!e.tilted&&!e.stepSize)if("top"===e.align||"bottom"===e.align){var n=e.outerRect.width,r=Math.min(e.maxWidth/2,e.textRect.width/2),i=t.x-r,a=t.x+r;i<0?(t.anchor="start",t.x=e.innerRect.x-e.outerRect.x):a>n&&(t.anchor="end",t.x=e.innerRect.width+e.innerRect.x)}else{var o=e.outerRect.height,s=e.maxHeight/2,u=t.y-s,l=t.y+s;u<0?(t.y=e.innerRect.y-e.outerRect.y,t.baseline="text-before-edge"):l>o&&(t.y=e.innerRect.height+(e.innerRect.y-e.outerRect.y),t.baseline="text-after-edge")}}(i,e),function(t,e){"top"===e.align?t.y-=e.padding:"bottom"===e.align?t.y+=e.padding+e.maxHeight:"left"===e.align?t.x-=e.padding:"right"===e.align&&(t.x+=e.padding)}(i,e),function(t,e){if(e.tilted){var n=-e.angle,r=n*(Math.PI/180);"bottom"===e.align?(t.x-=e.maxHeight*Math.sin(r)/2,t.y-=e.maxHeight,t.y+=e.maxHeight*Math.cos(r)/2):t.x-=e.maxHeight*Math.sin(r)/3,t.transform="rotate(".concat(n,", ").concat(t.x,", ").concat(t.y,")"),t.anchor="bottom"===e.align==e.angle<0?"start":"end";var i=Math.cos(r)*e.maxWidth;if("bottom"===e.align==e.angle<0){var a=e.outerRect.width-e.paddingEnd;t.x+i>a&&(t.maxWidth=(a-t.x-10)/Math.cos(r))}else{var o=e.paddingEnd;t.x-i<o&&(t.maxWidth=(t.x-o-10)/Math.cos(r))}}}(i,e),function(t,e){t.boundingRect=e.textBounds(t)}(i,e),ll(t,i,e),i}function fl(t,e){var n={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null},tickValue:t.value};return"top"===e.align||"bottom"===e.align?(n.x1=n.x2=t.position*e.innerRect.width+(e.innerRect.x-e.outerRect.x),n.y1="top"===e.align?e.innerRect.height:0,n.y2="top"===e.align?n.y1-e.tickSize:n.y1+e.tickSize):(n.y1=n.y2=t.position*e.innerRect.height+(e.innerRect.y-e.outerRect.y),n.x1="left"===e.align?e.innerRect.width:0,n.x2="left"===e.align?n.x1-e.tickSize:n.x1+e.tickSize),function(t,e){M(t,e.style)}(n,e),function(t,e){"top"===e.align?(t.y1-=e.padding,t.y2-=e.padding):"bottom"===e.align?(t.y1+=e.padding,t.y2+=e.padding):"left"===e.align?(t.x1-=e.padding,t.x2-=e.padding):"right"===e.align&&(t.x1+=e.padding,t.x2+=e.padding)}(n,e),function(t,e){var n=t.strokeWidth/2;t.x1===e.innerRect.width?(t.x1-=n,t.x2-=n):0===t.x1?(t.x1+=n,t.x2+=n):t.y1===e.innerRect.height?(t.y1-=n,t.y2-=n):0===t.y1&&(t.y1+=n,t.y2+=n)}(n,e),n}function dl(t){return!t.isMinor&&t.position>=0&&t.position<=1}function pl(t){var e=t.rect,n=t.state,r=t.majorTicks,i=t.measure;return t.horizontal?function(t){for(var e=t.majorTicks,n=t.measureText,r=t.rect,i="layered"===t.state.labels.activeMode?2:1,a=r.width,o=e.map((function(t){return t.label})).map((function(t){return"".concat(t.slice(0,1)).concat(t.length>1?"…":"")})).map(n).map((function(t){return t.width})),s=0;s<e.length;++s){var u=e[s];if(i*a*Math.abs(u.start-u.end)<o[s])return!0}return!1}({majorTicks:r,measureText:i,rect:e,state:n}):function(t){var e=t.majorTicks,n=t.measureText,r=t.rect.height,i=n("M").height;return!(e.length<2)&&r*Math.abs(e[0].position-e[1].position)<i}({majorTicks:r,measureText:i,rect:e,state:n})}function gl(t){var e=t.value,n=t.maxValue,r=t.minValue,i=t.range,a=t.modifier;return isNaN(i)||isNaN(a)||(e=i*a),e>n&&(e=n),e<r&&(e=r),e}function vl(t){var e=t.isDiscrete,n=t.rect,r=t.formatter,i=t.measureText,a=t.scale,o=t.settings,s=t.state,u=0,l={left:0,top:0,right:0,bottom:0},c=o.labels,h=c.maxLengthPx,f=c.minLengthPx;if(o.labels.show){var d,p,g=o.align,v="top"===g||"bottom"===g,y=v?n.inner.width:n.inner.height,m=a.ticks({settings:o,distance:y,formatter:r}).filter(dl),x=function(t){var e=i({text:t,fontSize:o.labels.fontSize,fontFamily:o.labels.fontFamily});return e.width=gl({value:e.width,maxValue:h,minValue:f}),e};if(e&&v&&"auto"===o.labels.mode&&(!function(t){var e=t.majorTicks,n=t.measure,r=t.rect,i=t.state,a=t.settings,o=a.labels.maxGlyphCount,s="layered"===i.labels.activeMode?2:1,u=a.labels.tiltThreshold?a.labels.tiltThreshold:.7,l=n("…").width,c=r.width,h=0;if(isNaN(o))for(var f=0;f<e.length;f++){var d=e[f],p=d.label;if(n(p).width*(p.length>1?u:1)+l>(h=s*c*Math.abs(d.start-d.end)))return!0}else if(h=s*c*e.reduce((function(t,e){return Math.min(Math.abs(e.start-e.end),t)}),1/0),n("M").width*u*o+l>h)return!0;return!1}({majorTicks:m,measure:x,rect:n.inner,state:s,settings:o})?s.labels.activeMode="horizontal":s.labels.activeMode="tilted"),!o.labels.filterOverlapping&&"tilted"!==s.labels.activeMode&&pl({rect:n.inner,state:s,majorTicks:m,measure:x,horizontal:v}))return{size:Math.max(n.outer.width,n.outer.height),isToLarge:!0};if("tilted"===s.labels.activeMode){var b=Math.abs(o.labels.tiltAngle)*(Math.PI/180);d=function(t){return gl({value:t.width,maxValue:h,minValue:f})*Math.sin(b)+t.height*Math.cos(b)}}else d=v?function(t){return t.height}:function(t){return gl({value:t.width,maxValue:h,minValue:f})};if(v&&"tilted"!==s.labels.activeMode)p=["M"];else if(isNaN(o.labels.maxGlyphCount))p=m.map((function(t){return t.label}));else{for(var w="",k=0;k<o.labels.maxGlyphCount;k++)w+="M";p=[w]}var M=p.map(x),_=M.map(d),S=Math.max.apply(Math,$(_).concat([0]));if(u+=S,u+=o.labels.margin,"layered"===s.labels.activeMode&&(u*=2),"tilted"===s.labels.activeMode){var C="bottom"===o.align==o.labels.tiltAngle>=0,R=Math.abs(o.labels.tiltAngle)*(Math.PI/180),q=(S-x("M").height*Math.cos(R))/Math.sin(R),N=Math.min(o.labels.maxEdgeBleed,Math.max.apply(Math,$(M.map((function(t){return Math.min(q,t.width)*Math.cos(R)+t.height})).map((function(t,e){var r=m[e]?m[e].position:0;return C?t-r*n.inner.width:t-(1-r)*n.inner.width}))).concat([0])))+o.paddingEnd;if(l[C?"left":"right"]=N,!o.labels.filterOverlapping&&function(t){var e=t.majorTicks,n=t.measureText,r=t.rect,i=t.bleedSize,a=t.angle;if(e.length<2)return!1;if(0===a)return!0;var o=Math.abs(a),s=1/(Math.min(r.outer.width-i,r.inner.width)*Math.abs(e[0].position-e[1].position));return n("M").height>Math.sin(o*(Math.PI/180))/s}({majorTicks:m,measureText:x,rect:n,bleedSize:N,angle:o.labels.tiltAngle}))return{size:Math.max(n.outer.width,n.outer.height),isToLarge:!0}}}return{size:u,edgeBleed:l}}var yl=function(t,e,n){return t.width*Math.abs(e.position-n.position)};function ml(t){var e=t.layered,n=t.major,r=t.innerRect,i=t.outerRect,a=t.tick,o=t.index,s=e?2:1,u=n[o-s],l=n[o+s],c=u?yl(r,a,u)/2-2:1/0,h=l?yl(r,a,l)/2-2:1/0;return n.length<2?r.width:u?l?2*Math.min(c,h):function(t){var e=t.innerRect,n=t.outerRect,r=t.tick,i=t.prevWidth,a=e.x-n.x,o=n.width-e.width-a,s=e.width-e.width*r.position+o,u=2*Math.min(i,s),l=1===r.position?e.width/2-2:0;return Math.max(i,u,l)}({innerRect:r,outerRect:i,tick:a,prevWidth:c}):function(t){var e=t.innerRect,n=t.outerRect,r=t.tick,i=t.nextWidth,a=e.x-n.x,o=e.width*r.position+a,s=2*Math.min(i,o),u=0===r.position?e.width/2-2:0;return Math.max(i,s,u)}({innerRect:r,outerRect:i,tick:a,nextWidth:h})}function xl(t){var e=0;return e+=t.paddingStart,e+=t.line.show?t.line.strokeWidth/2:0,e+=t.ticks.show?t.ticks.margin:0}function bl(t){var e=0;return e+=t.ticks.show?t.ticks.tickSize:0,e+=xl(t)+t.labels.margin}function wl(t,e){return t.map((function(t){return fl(t,e)}))}function kl(t,e){return e?Math.abs(e.end-e.start):t.bandwidth()}function Ml(t){var e=t.textMetrics,n=t.settings,r=t.innerRect,i=t.scale,a=t.tilted,o=t.layered,s=t.tick,u=e.height,l=kl(i,s),c={width:0,height:u};if("left"===n.align||"right"===n.align)c.width=r.width-bl(n)-n.paddingEnd;else if(o)c.width=l*r.width*2;else if(a){var h=Math.abs(n.labels.tiltAngle)*(Math.PI/180);c.width=(r.height-bl(n)-n.paddingEnd-u*Math.cos(h))/Math.sin(h)}else c.width=l*r.width;return c.width=gl({value:c.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),c}function _l(t){var e=t.textMetrics,n=t.settings,r=t.innerRect,i=t.outerRect,a=t.tilted,o=t.layered,s=t.tick,u=t.index,l=t.major,c=e.height,h={width:0,height:c};if("left"===n.align||"right"===n.align)h.width=r.width-bl(n)-n.paddingEnd;else if(a){var f=Math.abs(n.labels.tiltAngle)*(Math.PI/180);h.width=(r.height-bl(n)-n.paddingEnd-c*Math.cos(f))/Math.sin(f)}else h.width=ml({layered:o,major:l,innerRect:r,outerRect:i,tick:s,index:u});return h.width=gl({value:h.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),h}function Sl(t){var e;function n(){return e=_l,n}function r(){return e=Ml,r}function i(t){var n,r=t.settings,i=t.scale,a=t.innerRect,o=t.outerRect,s=t.measureText,u=t.ticks,l=t.state,c=t.textBounds,h=[],f=function(t){return t.filter((function(t){return!t.isMinor}))}(u),d=function(t){return t.filter((function(t){return t.isMinor}))}(u),p={innerRect:a,align:r.align,outerRect:o},g="tilted"===l.labels.activeMode,v="layered"===l.labels.activeMode;if(r.line.show&&(p.style=r.line,p.padding=r.paddingStart,h.push(sl(p))),r.ticks.show&&(p.style=r.ticks,p.tickSize=r.ticks.tickSize,p.padding=xl(r),n=wl(f,p)),r.labels.show){var y=bl(r);p.style=r.labels,p.padding=y,p.tilted=g,p.layered=v,p.angle=r.labels.tiltAngle,p.paddingEnd=r.paddingEnd,p.textBounds=c;var m=function(t,n){p.textRect=function(t){var e=t.style;return(0,t.measureText)({text:t.tick.label,fontSize:e.fontSize,fontFamily:e.fontFamily})}({tick:t,measureText:s,style:p.style});var l=e({textMetrics:p.textRect,settings:r,innerRect:a,outerRect:o,scale:i,tilted:g,layered:v,tick:t,major:f,index:n});p.maxWidth=l.width,p.maxHeight=l.height,p.stepSize=function(t){var e=t.innerRect,n=t.scale,r=t.settings,i=t.tick;return("top"===r.align||"bottom"===r.align?e.width:e.height)*kl(n,i)}({innerRect:a,scale:i,ticks:u,settings:r,tick:t})},x=[];x=!v||"top"!==r.align&&"bottom"!==r.align?function(t,e,n){return t.map((function(t,r){n(t,r);var i=hl(t,e);return i.data=t.data,i}))}(f,p,m):function(t,e,n,r){var i=e.padding,a=bl(n);return t.map((function(t,o){r(t,o);var s=a+e.maxHeight+n.labels.margin;e.layer=o%2,e.padding=o%2==0?i:s;var u=hl(t,e);return u.data=t.data,u}))}(f,p,r,m),r.labels.filterOverlapping&&function(t,e,n){var r=function(e,n){return Os(nt(1,t[e].boundingRect),nt(1,t[n].boundingRect))};if(n&&n.tilted){var i=Math.abs(n.angle);r=function(e,n){var r=1/Math.abs(t[e].x-t[n].x),a=Math.sin(i*(Math.PI/180))/r;return t[e].boundingRect.height>a}}for(var a=0;a<=t.length-1;a++)for(var o=a+1;o<=Math.min(a+5,a+(t.length-1));o++)t[a]&&t[o]&&r(a,o)&&(o===t.length-1?(t.splice(a,1),e&&e.splice(a,1)):(t.splice(o,1),e&&e.splice(o,1)),o--,a--)}(x,n,p),h.push.apply(h,$(x))}return r.minorTicks&&r.minorTicks.show&&d.length>0&&(p.style=r.minorTicks,p.tickSize=r.minorTicks.tickSize,p.padding=function(t){return t.line.strokeWidth+t.minorTicks.margin}(r),h.push.apply(h,$(wl(d,p)))),n&&h.push.apply(h,$(n)),h}return n.build=i,r.build=i,t?r():n()}var Cl={labels:{show:!0,tiltAngle:40,tiltThreshold:.7,maxEdgeBleed:1/0,margin:4,maxLengthPx:150,minLengthPx:0,mode:"auto",maxGlyphCount:NaN,align:.5,offset:0,filterOverlapping:!1},ticks:{show:!1,margin:0,tickSize:4},line:{show:!1},paddingStart:0,paddingEnd:10,align:"auto"},Rl={labels:{show:!0,margin:4,maxLengthPx:150,minLengthPx:0,align:.5,offset:0,filterOverlapping:!0},ticks:{show:!0,margin:0,tickSize:8},minorTicks:{show:!1,tickSize:3,margin:0},line:{show:!0},paddingStart:0,paddingEnd:10,align:"auto"};var ql={require:["chart","renderer","dockConfig"],defaultSettings:{layout:{displayOrder:0,prioOrder:0},settings:{},style:{labels:"$label",ticks:"$guide-line",minorTicks:"$guide-line--minor",line:"$guide-line"}},created:function(){this.state={isDiscrete:!!this.scale.bandwidth,isHorizontal:!1,labels:{activeMode:"horizontal"},ticks:[],innerRect:{width:0,height:0,x:0,y:0},outerRect:{width:0,height:0,x:0,y:0},defaultDock:void 0,concreteNodeBuilder:void 0,settings:void 0},this.state.isDiscrete?this.state.defaultDock="bottom":this.state.defaultDock="left",this.setState(this.settings)},setState:function(){this.state.isDiscrete=!!this.scale.bandwidth,this.state.settings=function(t){var e=t.state,n=t.style,r=t.settings,i=M(!0,{},e.isDiscrete?Cl:Rl,n),a=M(!0,{},i,r.settings),o=r.layout.dock||e.defaultDock;a.dock=o,a.align=function(t,e){var n=["top","bottom"],r=["left","right"];return-1!==n.indexOf(t)&&-1===r.indexOf(e)||-1!==r.indexOf(t)&&-1===n.indexOf(e)?t:e}(r.settings.align,o),a.labels.tiltAngle=Math.max(-90,Math.min(a.labels.tiltAngle,90));var s=a.paddingStart,u=a.paddingEnd;return a.paddingStart="function"==typeof s?s.call(null):s,a.paddingEnd="function"==typeof u?u.call(null):u,a}(this),this.state.concreteNodeBuilder=Sl(this.state.isDiscrete),this.dockConfig.dock(this.state.settings.dock),this.state.isHorizontal="top"===this.state.settings.align||"bottom"===this.state.settings.align,this.state.labels.activeMode=function(t,e,n){var r=e.labels.mode;return n&&t.isHorizontal?"auto"===r?t.labels.activeMode:-1!==["layered","tilted"].indexOf(e.labels.mode)&&-1!==["top","bottom"].indexOf(e.dock)?r:"horizontal":"horizontal"}(this.state,this.state.settings,this.state.isDiscrete)},preferredSize:function(t){var e=this.formatter,n=this.state,r=this.scale,i=this.state.isHorizontal?t.inner.width:t.inner.height;return this.state.pxScale=Io(r,i),function(t){var e=t.isDiscrete,n=t.rect,r=t.formatter,i=t.measureText,a=t.scale,o=t.settings,s=0,u=vl({isDiscrete:e,rect:n,formatter:r,measureText:i,scale:a,settings:o,state:t.state}),l=u.size,c=u.edgeBleed;if(s+=l,u.isToLarge)return{size:s};if(o.ticks.show&&(s+=o.ticks.margin,s+=o.ticks.tickSize),o.minorTicks&&o.minorTicks.show){var h=o.minorTicks.margin+o.minorTicks.tickSize;h>s&&(s=h)}if(o.line.show){var f=o.line.strokeWidth/2;s+=f,c[function(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"left":return"right";case"right":return"left";default:return t}}(o.align)]=Math.ceil(f)}return s+=o.paddingStart,{size:s+=o.paddingEnd,edgeBleed:c}}({isDiscrete:this.state.isDiscrete,rect:{inner:t.inner,outer:t.outer},formatter:e,measureText:this.renderer.measureText,scale:this.state.pxScale,settings:this.state.settings,state:n})},beforeUpdate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.settings;this.setState(e)},resize:function(t){var e=t.inner,n=t.outer,r=M({},e,function(t){var e=t.align,n=t.inner;return"left"===e?{x:n.width+n.x}:"right"===e||"bottom"===e?n:{y:n.y+n.height}}({align:this.state.settings.align,inner:e})),i=n||r;return M(this.state.innerRect,r),M(this.state.outerRect,i),n},beforeRender:function(){var t=this.scale,e=this.formatter,n=this.state.isHorizontal?this.state.innerRect.width:this.state.innerRect.height;this.state.pxScale=Io(t,n),this.state.ticks=this.state.pxScale.ticks({distance:n,formatter:e}).filter((function(t){return t.position>=0&&t.position<=1}))},render:function(){var t=this.state,e=[];return e.push.apply(e,$(this.state.concreteNodeBuilder.build({settings:this.state.settings,scale:this.state.pxScale,innerRect:this.state.innerRect,outerRect:this.state.outerRect,measureText:this.renderer.measureText,textBounds:this.renderer.textBounds,ticks:this.state.ticks,state:t}))),Ku.multiple(e),e}};var Nl={render:function(){return[]}};function Al(t,e,n){var r="";if("function"==typeof t)r=t();else if("string"==typeof t)r=t;else if(n){r=(n.data().fields||[]).map((function(t){return t.title()})).join(e)}return r}function Dl(t,e){var n="middle";return"left"===t?"top"===e?n="end":"bottom"===e&&(n="start"):"right"===t?"top"===e?n="start":"bottom"===e&&(n="end"):"left"===e?n="start":"right"===e&&(n="end"),n}var Ol={require:["renderer","chart"],defaultSettings:{layout:{dock:"bottom",displayOrder:0,prioOrder:0},settings:{paddingStart:5,paddingEnd:5,paddingLeft:0,paddingRight:0,anchor:"center",join:", ",maxLengthPx:NaN},style:{text:"$title"}},created:function(){this.definitionSettings=this.settings.settings;var t=this.settings.text,e=this.definitionSettings.join;this.title=Al(t,e,this.scale)},preferredSize:function(){return this.renderer.measureText({text:this.title,fontSize:this.style.text.fontSize,fontFamily:this.style.text.fontFamily}).height+this.definitionSettings.paddingStart+this.definitionSettings.paddingEnd},render:function(){var t=this.title,e=this.definitionSettings,n=this.rect,r=[];return r.push(function(t){var e=t.title,n=t.definitionSettings,r=t.dock,i=t.rect,a=t.measureText,o=t.style,s={type:"text",text:e,x:0,y:0,dx:0,dy:0,anchor:Dl(r,n.anchor),baseline:"alphabetical",stroke:"transparent",strokeWidth:0,fontWeight:"normal"};M(s,o.text);var u=a(s);if("top"===r||"bottom"===r){var l=i.width/2;"left"===n.anchor?l=n.paddingLeft||0:"right"===n.anchor&&(l=i.width-(n.paddingRight||0)),s.x=l,s.y="top"===r?i.height-n.paddingStart:n.paddingStart+u.height,s.dy="top"===r?-u.height/6:-u.height/3,s.maxWidth=.8*i.width}else{var c=i.height/2;"top"===n.anchor?c=n.paddingStart:"bottom"===n.anchor&&(c=i.height-n.paddingStart),s.y=c,s.x="left"===r?i.width-n.paddingStart:n.paddingStart,s.dx="left"===r?-u.height/3:u.height/3;var h="left"===r?270:90;s.transform="rotate(".concat(h,", ").concat(s.x+s.dx,", ").concat(s.y+s.dy,")"),s.maxWidth=.8*i.height}return isNaN(n.maxLengthPx)||(s.maxWidth=Math.min(s.maxWidth,n.maxLengthPx)),s}({title:t,dock:this.settings.layout.dock,definitionSettings:e,rect:n,measureText:this.renderer.measureText,style:this.style})),r},beforeUpdate:function(t){t.settings&&(M(this.settings,t.settings),this.definitionSettings=t.settings.settings);var e=this.settings.text,n=this.definitionSettings.join;this.title=Al(e,n,this.scale)}};function El(t,e){var n,r=t.settings.layout.dock,i=t.settings.settings.invert,a="top"===r||"bottom"===r,o=a?"width":"height",s=t.rect[o],u=t.chart.scroll(t.settings.scroll),l=e[a?"x":"y"];i&&(l=s-l);var c=u.getState();n={startOffset:l,startScroll:c.start,swipe:!1};var h=l/s*(c.max-c.min)+c.min;h<c.start?n.startScroll=h:h>c.start+c.viewSize&&(n.startScroll=h-c.viewSize);return{update:function(t){var e=t[a?"x":"y"];if(i&&(e=s-e),!n.swipe){if(Math.abs(n.startOffset-e)<=1)return;n.swipe=!0}var r=u.getState(),o=(e-n.startOffset)/s*(r.max-r.min),l=n.startScroll+o;u.moveTo(l)},end:function(t){var e=t[a?"x":"y"];i&&(e=s-e);var r=u.getState();if(n.swipe){var o=(e-n.startOffset)/s*(r.max-r.min),l=n.startScroll+o;u.moveTo(l)}else{var c=e/s*(r.max-r.min)+r.min-r.viewSize/2;u.moveTo(c)}}}}function Il(t,e){var n=e.element().getBoundingClientRect();return{x:t.center.x-n.left,y:t.center.y-n.top}}var Tl={require:["chart","renderer"],on:{panStart:function(t){var e=Il(t,this.renderer),n={x:e.x-t.deltaX,y:e.y-t.deltaY};this.currentMove=El(this,n),this.currentMove.update(e)},panMove:function(t){if(this.currentMove){var e=Il(t,this.renderer);this.currentMove.update(e)}},panEnd:function(t){if(this.currentMove){var e=Il(t,this.renderer);this.currentMove.end(e),this.currentMove=null}},panCancel:function(){this.currentMove=null},tap:function(t){var e=Il(t,this.renderer);El(this,e).end(e)}},defaultSettings:{settings:{backgroundColor:"#eee",thumbColor:"#ccc",width:16}},preferredSize:function(t){var e=this.chart.scroll(this.settings.scroll).getState();return e.viewSize>=e.max-e.min?Math.max(t.width,t.height):this.settings.settings.width},render:function(t){var e,n=this.settings.layout.dock,r=this.settings.settings.invert,i="top"===n||"bottom"===n,a=i?"width":"height",o=this.rect[a],s=this.chart.scroll(this.settings.scroll).getState(),u=o*(s.start-s.min)/(s.max-s.min),l=o*s.viewSize/(s.max-s.min);return r&&(u=o-u-l),t("div",{style:{position:"relative",width:"100%",height:"100%",background:this.settings.settings.backgroundColor,pointerEvents:"auto"}},[].concat(t("div",{class:"scroller",style:(e={position:"absolute"},D(e,i?"left":"top","".concat(u,"px")),D(e,i?"top":"left","25%"),D(e,i?"height":"width","50%"),D(e,a,"".concat(Math.max(1,l),"px")),D(e,"background",this.settings.settings.thumbColor),e)})))},renderer:"dom"};function jl(t){var e=t.h,n=t.isVertical,r=t.value,i=t.pos,a=t.align,o=t.borderHit,s=t.state,u=t.idx,l="end"!==a,c=l?{left:"0",top:"0"}:{right:"0",bottom:"0"},h=0,f="100%",d="100%";return s.targetRect&&"start"===s.settings.bubbles.align?(f="".concat(s.targetRect.x+s.targetRect.width,"px"),d="".concat(s.targetRect.y+s.targetRect.height,"px")):s.targetRect&&"end"===s.settings.bubbles.align&&(h=n?s.targetRect.x:s.targetRect.y,f="".concat(s.rect.width-h,"px"),d="".concat(s.rect.height-h,"px")),l||(i-=o),e("div",{onmouseover:function(t){t.srcElement.children[0].style.backgroundColor="#000",t.srcElement.children[0].style[n?"height":"width"]="2px"},onmouseout:function(t){t.srcElement.children[0].style.backgroundColor=s.style.line.stroke,t.srcElement.children[0].style[n?"height":"width"]="1px"},"data-value":r,"data-key":[s.key,"edge",u].join("-"),style:{cursor:n?"ns-resize":"ew-resize",position:"absolute",left:"".concat(n?h:i,"px"),top:"".concat(n?i:h,"px"),height:n?"".concat(o,"px"):d,width:n?f:"".concat(o,"px"),pointerEvents:"auto"}},[e("div",{style:M({backgroundColor:s.style.line.stroke,position:"absolute",height:n?"".concat(1,"px"):"100%",width:n?"100%":"".concat(1,"px"),pointerEvents:"none"},c)})])}function Pl(t){var e,n,r=t.h,i=t.isVertical,a=t.label,o=t.otherValue,s=t.rangeIdx,u=t.idx,l=t.pos,c=t.align,h=t.state,f=t.value,d="end"!==c,p="outside"===h.settings.bubbles.placement,g="none";i?(n=d?"left":"right",p&&(g=d?"translate(-100%,  0px)":"translate(100%,  0px)")):(n=d?"top":"bottom",p&&(g=d?"translate(0px, -100%)":"translate(0px,  100%)"));var v=h.edit&&h.edit.rangeIdx===s&&h.edit.bubbleIdx===u,y={position:"relative",borderRadius:"".concat(h.style.bubble.borderRadius,"px"),border:"".concat(h.style.bubble.strokeWidth,"px solid ").concat(h.style.bubble.stroke),backgroundColor:h.style.bubble.fill,color:h.style.bubble.color,fontFamily:h.style.bubble.fontFamily,fontSize:h.style.bubble.fontSize,padding:"4px 8px",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px",minWidth:"50px",minHeight:"1em",pointerEvents:"auto",transform:i?"translate(0,-50%)":"translate(-50%,0)",cursor:i?"ns-resize":"ew-resize"},m=h.style.bubble.stroke,x=v?r("input",{type:"text",value:f,style:C(C({},y),{},{textAlign:"start",textOverflow:"",fontSize:"13px"}),onkeyup:function(t){if("Enter"===t.key){t.preventDefault(),t.stopPropagation();var e=parseFloat(t.target.value);isNaN(e)?(m="rgba(230, 78, 78, 0.6)",t.target.style.border="".concat(h.style.bubble.strokeWidth,"px solid ").concat(m)):h.onEditConfirmed(s,e,o)}else"Escape"===t.key&&(t.preventDefault(),t.stopPropagation(),h.onEditCanceled())}}):r("div",{"data-key":[h.key,"bubble",s,u].join("-"),"data-other-value":o,"data-idx":s,"data-bidx":u,style:y},[a]);return r("div",{style:(e={position:"absolute"},D(e,n,"0"),D(e,i?"top":"left","".concat(l,"px")),D(e,"transform",g),e)},[x])}function zl(t){var e=t.h,n=t.isVertical,r=t.top,i=t.height,a=t.color,o=t.on,s=t.opacity;return e("div",M({style:{backgroundColor:a,opacity:s,position:"absolute",left:n?0:"".concat(r,"px"),top:n?"".concat(r,"px"):0,height:n?"".concat(i,"px"):"100%",width:n?"100%":"".concat(i,"px"),pointerEvents:"auto"}},o),[])}function Fl(t){var e=t.borderHit,n=t.els,r=t.isVertical,i=t.state,a=t.vStart,o=t.vEnd,s=t.idx,u=0;i.targetRect&&(u=r?i.targetRect.y:i.targetRect.x);var l=!!i.scale,c=l?i.scale.norm(a)*i.size:a,h=l?i.scale.norm(o)*i.size:o,f=Math.abs(c-h),d=Math.min(c,h)+u,p=d+f;if(i.targetRect){var g=i.targetFillRect||i.targetRect,v=r?g.height:g.width,y=l?i.scale.norm(a)*v:a,m=l?i.scale.norm(o)*v:o,x=Math.abs(y-m),b=Math.min(y,m),w={h:i.h,isVertical:r,top:b,height:x,color:i.style.target.fill,opacity:i.style.target.opacity};i.style.target.opacity<.8&&(w.on={onmouseover:function(t){t.srcElement.style.opacity=i.style.target.opacity+.1},onmouseout:function(t){t.srcElement.style.opacity=i.style.target.opacity}}),n.push(i.h("div",{style:{position:"absolute",left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),height:"".concat(g.height,"px"),width:"".concat(g.width,"px")}},[zl(w)]))}var k=c<h?a:o,M=c<h?o:a,_=H(l?i.scale.domain():[Math.min(a,o),Math.max(a,o)],2),S=_[0],C=_[1],R=k+1e-5>=S&&k-1e-5<=C,q=M-1e-5<=C&&M+1e-5>=S;R&&n.push(jl({h:i.h,isVertical:r,borderHit:e,value:k,pos:d,align:"start",state:i,idx:s})),q&&n.push(jl({h:i.h,isVertical:r,borderHit:e,value:M,pos:p,align:"end",state:i,idx:s}));var N=i.settings.bubbles;if(N&&N.show){var A={fontSize:N.fontSize,fontFamily:N.fontFamily,color:N.fill},D=[a,o];R&&n.push(Pl({h:i.h,isVertical:r,align:N.align,style:A,rangeIdx:s,idx:0,otherValue:M,value:k,label:"".concat(i.format(k,D)),pos:d,state:i})),q&&n.push(Pl({h:i.h,isVertical:r,align:N.align,style:A,rangeIdx:s,idx:1,otherValue:k,value:M,label:"".concat(i.format(M,D)),pos:p,state:i}))}}function Ll(t){var e=t.active.limitHigh-t.active.end,n=t.active.limitLow-t.active.start,r=t.current-t.start;return r=r<0?Math.max(r,n):Math.min(r,e)}function Bl(t){var e=[],n=0===t.direction;if(Array.isArray(t.ranges)&&t.ranges.forEach((function(r,i){t.active&&i===t.active.idx||Fl({borderHit:5,els:e,isVertical:n,state:t,vStart:Math.min(r.min,r.max),vEnd:Math.max(r.min,r.max),idx:i})})),t.active){var r=t.start,i=t.current;if(-1!==t.active.idx)if("foo"===t.active.mode)r=Math.min(t.active.start,t.active.end),i=Math.max(t.active.start,t.active.end);else if("modify"===t.active.mode)r=Math.min(t.start,t.current),i=Math.max(t.start,t.current);else{var a=Ll(t);r=t.active.start+a,i=t.active.end+a}Fl({borderHit:5,els:e,isVertical:n,state:t,vStart:r,vEnd:i,idx:t.active.idx})}return e}function Hl(t){return{min:t.scale.min(),max:t.scale.max()}}function $l(t){return{min:0,max:t.direction?t.rect.width:t.rect.height}}function Wl(t,e,n){var r,i,a=t.ranges,o=-1;for(r=0;r<a.length;r++){if(a[r].min<=e&&e<=a[r].max){o=r,n.min=r?a[r-1].max:n.min,n.max=r+1<a.length?a[r+1].min:n.max;break}if(e<a[r].min){n.max=a[r].min,n.min=r?a[r-1].max:n.min;break}}-1===o&&a.length&&r>=a.length&&(n.min=a[a.length-1].max),-1!==o&&(i={idx:o,start:a[o].min,end:a[o].max,limitLow:n.min,limitHigh:n.max,mode:"foo"}),t.active=i}function Vl(t){t.renderer.render(Bl(t))}function Ul(t,e){if(!e||!e.isActive())return[];var n=t.scale.data(),r=(n&&n.fields||[]).map((function(t){return t.id()})),i=e.brushes().filter((function(t){return"range"===t.type&&-1!==r.indexOf(t.id)}))[0];return i?i.brush.ranges():[]}function Yl(t,e){for(var n,r=1/0,i=e.domain(),a=e.bandwidth()/2,o=0;o<i.length;++o){var s=Math.abs(t-a-e(i[o]));s<r&&(r=s,n=i[o])}return n}function Xl(t,e){return Math.min.apply(Math,$(t))<=Math.max.apply(Math,$(e))&&Math.max.apply(Math,$(t))>=Math.min.apply(Math,$(e))}function Kl(t){return Q(t.reduce((function(t,e){return t.push.apply(t,$(J(e.bounds))),t}),[]))}var Gl={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{rangeStart:function(t){this.start(t)},rangeMove:function(t){this.move(t)},rangeEnd:function(t){this.end(t)},rangeClear:function(t){this.clear(t)},bubbleStart:function(t){this.bubbleStart(t)}},created:function(){this.state={key:this.settings.key||"brush-range"}},beforeRender:function(t){this.state.rect=t.size.computedInner},renderRanges:function(){this.state.started||(this.state.ranges=Ul(this.state,this.state.brushInstance),this.state.active=null,Vl(this.state))},render:function(t){var e=this,n=this.settings.settings;this.state.direction="vertical"===n.direction?0:1;var r=this.renderer.element().getBoundingClientRect(),i=this.state.rect[0===this.state.direction?"height":"width"],a=Io(this.chart.scale(n.scale),i),o=function(t){var e={targetRect:null,targetFillRect:null,scale:null,size:null},n=t.settings.settings,r=n.target&&(n.target.components||(n.target.component?[n.target.component]:[])).map((function(e){return t.chart.component(e)})).filter((function(t){return!!t&&!!t.rect})),i=n.target&&n.target.selector?t.chart.findShapes(n.target.selector):[],a=n.target&&n.target.fillSelector?t.chart.findShapes(n.target.fillSelector):[];if(i.length>0){var o=Kl(i);if(e.size=o[0===t.state.direction?"height":"width"],e.scale=Io(t.chart.scale(n.scale),e.size),e.targetRect=o,a.length>0){var s=Kl(a);e.targetFillRect=s}}else if(r&&r.length>0){var u=r.slice(1).reduce((function(t,e){return{x0:Math.min(t.x0,e.rect.computedInner.x),y0:Math.min(t.y0,e.rect.computedInner.y),x1:Math.max(t.x1,e.rect.computedInner.x+e.rect.computedInner.width),y1:Math.max(t.y1,e.rect.computedInner.y+e.rect.computedInner.height)}}),{x0:r[0].rect.computedInner.x,y0:r[0].rect.computedInner.y,x1:r[0].rect.computedInner.x+r[0].rect.computedInner.width,y1:r[0].rect.computedInner.y+r[0].rect.computedInner.height});e.targetRect={x:u.x0-t.state.rect.x,y:u.y0-t.state.rect.y,width:u.x1-u.x0,height:u.y1-u.y0}}return e}(this);if(a=o.scale?o.scale:a,this.state.targetRect=o.targetRect,this.state.targetFillRect=o.targetFillRect,this.state.size=null===o.size?i:o.size,this.state.settings=n,this.state.style=this.style,this.state.offset=r,this.state.brush="object"===R(n.brush)?n.brush.context:n.brush,this.state.brushInstance=this.chart.brush(this.state.brush),this.state.renderer=this.renderer,this.state.multi=!!n.multiple,this.state.h=t,this.state.onEditConfirmed=function(t,n,r){e.state.edit=null,function(t,e,n,r){var i=t.ranges.map((function(t){return{min:t.min,max:t.max}})),a=t.scale.min(),o=t.scale.max();i[e]={min:Math.max(a,Math.min(n,r)),max:Math.min(o,Math.max(n,r))},t.ranges[e]=C({},i[e]);var s=t.scale.data();s&&s.fields&&s.fields.forEach((function(e){t.fauxBrushInstance||t.brushInstance.setRange(e.id(),i)}))}(e.state,t,n,r),e.emit("bubbleEnd"),Vl(e.state)},this.state.onEditCanceled=function(){e.state.edit=null,Vl(e.state)},this.state.cssCoord={offset:0===this.state.direction?"top":"left",coord:0===this.state.direction?"y":"x",pos:0===this.state.direction?"deltaY":"deltaX"},this.state.format="function"==typeof n.bubbles.label&&function(t,r){return n.bubbles.label.call(void 0,{datum:t,data:r,scale:a,resources:{scale:e.chart.scale,formatter:e.chart.formatter}})},{}.hasOwnProperty.call(a,"norm")){this.state.editable=!0,this.state.observeBrush="object"===R(n.brush)&&n.brush.observe,this.state.fauxBrushInstance=null,this.state.findValues=null,this.state.scale=a;var s=this.state.scale.data();!this.state.format&&s&&s.fields&&s.fields[0]&&(this.state.format=s.fields[0].formatter())}else this.state.editable=!1,this.state.scale=Ra(),this.state.scale.data=a.data,this.state.format||(this.state.format=function(t,e){return Xl(a.range(),e)?function(t,e){var n=e.ticks(),r=e.domain().indexOf(Yl(t,e));return-1!==r?n[r].label:"-"}(t,a):"-"}),this.state.fauxBrushInstance=Mo(),this.state.findValues=function(t){return function(t,e){var n=e.domain(),r=e.range(),i=[];return t.forEach((function(t){if(Xl(r,[t.min,t.max])){var a=n.indexOf(Yl(t.min,e)),o=n.indexOf(Yl(t.max,e));i.push.apply(i,n.slice(Math.min(a,o),Math.max(a,o)+1))}})),i}(t,a)};return this.state.ranges=Ul(this.state,this.state.brushInstance),this.state.observeBrush||this.state.sourcedFromThisComponent?[Bl(this.state)]:[]},mounted:function(){this.state.observeBrush&&this.state.brushInstance&&this.state.brushInstance.on("update",this.renderRanges)},beforeDestroy:function(){this.state.observeBrush&&this.state.brushInstance&&this.state.brushInstance.removeListener("update",this.renderRanges)},start:function(t){!function(t){var e=t.state,n=t.e,r=t.renderer,i=t.ranges,a=t.targetSize;if(!e.started){e.edit=null;var o=n.center.x-n.deltaX,s=n.center.y-n.deltaY,u=document.elementFromPoint(o,s);r.element().contains(u)||(u=null);var l={started:!0};e.offset=M({},r.element().getBoundingClientRect());var c=o-e.offset.left,h=s-e.offset.top;e.offset.left+=e.targetRect?e.targetRect.x:0,e.offset.top+=e.targetRect?e.targetRect.y:0,e.ranges=i(e,e.fauxBrushInstance||e.brushInstance);var f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset];l.current=e.scale.normInvert(d/e.size),l.start=e.scale.normInvert(f/e.size);var p,g,v=e.ranges,y=Hl(e),m=-1;if(u&&u.hasAttribute("data-idx"))m=parseInt(u.getAttribute("data-idx"),10),y.min=m>0?v[m-1].max:y.min,y.max=m+1<v.length?v[m+1].min:y.max;else{for(p=0;p<v.length;p++){if(v[p].min<=l.start&&l.start<=v[p].max){m=p,y.min=p?v[p-1].max:y.min,y.max=p+1<v.length?v[p+1].min:y.max;break}if(l.start<v[p].min){y.max=v[p].min,y.min=p?v[p-1].max:y.min;break}}-1===m&&v.length&&p>=v.length&&(y.min=v[v.length-1].max)}if(-1!==m||e.multi||(l.ranges=[],y.min=e.scale.min(),y.max=e.scale.max()),-1!==m)if(g={idx:m,start:v[m].min,end:v[m].max,limitLow:y.min,limitHigh:y.max,mode:"move"},u&&u.hasAttribute("data-other-value"))l.start=parseFloat(u.getAttribute("data-other-value")),g.mode="modify";else{var x=e.scale.norm(g.start)*e.size,b=e.scale.norm(g.end)*e.size;Math.abs(f-x)<=a?(l.start=g.end,g.mode="modify"):Math.abs(f-b)<=a&&(l.start=g.start,g.mode="modify")}else g={idx:-1,start:l.start,end:l.current,limitLow:y.min,limitHigh:y.max,mode:"current"};l.active=g,"modify"!==g.mode&&e.targetRect&&!Is(e.targetRect,{x:c,y:h})||Object.keys(l).forEach((function(t){return e[t]=l[t]}))}}({e:t,state:this.state,renderer:this.renderer,ranges:Ul,targetSize:5})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t,t.fauxBrushInstance||t.brushInstance);var n=Hl(t);Wl(t,t.current,n)}(this.state,Ul),Vl(this.state),this.state.sourcedFromThisComponent=!0,this.state.active=null)},move:function(t){this.state.started&&(!function(t,e){var n=(e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset])/t.size,r=t.scale.normInvert(n);t.current=Math.max(Math.min(r,t.active.limitHigh),t.active.limitLow)}(this.state,t),function(t){var e=t.ranges.map((function(t){return{min:t.min,max:t.max}}));if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=Ll(t);e[t.active.idx].min+=n,e[t.active.idx].max+=n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});var r=t.scale.data();r&&r.fields&&r.fields.forEach((function(n){if(t.fauxBrushInstance){var r=Ul(t,t.fauxBrushInstance),i=t.findValues(r),a=t.findValues(e),o=a.filter((function(t){return-1===i.indexOf(t)})),s=i.filter((function(t){return-1===a.indexOf(t)})),u=o.map((function(t){return{key:n.id(),value:t}})),l=s.map((function(t){return{key:n.id(),value:t}}));t.brushInstance.addAndRemoveValues(u,l),t.fauxBrushInstance.setRange(n.id(),e)}else t.brushInstance.setRange(n.id(),e)}))}(this.state),Vl(this.state))},clear:function(){this.state.fauxBrushInstance&&this.state.fauxBrushInstance.clear(),this.state.renderer.render([]),this.state.started=!1,this.state.active=null,this.state.sourcedFromThisComponent=!1},bubbleStart:function(t){if(this.state.editable){var e=t.srcEvent||t,n=e.target,r={rangeIdx:parseInt(n.getAttribute("data-idx"),10),bubbleIdx:parseInt(n.getAttribute("data-bidx"),10)};if(!isNaN(r.rangeIdx)&&JSON.stringify(r)!==JSON.stringify(this.state.edit)){this.state.edit=r,e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();var i=n.parentNode;Vl(this.state);var a=i.querySelector("input");a.focus(),a.select()}}}};function Zl(t){t.renderer.render(Bl(t))}function Jl(t){return t.rc.ranges()}var Ql={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaClear:function(t){this.clear(t)}},created:function(){this.state={key:this.settings.key||"brush-area-dir"}},render:function(t){var e=this;this.state.rect=this.rect;var n=this.settings.settings,r="vertical"===n.direction?0:1,i=this.state.rect[0===r?"height":"width"],a=this.renderer.element().getBoundingClientRect(),o=(n.target?n.target.components||[n.target.component]:[]).map((function(t){return e.chart.component(t)})).filter((function(t){return!!t&&!!t.rect})),s=o[0]?o.slice(1).reduce((function(t,e){return{x0:Math.min(t.x0,e.rect.x),y0:Math.min(t.y0,e.rect.y),x1:Math.max(t.x1,e.rect.x+e.rect.width),y1:Math.max(t.y1,e.rect.y+e.rect.height)}}),{x0:o[0].rect.x,y0:o[0].rect.y,x1:o[0].rect.x+o[0].rect.width,y1:o[0].rect.y+o[0].rect.height}):null;return this.state.targetRect=s?{x:s.x0-this.rect.x,y:s.y0-this.rect.y,width:s.x1-s.x0,height:s.y1-s.y0}:null,this.state.style=this.style,this.state.chart=this.chart,this.state.direction=r,this.state.settings=n,this.state.offset=a,this.state.rc=uo(),this.state.renderer=this.renderer,this.state.multi=!!n.multiple,this.state.h=t,this.state.size=i,this.state.cssCoord={offset:0===this.state.direction?"top":"left",coord:0===this.state.direction?"y":"x",pos:0===this.state.direction?"deltaY":"deltaX",area:0===this.state.direction?"height":"width"},this.state.format=function(t,e){return function(t,e,n){var r=Math.min.apply(Math,$(n)),i=Math.max.apply(Math,$(n)),a={x:t.direction?r+t.rect.x:t.rect.x,y:t.direction?t.rect.y:r+t.rect.y,width:t.direction?i-r:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:i-r},o=t.chart.shapesAt(a,t.settings.brush);if(0===o.length)return"-";var s=o.reduce((function(n,i){var a=n.bounds,o=i.bounds;return e===r?a[t.cssCoord.coord]<=o[t.cssCoord.coord]?n:i:a[t.cssCoord.coord]+a[t.cssCoord.area]>=o[t.cssCoord.coord]+o[t.cssCoord.area]?n:i})),u=t.settings.brush.components.reduce((function(t,e){return t.key===s.key?t:e}));return"function"==typeof t.settings.bubbles.label?t.settings.bubbles.label(s.data):Array.isArray(u.data)&&u.data.length?s.data[u.data[0]].label:s.data&&s.data.label?s.data.label:"-"}(this,t,e)},[]},start:function(t){!function(t){var e=t.state,n=t.e,r=t.renderer,i=t.ranges,a=t.targetSize;if(!e.started){var o=n.center.x-n.deltaX,s=n.center.y-n.deltaY,u=document.elementFromPoint(o,s);r.element().contains(u)||(u=null);var l={started:!0};e.offset=r.element().getBoundingClientRect(),e.ranges=i(e);var c=o-e.offset.left,h=s-e.offset.top,f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset],p=d,g=f;l.start=f,l.current=d;var v,y,m=e.ranges,x=$l(e),b=-1;if(u&&u.hasAttribute("data-idx"))b=parseInt(u.getAttribute("data-idx"),10),x.min=b>0?m[b-1].max:x.min,x.max=b+1<m.length?m[b+1].min:x.max;else{for(v=0;v<m.length;v++){if(m[v].min<=g&&g<=m[v].max){b=v,x.min=v?m[v-1].max:x.min,x.max=v+1<m.length?m[v+1].min:x.max;break}if(g<m[v].min){x.max=m[v].min,x.min=v?m[v-1].max:x.min;break}}-1===b&&m.length&&v>=m.length&&(x.min=m[m.length-1].max)}if(-1!==b||e.multi||(l.ranges=[],x.min=0,x.max=e.direction?e.rect.width:e.rect.height),-1!==b)if(y={idx:b,start:m[b].min,end:m[b].max,limitLow:x.min,limitHigh:x.max,mode:"move"},u&&u.hasAttribute("data-other-value"))l.start=parseFloat(u.getAttribute("data-other-value")),y.mode="modify";else{var w=y.start,k=y.end;Math.abs(f-w)<=a?(l.start=y.end,y.mode="modify"):Math.abs(f-k)<=a&&(l.start=y.start,y.mode="modify")}else y={idx:-1,start:g,end:p,limitLow:x.min,limitHigh:x.max,mode:"current"};l.active=y,"modify"!==y.mode&&e.targetRect&&!Is(e.targetRect,{x:c,y:h})||Object.keys(l).forEach((function(t){return e[t]=l[t]}))}}({e:t,state:this.state,renderer:this.renderer,ranges:Jl,targetSize:5})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t);var n=$l(t);Wl(t,t.current,n)}(this.state,Jl),Zl(this.state))},move:function(t){this.state.started&&(!function(t,e){var n=e.center[t.cssCoord.coord]-t.offset[t.cssCoord.offset];t.current=Math.max(Math.min(n,t.active.limitHigh),t.active.limitLow)}(this.state,t),function(t){var e=t.ranges.map((function(t){return{min:t.min,max:t.max}}));if(-1!==t.active.idx)if("modify"===t.active.mode)e[t.active.idx].min=Math.min(t.start,t.current),e[t.active.idx].max=Math.max(t.start,t.current);else{var n=Ll(t);e[t.active.idx].min=t.active.start+n,e[t.active.idx].max=t.active.end+n}else e.push({min:Math.min(t.start,t.current),max:Math.max(t.start,t.current)});t.rc.set(e);var r=[];e.forEach((function(e){r=[].concat($(r),$(function(t,e){var n={x:t.direction?e.min+t.rect.x:t.rect.x,y:t.direction?t.rect.y:e.min+t.rect.y,width:t.direction?e.max-e.min:t.rect.width+t.rect.x,height:t.direction?t.rect.height+t.rect.y:e.max-e.min};return t.chart.shapesAt(n,t.settings.brush)}(t,e)))})),function(t,e){t.chart.brushFromShapes(e,t.settings.brush)}(t,r)}(this.state),Zl(this.state))},clear:function(){this.state.rc&&this.state.rc.clear(),this.state.renderer.render([])}};function tc(t){var e="vertical"===t.direction,n=t.rect[e?"height":"width"],r=t.rect[e?"width":"height"];return function(t){var e=t.brush;if(!e||!e.isActive())return[];var n=t.scale.data(),r=(n&&n.fields||[]).map((function(t){return t.id()})),i=e.brushes().filter((function(t){return"range"===t.type&&-1!==r.indexOf(t.id)}))[0];return i?i.brush.ranges():[]}(t).map((function(i){var a=t.scale(i.min)*n,o=t.scale(i.max)*n,s=Math.min(a,o),u=Math.abs(a-o);return{type:"rect",fill:t.fill,opacity:t.opacity,x:e?0:s,width:e?r:u,y:e?s:0,height:e?u:r}}))}function ec(t,e,n,r){function i(){!function(t){t.renderer.render(tc(t))}(t)}function a(){!function(t){t.renderer.render(tc(t))}(t)}function o(){!function(t){t.renderer.render(tc(t))}(t)}t.brush=e,e&&(e.on("start",i),e.on("update",a),e.on("end",o),t.start=i,t.update=a,t.end=o,t.brush=e,t.scale=n,t.renderer=r)}function nc(t){t.brush&&(t.brush.removeListener("start",t.start),t.brush.removeListener("update",t.update),t.brush.removeListener("end",t.end)),t.start=void 0,t.update=void 0,t.end=void 0,t.brush=void 0,t.scale=void 0,t.renderer=void 0}var rc={require:["chart","settings","renderer"],defaultSettings:{settings:{}},preferredSize:function(){return 50},created:function(){this.state={}},render:function(){var t=this.settings.settings,e=this.chart.brush(t.brush),n=t.direction||"horizontal",r="horizontal"===n?this.rect.width:this.rect.height,i=Io(this.chart.scale(t.scale),r);return nc(this.state),ec(this.state,e,i,this.renderer),this.state.rect=this.rect,this.state.fill=t.fill||"#ccc",this.state.opacity=void 0!==t.opacity?t.opacity:1,this.state.direction=n,tc(this.state)},beforeDestroy:function(){nc(this.state)}};function ic(t,e){var n=e.center.x,r=e.center.y;return{x:n-t.left,y:r-t.top}}function ac(t,e,n){return ns(t,e.points[0])<Math.pow(n.settings.snapIndicator.threshold,2)}function oc(t,e){null==t.path.d?t.path.d="M".concat(e.x," ").concat(e.y," "):t.path.d+="L".concat(e.x," ").concat(e.y," "),t.points.push(e)}function sc(t){var e=t.state,n=t.start,r=void 0===n?null:n,i=t.end,a=void 0===i?null:i;null!==r&&(e.snapIndicator.x1=r.x,e.snapIndicator.y1=r.y),null!==a&&(e.snapIndicator.x2=a.x,e.snapIndicator.y2=a.y)}function uc(t,e){t.snapIndicator.visible=e}var lc={require:["chart","renderer","settings"],defaultSettings:{layout:{displayOrder:0},settings:{brush:{components:[]},snapIndicator:{threshold:75,strokeDasharray:"5, 5",stroke:"black",strokeWidth:2,opacity:.5},lasso:{fill:"transparent",stroke:"black",strokeWidth:2,opacity:.7,strokeDasharray:"20, 10"},startPoint:{r:10,fill:"green",stroke:"black",strokeWidth:1,opacity:1}}},on:{lassoStart:function(t){this.start(t)},lassoEnd:function(t){this.end(t)},lassoMove:function(t){this.move(t)},lassoCancel:function(){this.cancel()}},created:function(){this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}}},start:function(t){var e,n,r,i;this.state.active=!0,this.state.path={visible:!0,type:"path",d:null,fill:(e=this.settings.settings.lasso).fill,stroke:e.stroke,strokeWidth:e.strokeWidth,opacity:e.opacity,strokeDasharray:e.strokeDasharray,collider:{type:null}},this.state.snapIndicator=function(t){return{visible:!1,type:"line",x1:0,y1:0,x2:0,y2:0,strokeDasharray:t.strokeDasharray,stroke:t.stroke,strokeWidth:t.strokeWidth,opacity:t.opacity,collider:{type:null}}}(this.settings.settings.snapIndicator),this.state.startPoint=function(t){return{visible:!0,type:"circle",cx:0,cy:0,r:t.r,fill:t.fill,opacity:t.opacity,stroke:t.stroke,strokeWidth:t.strokeWidth,collider:{type:null}}}(this.settings.settings.startPoint),this.state.rendererBounds=this.renderer.element().getBoundingClientRect(),this.state.componentDelta=(n=this.chart,r=this.state.rendererBounds,i=n.element.getBoundingClientRect(),{x:r.left-i.left,y:r.top-i.top}),this.state.brushConfig=function(t){return t.settings.brush.components.map((function(t){return{key:t.key,contexts:t.contexts||["lassoBrush"],data:t.data||[""],action:t.action||"add"}}))}(this.settings);var a=ic(this.state.rendererBounds,t);oc(this.state,a),sc({state:this.state,start:a}),function(t,e){t.startPoint.cx=e.x,t.startPoint.cy=e.y}(this.state,a)},move:function(t){if(this.state.active){var e=ic(this.state.rendererBounds,t);ac(e,this.state,this.settings)?uc(this.state,!0):uc(this.state,!1),oc(this.state,e),sc({state:this.state,end:e}),function(t,e){var n=[t.startPoint,t.path,t.snapIndicator].filter((function(t){return t.visible}));e.render(n)}(this.state,this.renderer),function(t,e){if(t.active){var n=t.points[t.points.length-2],r=t.points[t.points.length-1];t.lineBrushShape.x1=n.x+t.componentDelta.x,t.lineBrushShape.y1=n.y+t.componentDelta.y,t.lineBrushShape.x2=r.x+t.componentDelta.x,t.lineBrushShape.y2=r.y+t.componentDelta.y;var i=e.shapesAt(t.lineBrushShape,{components:t.brushConfig});e.brushFromShapes(i,{components:t.brushConfig})}}(this.state,this.chart)}},end:function(t){this.state.active&&(uc(this.state,!1),ac(ic(this.state.rendererBounds,t),this.state,this.settings)&&function(t,e){if(t.active){var n=t.componentDelta.x,r=t.componentDelta.y,i=t.points.map((function(t){return{x:t.x+n,y:t.y+r}})),a=e.shapesAt({vertices:i},{components:t.brushConfig});e.brushFromShapes(a,{components:t.brushConfig})}}(this.state,this.chart),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach((function(t){t.contexts.forEach((function(t){e.brush(t).end()}))})),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},render:function(){}};function cc(t,e,n,r,i){for(var a,o=0,s=e.length-1;o<s;){var u=Math.floor((o+s)/2);(a=i(e[u]))[n]+a[r]<t[n]?o=u+1:s=u}return o}function hc(t){var e=t.orientation,n=t.targetNodes,r=t.labels,i=t.container,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cc,o=[],s="v"===e?"x":"y",u="v"===e?"width":"height",l=function(t){return t.textBounds},c=function(t){return t.node.localBounds};return function(t,e){var h=r[e],f=h.textBounds,d=h.node;if(f[s]<i[s]||f[s]+f[u]>i[s]+i[u])return!1;for(var p=a(f,o,s,u,l);p<o.length;p++)if(Os(f,o[p].textBounds))return!1;for(var g=a(f,n,s,u,c),v=f[s]+f[u],y=g;y<n.length;y++){var m=n[y].node;if(v<m.localBounds[s])break;if(Os(f,m.localBounds)&&d!==m)return!1}return o.push(r[e]),!0}}function fc(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function dc(t){var e=R(t);return("string"===e||"number"===e)&&""!==t}function pc(t){return C(C({type:"rect",rx:2,ry:2,fill:t.backgroundColor},t.backgroundBounds),{},{data:t.data,rotation:t.transform&&t.transform.match(/rotate/gi)?"rotated":"horizontal"})}function gc(t,e,n){return n?t.width>=e.height:t.width>=e.width}function vc(t,e,n){return n?t.height>=e.width:t.height>=e.height}function yc(t,e,n,r,i){var a,o;return"v"===t?(a=r||i||gc(e,n,!0),o=vc(e,n,!r)):(a=gc(e,n),o=i||vc(e,n,!1)),a&&o}function mc(t,e,n,r){return t+.5*e+(r-.5)*(e-n)-.5*n}function xc(t,e,n){var r={type:"text",text:e,maxWidth:n.rotate?t.height:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:n.rotate?"end":"start",baseline:"central",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},i=n.textMetrics;if(!n.overflow&&!function(t,e,n){return gc(t,e,n.rotate)&&vc(t,e,n.rotate)}(t,i,n))return!1;var a=.5*i.height;return n.rotate?(r.x=mc(t.x,t.width,i.height,n.align)+a,r.y=mc(t.y,t.height,i.width,n.justify),r.transform="rotate(-90, ".concat(r.x+r.dx,", ").concat(r.y+r.dy,")")):(r.x=mc(t.x,t.width,i.width,n.align),r.y=mc(t.y,t.height,i.height,n.justify)+a),r}function bc(t){var e=t.bar,n=t.view,r=t.direction,i=t.position,a=t.padding,o=void 0===a?4:a,s={};if(M(s,e),i&&"inside"!==i)if("up"===r||"down"===r){var u=Math.max(0,Math.min(e.y,n.height)),l=Math.max(0,Math.min(e.y+e.height,n.height));"outside"===i&&"up"===r||"opposite"===i&&"down"===r?(s.y=0,s.height=u):("outside"===i&&"down"===r||"opposite"===i&&"up"===r)&&(s.y=l,s.height=n.height-l)}else{var c=Math.max(0,Math.min(e.x,n.width)),h=Math.max(0,Math.min(e.x+e.width,n.width));"outside"===i&&"left"===r||"opposite"===i&&"right"===r?(s.x=0,s.width=c):("outside"===i&&"right"===r||"opposite"===i&&"left"===r)&&(s.x=h,s.width=n.width-h)}else;return function(t,e){var n=Math.max(0,Math.min(t.y,e.height)),r=Math.max(0,Math.min(t.y+t.height,e.height)),i=Math.max(0,Math.min(t.x,e.width)),a=Math.max(0,Math.min(t.x+t.width,e.width));t.x=i,t.width=a-i,t.y=n,t.height=r-n}(s,n),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.top,r=void 0===n?4:n,i=e.bottom,a=void 0===i?4:i,o=e.left,s=void 0===o?4:o,u=e.right,l=void 0===u?4:u;t.x+=s,t.width-=s+l,t.y+=r,t.height-=r+a}(s,o),s}function wc(t){var e,n,r,i,a,o=t.direction,s=t.fitsHorizontally,u=t.measured,l=t.node,c=t.orientation,h=t.placementSettings,f=t.rect,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bc,p=[],g="h"===c?"width":"height";for(a=0;a<h.length;a++)if(r=h[a],i=d({bar:l.localBounds,view:f,direction:o,position:r.position,padding:r.padding}),p.push(i),e=!a||i[g]>e[g]?i:e,yc(c,i,u,s,r.overflow)){n=i;break}return n||(n=e,a=p.indexOf(n)),{bounds:n,placement:r=h[a]}}function kc(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.top,o=void 0===a?4:a,s=i.bottom,u=void 0===s?4:s,l=i.left,c=void 0===l?4:l,h=i.right,f=void 0===h?4:h,d=t.x+t.dx,p=t.y+t.dy,g=n?Math.min(e.width,r.height):Math.min(e.height,r.width),v=n?Math.min(e.height,r.height):Math.min(e.width,r.width),y=.5*e.height,m=1e-9,x=n?d-y:d,b=n?p:p-y,w={x:x-c-m,y:b-o-m,width:v+(c+f)-m,height:g+(o+u)-m};return w}function Mc(t){for(var e,n,r,i,a,o,s,u,l,c,h,f,d,p=t.chart,g=t.targetNodes,v=t.rect,y=t.fitsHorizontally,m=t.collectiveOrientation,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wc,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xc,w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:hc,k=[],M={container:v,targetNodes:g,labels:[],orientation:m},_=0,S=g.length;_<S;_++){o=null,f=fc(r=(n=g[_]).node,p),d="left"===(l=n.direction)||"right"===l?"h":"v";for(var q=0;q<n.texts.length;q++)if(dc(i=n.texts[q])){var N=x({direction:l,fitsHorizontally:y,lblStngs:c=n.labelSettings[q],measured:u=n.measurements[q],node:r,orientation:d,placements:c.placements,placementSettings:n.placementSettings[q],rect:v});if(o=N.bounds,h=N.placement,o&&h){a=h.justify;var A="function"==typeof c.linkData?c.linkData(f,_):void 0,D="function"==typeof h.overflow?h.overflow(f,_):h.overflow;"up"===l&&(a=1-a),"opposite"===h.position&&(a=1-a),"left"===l&&(a=1-a);var O=!("h"===m||y);if(e=b(o,i,{justify:"h"===d?h.align:a,align:"h"===d?a:h.align,fontSize:c.fontSize,fontFamily:c.fontFamily,textMetrics:u,rotate:O,overflow:!!D})){var E=kc(e,u,O,o,h.padding);s="function"==typeof h.fill?h.fill(C(C({},f),{},{textBounds:E}),_):h.fill,e.fill=s,void 0!==A&&(e.data=A),"object"===R(h.background)&&(e.backgroundColor="function"==typeof h.background.fill?h.background.fill(C(C({},f),{},{textBounds:E}),_):h.background.fill,void 0!==e.backgroundColor&&(e.backgroundBounds=kc(e,u,O,o,h.background.padding))),k.push(e),M.labels.push({node:r,textBounds:E})}}}}var I=k.filter(w(M)),T=I.filter((function(t){return void 0!==t.backgroundBounds})).map(pc);return[].concat($(T),$(I))}function _c(t){for(var e,n,r,i,a,o,s,u=t.nodes,l=t.rect,c=t.chart,h=t.labelSettings,f=t.placementSettings,d=t.settings,p=t.renderer,g={},v=[],y=!0,m=!1,x=0;x<u.length;x++)if(Os(i=(n=u[x]).localBounds,l)){var b=fc(n,c);e={node:n,texts:[],measurements:[],labelSettings:[],placementSettings:[]};for(var w=0;w<h.length;w++)dc(r="function"==typeof(o=h[w]).label?o.label(b,x):void 0)&&(s="function"==typeof d.direction?d.direction(b,x):d.direction||"up",m=m||"left"===s||"right"===s,g.fontFamily=o.fontFamily,g.fontSize="".concat(o.fontSize,"px"),g.text=r,a=p.measureText(g),e.measurements.push(a),e.texts.push(r),e.labelSettings.push(o),e.placementSettings.push(f[w]),e.direction=s,y=y&&a.width<=i.width-8);v.push(e)}return{targetNodes:v,fitsHorizontally:y,hasHorizontalDirection:m}}function Sc(t){var e=t.orientation,n=void 0===e?"auto":e,r=t.defaultOrientation,i=void 0===r?"h":r;switch(n.toLocaleLowerCase()){case"vertical":return"v";case"horizontal":return"h";default:return i}}function Cc(t){var e=2*Math.PI;return(t%e+e)%e}function Rc(t,e){t.x+=e,t.width-=2*e,t.y+=e,t.height-=2*e}function qc(t){return{x:t.x,y:t.y-t.height/2,width:t.width,height:t.height}}function Nc(t,e,n){var r=e.x,i=e.y;if(r*r+i*i>t*t)return null;var a=Math.sin(n),o=Math.cos(n),s=r*o-i*a,u=t*t-s*s;if(u<0)return null;var l=Math.sqrt(u);return{x:s*o+a*l,y:-s*a+o*l}}function Ac(t){var e,n,r=t.radius,i=t.size,a=t.angle,o=i.width,s=i.height,u={x:o/2,y:s/2};switch(Math.floor(a/(Math.PI/2))){case 0:if(!(e=Nc(r,u,a)))return null;e.y*=-1,n={x:-o,y:0};break;case 1:if(!(e=Nc(r,u,Math.PI-a)))return null;n={x:-o,y:-s};break;case 2:if(!(e=Nc(r,u,a-Math.PI)))return null;e.x*=-1,n={x:0,y:-s};break;case 3:if(!(e=Nc(r,u,2*Math.PI-a)))return null;e.x*=-1,e.y*=-1,n={x:0,y:0};break;default:throw new Error("invalid angle")}return{x:e.x+n.x,y:e.y+n.y,width:o,height:s}}function Dc(t){var e=t.slice,n=t.measured,r=t.padding,i=e.start,a=e.end,o=e.innerRadius,s=e.outerRadius,u=s-o-2*r,l=a-i;if(l<Math.PI){var c=(n.height/2+r)/Math.tan(l/2);c>o&&(u=s-c-2*r)}if(u<0||u<n.minReqWidth)return null;var h=Cc((i+a)/2),f=s-r,d={x:Math.sin(h)*f,y:-Math.cos(h)*f,width:u,height:n.height};return h<Math.PI?(d.angle=h-Math.PI/2,d.anchor="end"):(d.angle=h+Math.PI/2,d.anchor="start"),d}function Oc(t){var e=t.context,n=t.node,r=t.bounds,i=n.desc.slice,a=Cc((i.start+i.end)/2);switch(Math.floor(a/(Math.PI/2))){case 0:e.q1maxY=r.y-2,void 0===e.q2minY&&(e.q2minY=r.y+r.height+2);break;case 1:e.q2minY=r.y+r.height+2;break;case 2:e.q3minY=r.y+r.height+2;break;case 3:e.q4maxY=r.y-2,void 0===e.q3minY&&(e.q3minY=r.y+r.height+2)}}function Ec(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function Ic(t,e,n){var r={type:"text",text:e,maxWidth:t.width,x:t.x,y:t.y+("top"===t.baseline?t.height/2:0),fill:n.fill,anchor:t.anchor||"start",baseline:"middle",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily};if(!isNaN(t.angle)){var i=t.angle*(360/(2*Math.PI));r.transform="rotate(".concat(i,", ").concat(r.x,", ").concat(r.y,")")}return r}function Tc(t){var e,n,r=t.slice,i=t.direction,a=t.position,o=t.padding,s=t.measured,u=t.view,l=t.context,c=t.store,h=r.start,f=r.end,d=r.innerRadius,p=r.offset;switch(a){case"into":e="rotate"===i?Dc({slice:r,measured:s,padding:o}):function(t){var e=t.slice,n=t.padding,r=t.measured,i=e.start,a=e.end,o=e.innerRadius,s=e.outerRadius,u=Cc((i+a)/2),l=Ac({radius:s,size:{width:r.width+2*n+1,height:r.height+2*n},angle:u});return l?(l.baseline="top",Ts(l,{x1:0,y1:0,x2:Math.sin(i)*s,y2:-Math.cos(i)*s})||Ts(l,{x1:0,y1:0,x2:Math.sin(a)*s,y2:-Math.cos(a)*s})||Cs({cx:0,cy:0,r:o},l)?null:(Rc(l,n),l)):null}({slice:r,measured:s,padding:o});break;case"inside":n={start:h,end:f,innerRadius:0,outerRadius:d},e="rotate"===i?Dc({slice:n,measured:s,padding:o}):function(t){var e=t.slice,n=t.padding,r=t.measured,i=t.store,a=e.start,o=e.end,s=e.outerRadius,u=Cc((a+o)/2),l=Ac({radius:s,size:{width:r.width+2*n+1,height:r.height+2*n},angle:u});return l?(l.baseline="top",Rc(l,n),i.insideLabelBounds.some((function(t){return Os(t,l)}))?null:(i.insideLabelBounds.push({x:l.x-4,y:l.y,width:l.width+8,height:l.height}),l)):null}({slice:n,measured:s,padding:o,store:c});break;case"outside":e="rotate"===i?function(t){var e=t.slice,n=t.measured,r=t.padding,i=t.view,a=e.start,o=e.end,s=e.outerRadius,u=e.offset,l=s+r,c=o-a;if(c<Math.PI&&(n.height/2+r)/Math.tan(c/2)>l)return null;var h=Cc((a+o)/2),f=Math.sin(h)*l,d=-Math.cos(h)*l,p=n.width+1,g=h%Math.PI;if(g>Math.PI/2&&(g=Math.PI-g),Math.cos(g)>.001){var v=d<0?i.y:i.y+i.height,y=Math.abs(v-u.y)/Math.cos(g)-Math.tan(g)*(n.height/2)-2*r-s;y<p&&(p=y)}if(Math.sin(g)>.001){var m=f<0?i.x:i.x+i.width,x=Math.abs(m-u.x)/Math.sin(g)-n.height/2/Math.tan(g)-2*r-s;x<p&&(p=x)}if(p<=0||p<n.minReqWidth)return null;var b={x:f,y:d,width:p,height:n.height};return h<Math.PI?(b.angle=h-Math.PI/2,b.anchor="start"):(b.angle=h+Math.PI/2,b.anchor="end"),b}({slice:r,measured:s,padding:o,view:u}):function(t){var e=t.slice,n=t.measured,r=t.padding,i=t.view,a=t.context,o=e.start,s=e.end,u=e.outerRadius,l=e.offset,c=Cc((o+s)/2);if(function(t,e,n){switch(e){case 0:return t.q1maxY<0;case 1:return t.q2minY>n.height;case 2:return t.q3minY>n.height;case 3:return t.q4maxY<0;default:return!0}}(a,Math.floor(c/(Math.PI/2)),i))return null;var h=u+r+n.height/2,f=Math.sin(c)*h,d=-Math.cos(c)*h,p=n.width+1;if(c<Math.PI){var g=Math.abs(i.x+i.width-(f+l.x));g<p&&(p=g)}else{var v=Math.abs(i.x-(f+l.x));v<p&&(p=v)}if(p<n.minReqWidth)return null;var y={x:f,y:d,width:p,height:n.height};return c<Math.PI?y.anchor="start":y.anchor="end",y}({slice:r,measured:s,padding:o,view:u,context:l});break;default:throw new Error("not implemented")}return e&&(e.x+=p.x,e.y+=p.y,"outside"===a&&"rotate"!==i&&function(t,e,n){var r=n.start,i=n.end,a=n.offset,o=n.outerRadius,s=Cc((r+i)/2);switch(Math.floor(s/(Math.PI/2))){case 0:if(void 0!==e.q1maxY){var u=Math.min(t.y,e.q1maxY-t.height),l=t.y-u;if(t.y=u,l>1){var c=o+2;t.line={type:"line",x1:t.x-2,y1:t.y+2,x2:a.x+Math.sin(s)*c,y2:a.y-Math.cos(s)*c,strokeWidth:1}}}break;case 1:if(void 0!==e.q2minY){var h=Math.max(t.y,e.q2minY),f=h-t.y;if(t.y=h,f>1){var d=o+2;t.line={type:"line",x1:t.x-2,y1:t.y-2,x2:a.x+Math.sin(s)*d,y2:a.y-Math.cos(s)*d,strokeWidth:1}}}break;case 2:if(void 0!==e.q3minY){var p=Math.max(t.y,e.q3minY),g=p-t.y;if(t.y=p,g>1){var v=o+2;t.line={type:"line",x1:t.x+2,y1:t.y-2,x2:a.x+Math.sin(s)*v,y2:a.y-Math.cos(s)*v,strokeWidth:1}}}break;case 3:if(void 0!==e.q4maxY){var y=Math.min(t.y,e.q4maxY-t.height),m=t.y-y;if(t.y=y,m>1){var x=o+2;t.line={type:"line",x1:t.x+2,y1:t.y+2,x2:a.x+Math.sin(s)*x,y2:a.y-Math.cos(s)*x,strokeWidth:1}}}}}(e,l,r)),e}function jc(t){for(var e=t.context,n=t.direction,r=t.measured,i=t.node,a=t.placementSettings,o=t.rect,s=t.store,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tc,l=0;l<a.length;l++){var c=a[l],h=u({context:e,slice:i.desc.slice,view:o,direction:n,position:c.position,measured:r,padding:c.padding,store:s});if(h)return{bounds:h,placement:c}}return{bounds:null,placement:null}}function Pc(t){for(var e=[],n=[],r=[],i=[],a=0;a<t.length;++a){var o=t[a].desc.slice,s=Cc((o.start+o.end)/2);switch(Math.floor(s/(Math.PI/2))){case 0:e.push(t[a]);break;case 1:n.push(t[a]);break;case 2:r.push(t[a]);break;case 3:i.push(t[a])}}var u=function(t,e){return Cc((t.desc.slice.start+t.desc.slice.end)/2)-Cc((e.desc.slice.start+e.desc.slice.end)/2)},l=function(t,e){return u(e,t)};return e.sort(l),n.sort(u),r.sort(l),i.sort(u),e.concat(n,i,r)}function zc(t,e,n){var r=e.fontFamily,i="".concat(e.fontSize,"px"),a=n.measureText({text:t,fontFamily:r,fontSize:i});return a.minReqWidth=Math.min(a.width,n.measureText({text:"".concat(t[0],"…"),fontFamily:r,fontSize:i}).width),a}var Fc=/\n+|\r+|\r\n/,Lc=/\s/,Bc=/[a-zA-Z\u00C0-\u00F6\u00F8-\u00FF\u00AD]/;function Hc(t){return"string"==typeof t?-1!==t.search(Fc):-1!==String(t).search(Fc)}function $c(t){return-1!==t.search(Lc)}function Wc(t){return-1!==t.search(Bc)}function Vc(t,e,n,r,i){return r.some((function(r){return r(t,e,n)}))?1:i.some((function(r){return r(t,e,n)}))?0:2}function Uc(t){""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop()}function Yc(t,e,n){return Math.max(e,Math.min(n,t))}function Xc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.string,n=t.separator,r=void 0===n?"":n,i=t.reverse,a=void 0!==i&&i,o=t.measureText,s=void 0===o?function(t){return{width:t.length,height:1}}:o,u=t.mandatoryBreakIdentifiers,l=void 0===u?[Hc]:u,c=t.noBreakAllowedIdentifiers,h=void 0===c?[]:c,f=t.suppressIdentifier,d=void 0===f?[$c,Hc,function(t){return""===t}]:f,p=t.hyphenationIdentifiers,g=void 0===p?[Wc]:p,v=String(e).split(r);Uc(v);var y=v.length,m=a?function(t){return t>=0}:function(t){return t<y},x=a?y:-1;function b(t){var e=Yc(t,0,y-1),n=v[e],r=s(n),i=Vc(n,e,v,l,h);return{index:e,value:n,breakOpportunity:i,suppress:d.some((function(t){return t(n,e,v)})),hyphenation:g.some((function(t){return t(n,e,v)})),width:r.width,height:r.height,done:!1}}function w(t){return isNaN(t)?a?x--:x++:x=Yc(t,0,y-1),m(x)?b(x):{done:!0}}return{next:w,peek:b,length:y}}var Kc="…",Gc=/^\s*\d+(\.\d+)?px\s*$/i;function Zc(t){return"string"===R(t)&&Gc.test(t)}function Jc(t){var e=t["font-size"]||t.fontSize;return Zc(e)?parseFloat(e)*Math.max(isNaN(t.lineHeight)?1.2:t.lineHeight,0):19.2}function Qc(t){var e=t.maxHeight,n=Math.max(t.maxLines,1)||1/0;if(isNaN(e))return n;var r=Jc(t);return Math.max(1,Math.min(Math.floor(e/r),n))}function th(t,e){return{lines:[],line:"",width:0,maxLines:Qc(t),maxWidth:t.maxWidth,hyphens:{enabled:"auto"===t.hyphens,char:"‐",metrics:e("‐")}}}function eh(t){t.lines.push(t.line),t.line="",t.width=0}function nh(t,e){t.line+=e.value,t.width+=e.width}function rh(t,e,n){if(e.width>t.maxWidth)return e;for(var r=e.index,i=1;i<5;i++){var a=n.peek(e.index-1);if(!e.hyphenation||!a.hyphenation||0===e.index)return e;if(t.width+t.hyphens.metrics.width<=t.maxWidth)return t.line+=t.hyphens.char,e;if(1===t.line.length)return e;e=n.next(r-i),t.line=t.line.slice(0,-1),t.width-=e.width}return e}function ih(t,e,n){for(var r=Xc({string:e.value,measureText:n});t.lines.length<t.maxLines;){var i=r.next();if(i.done)break;t.width+i.width>t.maxWidth&&2===i.breakOpportunity&&t.line.length>0?(i=t.hyphens.enabled?rh(t,i,r):i,eh(t),nh(t,i)):nh(t,i)}}function ah(t,e){for(var n=Xc({string:t.text,separator:"",measureText:e,noBreakAllowedIdentifiers:[function(t,e){return 0===e}]}),r=th(t,e),i=!0;r.lines.length<r.maxLines;){var a=n.next();if(a.done){eh(r),i=!1;break}1===a.breakOpportunity?eh(r):r.width+a.width>r.maxWidth&&2===a.breakOpportunity?a.suppress?r.width+=a.width:(a=r.hyphens.enabled?rh(r,a,n):a,eh(r),nh(r,a)):nh(r,a)}return{lines:r.lines,reduced:i}}function oh(t,e){for(var n=Xc({string:t.text,separator:/(\s|-|\u2010)/,measureText:e}),r=th(t,e),i=!0;r.lines.length<r.maxLines;){var a=n.next();if(a.done){eh(r),i=!1;break}1===a.breakOpportunity?eh(r):r.width+a.width>r.maxWidth&&2===a.breakOpportunity?a.suppress?eh(r):a.width>r.maxWidth?ih(r,a,e):(eh(r),nh(r,a)):nh(r,a)}return{lines:r.lines,reduced:i}}function sh(t){return{"break-all":ah,"break-word":oh}[t.wordBreak]}function uh(t){return function(e){var n=e.node;if(function(t){return"text"===t.type&&!t._lineBreak}(n)){var r=sh(n);if(!r)return;var i=t(n);if(i.width>n.maxWidth||Hc(n.text)){var a=(Jc(n)-i.height)/2,o=r(n,function(t,e){return function(n){return e({text:n,fontSize:t.fontSize,fontFamily:t.fontFamily})}}(n,t));e.node=function(t,e,n,r){var i={type:"container",children:[]};void 0!==e.id&&(i.id=e.id);var a=0;return t.lines.forEach((function(o,s){var u=M({},e);u.text=o,u._lineBreak=!0,a+=n,t.reduced&&s===t.lines.length-1?u.text+=Kc:delete u.maxWidth,u.dy=isNaN(u.dy)?a:u.dy+a,a+=r,a+=n,i.children.push(u)})),i}(o,n,a,i.height)}}}}function lh(t,e){var n=t.text,r=t["font-size"],i=t["font-family"],a=t.maxWidth;if(n="string"==typeof n?n:"".concat(n),void 0===a)return n;var o=e({text:n,fontSize:r,fontFamily:i}).width;if(o<=a)return n;for(var s=0,u=n.length-1;s<=u;){var l=Math.floor((s+u)/2);(o=e({text:n.substr(0,l)+Kc,fontSize:r,fontFamily:i}).width)<=a?s=l+1:u=l-1}return n.substr(0,u)+Kc}function ch(t){var e=t.baseline||t["dominant-baseline"],n=0,r=parseInt(t.fontSize||t["font-size"],10)||0;switch(e){case"hanging":n=.75*r;break;case"text-before-edge":n=.85*r;break;case"middle":n=.25*r;break;case"central":n=.35*r;break;case"mathemetical":n=r/2;break;case"text-after-edge":case"ideographic":n=.2*-r;break;default:n=0}return n}var hh,fh={},dh={},ph={fontSize:void 0,fontFamily:void 0};function gh(t,e,n){var r=t+e+n;return"number"!=typeof dh[r]&&(hh=hh||document.createElement("canvas").getContext("2d"),function(t,e){ph.fontSize===t&&ph.fontFamily===e||(hh.font=t+" "+e,ph.fontSize=t,ph.fontFamily=e)}(e,n),dh[r]=hh.measureText(t).width),dh[r]}function vh(t){return"number"!=typeof fh[t]&&(fh[t]=function(t){if(Zc(t)){var e=parseFloat(t);return e+4*Math.ceil((e+1e-12)/24)}return 16}(t)),fh[t]}function yh(t){var e=t.text,n=t.fontSize;return{width:gh(e,n,t.fontFamily),height:vh(n)}}function mh(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yh,n=t["font-size"]||t.fontSize,r=t["font-family"]||t.fontFamily,i=e({text:t.text,fontFamily:r,fontSize:n}),a=Math.min(t.maxWidth||i.width,i.width),o=t.x||0,s=t.y||0,u=t.dx||0,l=(t.dy||0)+ch(t),c={x:0,y:s+l-.75*i.height,width:a,height:i.height},h=t["text-anchor"]||t.anchor;return c.x="middle"===h?o+u-a/2:"end"===h?o+u-a:o+u,c}function xh(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yh,n=sh(t),r=t["font-size"]||t.fontSize,i=t["font-family"]||t.fontFamily,a=e({text:t.text,fontFamily:i,fontSize:r});if(n&&(a.width>t.maxWidth||Hc(t.text))){for(var o=n(t,(function(t){return e({text:t,fontFamily:i,fontSize:r})})),s=M({},t),u=0,l="",c=0,h=o.lines.length;c<h;c++){var f=o.lines[c];f+=c===h-1&&o.reduced?Kc:"";var d=e({text:f,fontSize:r,fontFamily:i}).width;d>=u&&(u=d,l=f)}s.text=l;var p=mh(s,e);return p.height=Jc(t)*o.lines.length,p}return mh(t,e)}var bh=.9;function wh(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function kh(t,e,n){var r={type:"text",text:e,maxWidth:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:"start",baseline:"alphabetical",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},i=n.textMetrics;if(t.width<n.fontSize)return!1;var a=Math.max(0,t.width-i.width);return r.x=t.x+n.align*a,r.y=t.y+i.height/1.2,r}function Mh(t){return{type:"circle",bounds:{cx:t.cx,cy:t.cy,r:t.r}}}function _h(t){return t.desc&&t.desc.slice?function(t){var e=t.start,n=t.end,r=t.innerRadius,i=t.outerRadius,a=t.offset;if(Math.abs(e+2*Math.PI-n)>1e-12)return{type:null,bounds:null};var o=0!==r?r:i;return Mh({cx:a.x,cy:a.y,r:o})}(t.desc.slice):"circle"===t.type?Mh(t.attrs):"rect"===t.type?{type:"rect",bounds:t.bounds}:{type:null,bounds:null}}var Sh={bar:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.rect,a=t.renderer,o=t.style,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mc,u=M({fontSize:12,fontFamily:"Arial",align:.5,justify:0,fill:"#333"},o.label);u.fontSize=parseInt(u.fontSize,10);var l=e.labels.map((function(t){return M({},u,e,t)})),c=e.labels.map((function(t){return t.placements.map((function(n){return M({},u,e,t,n)}))})),h=_c({nodes:r,chart:n,renderer:a,settings:e,rect:i,labelSettings:l,placementSettings:c}),f=h.fitsHorizontally,d=h.hasHorizontalDirection,p=h.targetNodes,g=Sc({orientation:e.orientation,defaultOrientation:d?"h":"v"}),v="h"===g?"y":"x",y="h"===g?"height":"width";return p.sort((function(t,e){return t.node.localBounds[v]+t.node.localBounds[y]-(e.node.localBounds[v]+e.node.localBounds[y])})),s({chart:n,targetNodes:p,stngs:e,rect:i,fitsHorizontally:f,collectiveOrientation:g})},slice:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.rect,a=t.renderer,o=t.style,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jc,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ic,l=M({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,position:"into"},o.label);l.fontSize=parseInt(l.fontSize,10);for(var c=e.labels.map((function(t){return M({},l,e,t)})),h=e.labels.map((function(t){return t.placements.map((function(n){return M({},l,e,t,n)}))})),f=[],d={insideLabelBounds:[]},p={},g=0,v=(r=Pc(r)).length;g<v;g++)for(var y=r[g],m=Ec(y,n),x=0;x<c.length;x++){var b=c[x],w="function"==typeof b.label?b.label(m,g):"";if(w){var k="function"==typeof b.direction?b.direction(m,g):b.direction||"horizontal",_="function"==typeof b.linkData?b.linkData(m,g):void 0,S=zc(w,b,a),C=s({context:p,direction:k,lblStngs:b,measured:S,node:y,placementSettings:h[x],rect:i,store:d}),R=C.bounds,q=C.placement;if(R&&q){if("outside"===q.position&&"rotate"!==k){Oc({context:p,node:y,bounds:R});var N=qc(R);if(!ms(N,i))continue}var A="function"==typeof q.fill?q.fill(m,g):q.fill,D=u(R,w,{fill:A,fontSize:b.fontSize,fontFamily:b.fontFamily,textMetrics:S});D&&(void 0!==_&&(D.data=_),f.push(D),R.line&&(R.line.stroke=A,f.push(R.line)))}}}return f},rows:function(t){var e=t.settings,n=t.chart,r=t.nodes,i=t.renderer,a=t.style,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kh,s=M({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,align:.5,justify:.5},a.label);s.fontSize=parseInt(s.fontSize,10);for(var u=M({},s,e),l=e.labels.map((function(t){return M({},u,t)})),c={},h=[],f=0,d=r.length;f<d;f++){var p=r[f],g=wh(p,n),v=_h(p),y=v.type,m=v.bounds;if(m){var x=0,b=[],w=[],k="circle"===y?2*m.r*bh:m.height;x+=u.padding;var _=void 0;for(_=0;_<l.length;_++){var S=l[_],C="function"==typeof S.label?S.label(g,f):"";c.fontFamily=S.fontFamily,c.fontSize="".concat(S.fontSize,"px"),c.text=C;var R=i.measureText(c);if((x+=R.height+S.padding)>k)break;w.push(C),b.push(R)}var q=_,N=Math.max(0,k-x),A=void 0;for(A="circle"===y?m.cy-m.r*bh:m.y,A+=u.justify*N+u.padding,_=0;_<q;_++){var D=l[_],O=void 0;if("circle"===y){var E=Math.max(Math.abs(A-m.cy),Math.abs(A+b[_].height-m.cy)),I=Math.sqrt(m.r*m.r-E*E);O={x:m.cx-I+u.padding,y:A,width:2*I-2*u.padding,height:b[_].height}}else O={x:m.x+u.padding,y:A,width:m.width-2*u.padding,height:b[_].height};A+=b[_].height+u.padding;var T="function"==typeof D.fill?D.fill(g,f):D.fill,j="function"==typeof D.linkData?D.linkData(g,f):void 0,P=o(O,w[_],{fill:T,align:D.align,fontSize:D.fontSize,fontFamily:D.fontFamily,textMetrics:b[_]});if(P){if(P.text&&P.text!==Kc){var z=lh(P,i.measureText);if(Kc===z)continue;P.ellipsed=z}void 0!==j&&(P.data=j),h.push(P)}}}}return h}};var Ch={require:["chart","renderer","settings"],defaultSettings:{settings:{},style:{label:"$label"}},render:function(){var t=this,e=this.settings.settings,n=[];return(e.sources||[]).forEach((function(e){e.strategy&&Sh[e.strategy.type]&&e.component&&n.push.apply(n,$(function(t,e){var n=t.chart,r=t.source,i=t.rect,a=t.renderer,o=t.style;if(!n.component(r.component))return[];var s=n.findShapes(r.selector).filter((function(t){return t.key===r.component}));return e({chart:n,settings:r.strategy.settings,nodes:s,rect:{x:0,y:0,width:i.width,height:i.height},renderer:a,style:o})}({chart:t.chart,rect:t.rect,renderer:t.renderer,source:e,style:t.style},Sh[e.strategy.type])))})),n}};var Rh={layout:{size:1,direction:"ltr",scrollOffset:0},item:{show:!0,justify:.5,align:.5,label:{fontSize:"12px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:136,lineHeight:1.2},shape:{type:"square",size:12}},title:{show:!0,text:void 0,anchor:"start",fontSize:"16px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:156,lineHeight:1.25},navigation:{button:{class:void 0,content:void 0,tabIndex:void 0},disabled:!1}};function qh(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=t.item,a=t.globalMetrics,o=t.createSymbol,s=t.direction,u=void 0===s?"ltr":s,l=i.label.displayObject,c=i.label.bounds,h=i.symbol.meta,f="rtl"===u,d={x:f?n+a.maxLabelBounds.width:n+a.maxSymbolSize+a.spacing,y:r,width:a.maxLabelBounds.width,height:Math.max(a.maxSymbolSize,a.maxLabelBounds.height)},p=function(t,e,n){var r=Math.max(0,t.width-e),i=Math.max(0,t.height-e);return{x:t.x+e/2+n.align*r,y:t.y+e/2+n.justify*i}}({x:f?n+a.maxLabelBounds.width+a.spacing:n,y:r,width:a.maxSymbolSize,height:d.height},h.size,{align:void 0===h.align?.5:h.align,justify:void 0===h.justify?.5:h.justify}),g=o(M({},h,p));return delete g.collider,l.anchor=f?"end":"start",function(t,e,n){var r=n.textMetrics;if(t.height<r.height)return!1;var i=Math.max(0,t.width-r.width);e.baseline="text-before-edge";var a=Math.max(0,t.height-r.height);e.x=t.x+n.align*i,e.y=t.y+n.justify*a+.175*parseInt(e.fontSize,10)}(d,l,{textMetrics:c,fontSize:parseInt(l.fontSize,10),align:0,justify:.5}),{item:{type:"container",data:i.label.displayObject.data,children:[g,l],collider:{type:"rect",x:n,y:r,width:a.maxItemBounds.width,height:a.maxItemBounds.height}},metrics:d}}function Nh(t,e){var n=t.items.length,r=Math.ceil(n/e),i="horizontal"===t.layout.orientation?"width":"height",a="width"===i?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[i]*r+(r-1)*t.layout.margin[a]}function Ah(t,e){var n,r,i,a,o=e.onScroll,s=void 0===o?function(){}:o,u=null,l=0,c={itemize:function(e){n=function(t,e){for(var n,r,i=t.resolved,a=t.dock,o=[],s=i.items.items,u=i.symbols.items,l=i.labels.items,c=0,h=0,f=0,d=0;d<s.length;d++)if(!1!==s[d].show){var p=void 0!==l[d].text?l[d].text:l[d].data.label||"";n=M({},l[d],{type:"text",fontSize:"".concat(parseInt(l[d].fontSize,10),"px"),text:p,title:p}),r={symbol:{meta:u[d]},label:{displayObject:n,bounds:e.textBounds(n)}},o.push(r),c=Math.max(u[d].size,c),h=Math.max(r.label.bounds.width,h),f=Math.max(r.label.bounds.height,f)}return{items:o,globalMetrics:{spacing:8,maxSymbolSize:c,maxItemBounds:{height:Math.max(c,f),width:c+8+h},maxLabelBounds:{width:h,height:f}},layout:{margin:{vertical:void 0!==i.layout.item.vertical?i.layout.item.vertical:4,horizontal:void 0!==i.layout.item.horizontal?i.layout.item.horizontal:4},mode:i.layout.item.mode,size:i.layout.item.size,orientation:"top"===a||"bottom"===a?"horizontal":"vertical",direction:i.layout.item.direction,scrollOffset:i.layout.item.scrollOffset}}}(e,t.renderer),u=isNaN(n.layout.scrollOffset)?u:n.layout.scrollOffset},getItemsToRender:function(e){i=e.viewRect,l=c.getContentOverflow(i);var o=c.extent();u=Math.max(0,Math.min(u,l)),a=M({},i);var s="horizontal"===c.orientation()?"x":"y";return a[s]-=u,a["x"===s?"width":"height"]=o,function(t,e,n){for(var r=t.viewRect,i=n.itemized,a=n.create,o=void 0===a?qh:a,s=n.parallels,u=n.createSymbol,l=i.layout.direction,c=i.globalMetrics,h=i.items,f="horizontal"===i.layout.orientation,d=0,p=[],g=c.maxItemBounds.height,v=c.maxItemBounds.width,y=i.layout.margin.vertical+g,m=i.layout.margin.horizontal+v,x=e.x,b=e.y,w=r.x-e.x,k=0;k<h.length;k++){var M=o({y:b,x:"rtl"===l?r.x+w+r.width-v-(x-e.x):x,item:h[k],globalMetrics:c,direction:l,createSymbol:u});if((f&&x>=r.x-v||!f&&b>=r.y-g)&&p.push(M.item),++d>=s?(d=0,f?(x+=m,b=e.y):(b+=y,x=e.x)):f?b+=y:x+=m,!f&&b>r.y+r.height)break;if(f&&x>r.x+r.width)break}return p}(e,a,{itemized:n,parallels:r,createSymbol:t.symbol})},parallelize:function(t,e){return r=function(t,e,n){var r=n.items.length,i="horizontal"===n.layout.orientation?"width":"height",a="width"===i?"horizontal":"vertical",o=n.globalMetrics.maxItemBounds[i]*r+(r-1)*n.layout.margin[a],s=Math.ceil(o/t);if(null!=e){var u="horizontal"===n.layout.orientation?"height":"width",l="width"===u?"horizontal":"vertical",c=n.layout.margin[l]||4,h=Math.floor((e+c)/(c+n.globalMetrics.maxItemBounds[u]));s=Math.min(s,h)}var f=isNaN(n.layout.size)?1:n.layout.size;return Math.max(1,Math.min(s,f))}(t,e,n)},hasContentOverflow:function(){var t="horizontal"===n.layout.orientation?"width":"height";return Nh(n,r)>i[t]},getContentOverflow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e="horizontal"===n.layout.orientation?"width":"height";return Math.max(0,Nh(n,r)-t[e])},getNextSize:function(){var t="horizontal"===n.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return n.globalMetrics.maxItemBounds[t]+n.layout.margin[e]},getPrevSize:function(){var t="horizontal"===n.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return n.globalMetrics.maxItemBounds[t]+n.layout.margin[e]},hasNext:function(){return"horizontal"===c.orientation()?i.x+i.width<a.x+a.width:i.y+i.height<a.y+a.height},hasPrev:function(){return"horizontal"===c.orientation()?a.x<i.x:a.y<i.y},next:function(){c.scroll(-c.getNextSize())},prev:function(){c.scroll(c.getPrevSize())},scroll:function(t){var e=Math.max(0,Math.min(l,u-t));e!==u&&(u=e,s())},offset:function(){return u},orientation:function(){return n.layout.orientation},direction:function(){return n.layout.direction},extent:function(){return Nh(n,r)},spread:function(){return function(t,e){var n=e,r="horizontal"===t.layout.orientation?"height":"width",i="width"===r?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[r]*n+(n-1)*t.layout.margin[i]}(n,r)}};return c}function Dh(t){return Object.keys(t).filter((function(e){return t[e]})).join(" ")}var Oh={up:"▲",right:"▶",down:"▼",left:"◀"};function Eh(t,e){var n=e.size,r=e.isActive,i=e.direction,a=e.nav,o={},s="",u=e.attrs;a&&a.button&&("function"==typeof a.button.class?o=a.button.class({direction:i}):a.button.class&&(o=a.button.class),"function"==typeof a.button.content&&(s=a.button.content(t,{direction:i})),void 0!==a.button.tabIndex&&(u.tabindex=a.button.tabIndex));var l={width:"".concat(n,"px"),minWidth:"".concat(n,"px"),height:"".concat(n,"px")};return Object.keys(o).length||(l.border="0",l.background="none"),(!r||a&&a.disabled)&&(u.disabled="disabled"),t("button",M({class:Dh(o),style:l},u),[s||t("span",{style:{pointerEvents:"none"}},[Oh[i]])])}function Ih(t){var e,n={itemize:function(t){var n,r;r=(n=t).dock,e={layout:{orientation:"top"===r||"bottom"===r?"vertical":"horizontal"},navigation:n.navigation}},render:function(r){return function(t,e,n,r){var i=e.rect,a=e.itemRenderer;if(t&&t.renderArgs){t.size(i);var o=t.renderArgs[0],s="vertical"===n.layout.orientation,u="rtl"===a.direction(),l=a.hasNext(),c=a.hasPrev();if(c||l){var h=s?["right","left"]:["down","up"];u&&s&&h.reverse();var f=[o("div",{style:{position:"relative",display:"flex","flex-direction":s?"column":"row","justify-content":"center",height:"100%",pointerEvents:"auto"},dir:u&&!s?"rtl":"ltr"},[Eh(o,{size:32,isActive:l,direction:h[0],attrs:{"data-action":"next","data-component-key":r.settings.key},nav:n.navigation}),Eh(o,{size:32,isActive:c,direction:h[1],attrs:{"data-action":"prev","data-component-key":r.settings.key},nav:n.navigation})])];t.render(f)}else t.render([])}}(n.renderer,r,e,t)},extent:function(){return 32},spread:function(){return 64}};return n}function Th(t){var e,n={itemize:function(n){e=function(t,e){var n=t.resolved;if(!1===n.title.item.show)return null;var r=M({},n.title.item,{type:"text"});if("rtl"===n.layout.item.direction&&(r.anchor&&"start"!==r.anchor?"end"===r.anchor&&(r.anchor="start"):r.anchor="end"),void 0===n.title.settings.text){var i=e.scale.data().fields;r.text=i&&i[0]?i[0].title():""}return{displayObject:r,bounds:e.renderer.textBounds(r)}}(n,t)},render:function(t){!function(t,e,n){var r=t.rect;if(e){var i=[];if(e.size(r),n){var a={start:0,end:r.width,middle:r.width/2};i.push(M({},n.displayObject,{x:a[n.displayObject.anchor]||0,y:0,baseline:"text-before-edge",title:n.displayObject.text}))}e.render(i)}}(t,n.renderer,e)},spread:function(){return e?e.bounds.height:0},extent:function(){return e?e.bounds.width:0}};return n}function jh(t,e,n,r){var i,a,o,s=r.itemRenderer,u=r.navigationRenderer,l=r.titleRenderer,c=r.isPreliminary,h=void 0!==c&&c,f=0,d={x:e.spacing,y:e.spacing,width:t.width-2*e.spacing,height:t.height-2*e.spacing};if(i={x:d.x,y:d.y,width:d.width,height:l.spread()},"horizontal"===n){i={x:d.x,y:d.y,width:l.extent(),height:l.spread()};var p=d.width-i.width-(i.width?e.spacing:0),g=d.height;s.parallelize(p,h?void 0:g);var v=s.extent()>p?u.extent():0,y=s.spread(),m=v?u.spread():0;o={x:(a={x:i.x+i.width+(i.width?e.spacing:0),y:d.y+Math.max(0,(m-y)/2),width:d.width-v-i.width-(v?e.spacing:0)-(i.width?e.spacing:0),height:g}).x+a.width+(v?e.spacing:0),y:d.y,width:v,height:d.height},i.y=a.y,"rtl"===s.direction()&&(o.x=d.x,a.x=o.x+o.width+(o.width?e.spacing:0),i.x=a.x+a.width+(i.width?e.spacing:0)),f=Math.max(i.height,m,s.spread())}else{var x=d.height-i.height-(i.height?e.spacing:0),b=d.width;s.parallelize(x,h?void 0:b);var w=s.extent()>x?u.extent():0;o={x:d.x,y:d.y+d.height-w,width:d.width,height:w},a={x:d.x,y:i.y+i.height+(i.height?e.spacing:0),width:d.width,height:d.height-i.height-(i.height?e.spacing:0)-o.height-(o.height?e.spacing:0)},f=Math.max(l.extent(),w?u.spread():0,s.spread())}return a=M({},t,{x:t.x+a.x,y:t.y+a.y,width:a.width,height:a.height}),o.x+=t.x,o.y+=t.y,i.x+=t.x,i.y+=t.y,{title:M({},t,i),content:M({},t,a),navigation:M({},t,o),orientation:n,preferredSize:f}}function Ph(t){t.state.resolved=function(t){var e=t.scale.domain(),n={items:[]},r=t.settings.layout.dock;if("threshold-color"===t.scale.type){var i=t.scale.data().fields[0],a=function(t){return String(t)};t.settings.formatter?a=t.chart.formatter(t.settings.formatter):i&&(a=i.formatter());for(var o=0;o<e.length-1;o++){var s={value:e[o],label:"".concat(a(e[o])," - < ").concat(a(e[o+1]))};i&&(s.source={field:i.id()}),n.items.push(s)}"vertical"==("top"===r||"bottom"===r?"horizontal":"vertical")&&n.items.reverse()}else{var u=t.scale.labels?t.scale.labels():null;n.items=e.map((function(e,n){var r=t.scale.datum?M({},t.scale.datum(e)):{value:e};return r.value=e,t.scale.label?r.label=t.scale.label(e):u&&(r.label=u[n]),r}))}var l=t.resolver.resolve({data:{fields:t.scale.data().fields},defaults:M(!0,{},Rh.title,t.style.title),settings:t.settings.settings.title}),c=t.resolver.resolve({data:{fields:t.scale.data().fields},defaults:Rh.layout,settings:t.settings.settings.layout}),h=t.resolver.resolve({data:n,defaults:M(!0,{},Rh.item.label,t.style.item.label),settings:(t.settings.settings.item||{}).label}),f=M(!0,{},(t.settings.settings.item||{}).shape);void 0===f.fill&&t.settings.scale&&(f.fill={scale:t.settings.scale});var d=t.resolver.resolve({data:n,defaults:M(!0,{},Rh.item.shape,t.style.item.shape),settings:f}),p=t.resolver.resolve({data:n,defaults:M(!0,{},{show:Rh.item.show}),settings:{show:(t.settings.settings.item||{}).show}});function g(t,n){var r=t.data.value,i=e[n+1];t.data.value=[r,i]}return"threshold-color"===t.scale.type&&("vertical"==("top"===r||"bottom"===r?"horizontal":"vertical")?(p.items.reverse().forEach(g),p.items.reverse()):p.items.forEach(g)),{title:l,labels:h,symbols:d,items:p,layout:c}}(t),t.titleRenderer.itemize({resolved:t.state.resolved,dock:t.settings.layout.dock||"center"}),t.itemRenderer.itemize({resolved:t.state.resolved,dock:t.settings.layout.dock||"center"}),t.navigationRenderer.itemize({resolved:t.state.resolved,dock:t.settings.layout.dock||"center",navigation:t.settings.settings.navigation}),t.state.display={spacing:8}}function zh(t){var e=t.rect,n=t.settings,r=t.state,i=t.itemRenderer,a=t.navigationRenderer,o=t.titleRenderer,s=n.layout.dock,u="top"===s||"bottom"===s?"horizontal":"vertical",l=jh(e,r.display,u,{itemRenderer:i,navigationRenderer:a,titleRenderer:o});t.renderer.size(l.content);var c=i.getItemsToRender({viewRect:M({},l.content,{x:0,y:0})});return a.render({rect:l.navigation,itemRenderer:i}),o.render({rect:l.title}),t.state.views={layout:l},c}var Fh={require:["chart","settings","renderer","update","resolver","registries","symbol"],defaultSettings:{settings:{},style:{item:{label:"$label",shape:"$shape"},title:"$title"}},mounted:function(t){t&&t.parentNode&&(this.navigationRenderer.renderer.appendTo(t.parentNode),this.titleRenderer.renderer.appendTo(t.parentNode),t.parentNode.insertBefore(this.navigationRenderer.renderer.element(),t),t.parentNode.insertBefore(this.titleRenderer.renderer.element(),t)),this.navigationRenderer.render({rect:this.state.views.layout.navigation,itemRenderer:this.itemRenderer}),this.titleRenderer.render({rect:this.state.views.layout.title})},beforeUnmount:function(){this.navigationRenderer.renderer.clear(),this.titleRenderer.renderer.clear()},on:{panstart:function(){this.state.interaction.started||this.itemRenderer.getContentOverflow()&&(this.state.interaction.started=!0,this.state.interaction.delta=0)},panmove:function(t){if(this.state.interaction.started){var e="horizontal"===this.itemRenderer.orientation()?("rtl"===this.itemRenderer.direction()?-1:1)*t.deltaX:t.deltaY;this.itemRenderer.scroll(e-this.state.interaction.delta),this.state.interaction.delta=e}},panend:function(){this.state.interaction.started=!1},scroll:function(t){this.itemRenderer.scroll(-t)},next:function(){this.itemRenderer.next()},prev:function(){this.itemRenderer.prev()}},created:function(){var t=this;this.state={interaction:{}},this.onScroll=function(){var e=zh(t);t.update(e)},this.itemRenderer=Ah(this,{onScroll:this.onScroll}),this.navigationRenderer=Ih(this),this.titleRenderer=Th(this),this.navigationRenderer.renderer=this.registries.renderer("dom")(),this.titleRenderer.renderer=this.registries.renderer(this.settings.renderer)(),Ph(this)},preferredSize:function(t){return function(t,e){var n=0,r=t.settings.layout.dock||"center",i="top"===r||"bottom"===r?"horizontal":"vertical",a=t.state.display,o=jh(e.inner,a,i,{itemRenderer:t.itemRenderer,navigationRenderer:t.navigationRenderer,titleRenderer:t.titleRenderer,isPreliminary:!0});return n+=a.spacing,n+=o.preferredSize,n+a.spacing}(this,t)},beforeUpdate:function(){Ph(this)},render:function(){return zh(this)},beforeDestroy:function(){this.navigationRenderer.renderer.destroy(),this.titleRenderer.renderer.destroy()},additionalElements:function(){return[this.titleRenderer.renderer.element(),this.navigationRenderer.renderer.element()]},_DO_NOT_USE_getInfo:function(){return{offset:this.itemRenderer.offset()}}};function Lh(t,e){var n=0,r=t.state.isVertical?"justify":"align",i=t.state.isVertical?"y":"x",a=t.state.isVertical?"height":"width",o=t.state.isVertical?"requiredHeight":"requiredWidth";n=t.state.rect[a]-t.state.legend.length()-t.state.title[o](),n*=Math.min(1,Math.max(t.stgns[r],0)),e[i]+=n}function Bh(t,e,n){var r=n[t];return"object"===R(r)?-1!==r.valid.indexOf(e)?e:r.default:n.default}function Hh(t){return Bh(t.layout.dock,t.settings.title.anchor,{left:{valid:["top"],default:"top"},right:{valid:["top"],default:"top"},top:{valid:["left","right"],default:"left"},bottom:{valid:["left","right"],default:"left"},default:"top"})}function $h(t,e){var n={x:0,y:0,width:0,height:0},r=t.stgns.padding;return n.x=r.left,n.y=r.top,n.width=e.width-r.left-r.right,n.height=e.height-r.top-r.bottom,n}function Wh(t){var e="top"!==t.settings.layout.dock&&"bottom"!==t.settings.layout.dock,n=t.stgns.title,r=t.chart.scale(t.stgns.fill),i=t.chart.scale(t.stgns.major),a=function(t,e){var n=e.domain(),r=n,i=t.stgns.tick.label;return!i&&t.formatter?i=t.formatter:!i&&e.data().fields&&(i=e.data().fields[0].formatter()),"function"==typeof i&&(r=n.map(i).map(String)),n.map((function(n,i){var a=r[i];return{value:n,label:a,pos:e.norm(parseFloat(n,10)),textMetrics:t.renderer.measureText({text:a,fontSize:t.stgns.tick.fontSize,fontFamily:t.stgns.tick.fontFamily})}}))}(t,i),o=function(t){return Bh(t.layout.dock,t.settings.tick.anchor,{left:{valid:["left","right"],default:"left"},right:{valid:["left","right"],default:"right"},top:{valid:["top","bottom"],default:"top"},bottom:{valid:["top","bottom"],default:"bottom"},default:"right"})}(t.settings);if(void 0===n.text){var s=i.data().fields;n.text=s&&s[0]?s[0].title():""}var u=t.renderer.measureText({text:n.text,fontSize:n.fontSize,fontFamily:n.fontFamily}),l=t.renderer.textBounds({text:n.text,fontSize:n.fontSize,fontFamily:n.fontFamily,maxLines:n.maxLines,maxWidth:n.maxLengthPx,wordBreak:n.wordBreak,hyphens:n.hyphens,lineHeight:n.lineHeight}),c={isVertical:e,nodes:[],title:{anchor:Hh(t.settings),textMetrics:u,textBounds:l,requiredWidth:function(){if(!n.show)return 0;var t=l.width,r=n.maxLengthPx;return e||(t+=n.padding,r+=n.padding),Math.min(t,r,c.rect.width)},requiredHeight:function(){if(!n.show)return 0;var t=l.height;return e&&(t+=n.padding),Math.min(t,c.rect.height)}},ticks:{values:a,anchor:o,length:Math.min(Math.max.apply(Math,$(a.map((function(t){return t.textMetrics.width})))),t.stgns.tick.maxLengthPx),requiredHeight:function(){return"top"===o?Math.max.apply(Math,$(c.ticks.values.map((function(t){return t.textMetrics.height}))))+t.stgns.tick.padding:0},height:Math.max.apply(Math,$(a.map((function(t){return t.textMetrics.height}))))},legend:{fillScale:r,majorScale:i,length:function(){var n=e?"height":"width",r=e?"requiredHeight":"requiredWidth",i=Math.min(c.rect[n],c.rect[n]*t.stgns.length)-c.title[r]();return Math.max(0,Math.min(i,t.stgns.maxLengthPx))}}};return c}var Vh={require:["chart","settings","renderer"],defaultSettings:{layout:{displayOrder:0,dock:"right"},settings:{size:15,length:.5,maxLengthPx:250,align:.5,justify:0,padding:{left:5,right:5,top:5,bottom:5},tick:{label:null,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,anchor:null,padding:5},title:{show:!0,text:void 0,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,padding:5,maxLines:2,wordBreak:"none",lineHeight:1.2,hyphens:"auto",anchor:null}}},preferredSize:function(t){var e=this.state;e.rect=$h(this,t.inner);var n=this.stgns.size,r=e.isVertical?this.stgns.padding.left+this.stgns.padding.right:this.stgns.padding.top+this.stgns.padding.bottom;n+=r;var i=Math.max(t.inner.width,t.inner.height);if("left"===e.ticks.anchor||"right"===e.ticks.anchor){if(e.ticks.values.reduce((function(t,e){return t+e.textMetrics.height}),0)>this.state.legend.length())return i;n+=e.ticks.length}else{if(e.ticks.length>this.state.legend.length())return i;n+=Math.max.apply(Math,$(e.ticks.values.map((function(t){return t.textMetrics.height}))))}return n+=this.stgns.tick.padding,this.stgns.title.show&&(n="left"===e.title.anchor||"right"===e.title.anchor?Math.max(e.title.textBounds.height+r,n):Math.max(n,e.title.requiredWidth()+r)),this.state.preferredSize=n,n},created:function(){this.stgns=this.settings.settings,this.state=Wh(this)},beforeUpdate:function(t){this.stgns=t.settings.settings,this.state=Wh(this)},beforeRender:function(t){if(this.state.nodes=[],this.state.rect=$h(this,t.size),this.stgns.title.show){var e=function(t){var e=t.state,n=t.stgns,r="left"===e.ticks.anchor,i="top"===e.ticks.anchor,a=e.rect.x,o=e.rect.y,s="start";"left"===e.title.anchor?(a+=e.title.requiredWidth()-n.title.padding,o+=e.title.textMetrics.height,o+=i?e.rect.height-e.title.textBounds.height:0,s="end"):"right"===e.title.anchor?(a+=e.legend.length(),a+=n.title.padding,o+=e.title.textMetrics.height,o+=i?e.rect.height-e.title.textBounds.height:0):"top"===e.title.anchor&&(a+=r?e.rect.width:0,o+=e.title.textMetrics.height,s=r?"end":"start");var u={tag:"legend-title",type:"text",x:a,y:Math.min(o,e.rect.y+e.rect.height),text:n.title.text,fill:n.title.fill,fontSize:n.title.fontSize,fontFamily:n.title.fontFamily,maxWidth:n.title.maxLengthPx,maxLines:n.title.maxLines,wordBreak:n.title.wordBreak,hyphens:n.title.hyphens,lineHeight:n.title.lineHeight,anchor:s,title:n.title.text};return Lh(t,u),u}(this);this.state.nodes.push(e)}var n,r,i,a=function(t,e){var n=t.state,r=t.stgns,i=n.rect,a=i.x,o=i.y,s=n.isVertical?r.size:n.legend.length(),u=n.isVertical?n.legend.length():r.size;"left"===n.ticks.anchor?a+=n.rect.width-r.size:"top"===n.ticks.anchor&&(o+=n.rect.height-r.size),"top"===n.title.anchor?o+=n.title.requiredHeight():"left"===n.title.anchor&&(a+=n.title.requiredWidth());var l={type:"rect",x:a,y:o,width:s,height:u,fill:{type:"gradient",stops:e,degree:n.isVertical?90:180}};return Lh(t,l),l}(this,(r=(n=this).state.legend.fillScale,i=n.state.legend.majorScale,r.domain().map((function(t){return{type:"stop",color:r(t),offset:Math.min(1,Math.max(0,i.norm(t)))}})).sort((function(t,e){return t.offset-e.offset})))),o={id:"legend-seq-target",type:"container",children:[a,function(t,e){var n=t.state,r=t.stgns,i="start",a={type:"rect",x:e.x,y:e.y,width:n.isVertical?0:e.width,height:n.isVertical?e.height:0,fill:"transparent"},o=n.ticks.values.map((function(o){var s=0,u=0,l=0,c="alphabetical";return n.isVertical?(u=e.y+e.height*o.pos,c=0===o.pos?"text-before-edge":"text-after-edge"):s=e.x+e.width*o.pos,"right"===n.ticks.anchor?(s=e.x+r.size+r.tick.padding,a.x=e.x+e.width):"left"===n.ticks.anchor?(s=e.x-r.tick.padding,i="end"):"top"===n.ticks.anchor?(u=e.y-r.tick.padding,l-=.25*o.textMetrics.height,i=0===o.pos?"start":"end"):"bottom"===n.ticks.anchor&&(u=e.y+e.height+r.tick.padding,l=.8*o.textMetrics.height,i=0===o.pos?"start":"end",a.y=e.y+e.height),{type:"text",x:s,y:u,dx:0,dy:l,text:o.label,fontSize:r.tick.fontSize,fontFamily:r.tick.fontFamily,fill:r.tick.fill,maxWidth:n.isVertical?r.tick.maxLengthPx:Math.min(r.tick.maxLengthPx,n.legend.length()/2),anchor:i,textBoundsFn:t.renderer.textBounds,title:o.label,baseline:c}}));return{type:"container",id:"legend-seq-ticks",children:[].concat($(o),[a])}}(this,a)]};this.state.nodes.push(o)},render:function(){return this.state.nodes}};var Uh={step:function(t){return new ne(t,.5)},stepAfter:function(t){return new ne(t,1)},stepBefore:function(t){return new ne(t,0)},linear:Et,basis:function(t){return new Bt(t)},cardinal:Wt.tension(0),catmullRom:Ut,monotonex:function(t){return new Zt(t)},monotoney:function(t){return new Jt(t)},natural:function(t){return new te(t)}},Yh={coordinates:{minor:.5,major:.5,layerId:0,defined:!0},connect:!1,orientation:"horizontal",layers:{curve:"linear",show:!0,sort:void 0,line:{stroke:"#ccc",strokeWidth:1,strokeLinejoin:"miter",strokeDasharray:void 0,opacity:1,show:!0,showMinor0:!0},area:{fill:"#ccc",opacity:.8,show:!0}}};function Xh(t,e){var n=e.generator,r=e.item,i=e.data,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=n(t),s={type:"path",d:o,opacity:r.opacity,stroke:r.stroke,strokeWidth:r.strokeWidth,strokeLinejoin:r.strokeLinejoin,fill:a||r.fill,data:i};return r.strokeDasharray&&(s.strokeDasharray=r.strokeDasharray),s}function Kh(t){var e=function(t){for(var e=t.data,n=t.stngs,r=t.rect,i=t.resolver,a=t.style,o=t.domain,s=r.width,u=r.height,l=i.resolve({data:e,defaults:Yh.coordinates,settings:n.coordinates||{},scaled:{major:"vertical"===n.orientation?u:s,minor:"vertical"===n.orientation?s:u}}),c=!n.connect&&o.length>2&&("function"==typeof n.coordinates.layerId||"object"===R(n.coordinates.layerId)),h={},f=0,d=0;d<l.items.length;d++){var p=l.items[d],g=p.layerId;if(c){var v=h[g]?h[g].items[h[g].items.length-1]:null,y=v?o.indexOf(v.data.major?v.data.major.value:v.data.value):null;v&&o.indexOf(p.data.major?p.data.major.value:p.data.value)-1!==y&&h[g].items.push({dummy:!0})}h[g]=h[g]||{order:f++,id:g,items:[],dataItems:[],consumableData:{}},h[g].dataItems.push(p.data),h[g].items.push(p)}var m=Object.keys(h).map((function(t){return h[t].consumableData=C({points:h[t].dataItems},h[t].dataItems[0]),h[t]})),x={items:m.map((function(t){return t.consumableData}))},b=n.layers||{};return{coordinates:l,metaLayers:m,layers:i.resolve({data:x,defaults:{curve:Yh.layers.curve,show:Yh.layers.show},settings:{curve:b.curve,show:b.show}}),lines:i.resolve({data:x,defaults:M({},Yh.layers.line,a.line),settings:b.line}),areas:i.resolve({data:x,defaults:M({},Yh.layers.area,a.area),settings:b.area})}}(t),n=e.metaLayers,r=e.coordinates,i=e.layers,a=e.lines,o=e.areas,s=[];return n.forEach((function(e,n){var u=i.items[n];if(!1!==u.show){u.datum=u.data,u.data=[],u.id=e.id;for(var l,c,h=[],f=[],d=0;d<e.items.length;d++){if(c=(l=e.items[d]).data,!l.dummy){if(isNaN(l.major))continue;t.missingMinor0&&(l.minor0=r.settings.minor.scale?r.settings.minor.scale(c.minor0?c.minor0.value:0):0),isNaN(l.minor)||h.push(l.minor),u.data.push(l.data)}f.push(l)}var p=h.sort((function(t,e){return t-e}))[Math.floor((h.length-1)/2)];s.push({layerObj:u,lineObj:a.items[n],areaObj:o.items[n],median:p,points:f,consumableData:e.consumableData})}})),s}var Gh={require:["chart","resolver"],defaultSettings:{style:{area:"$shape",line:"$shape-outline"}},created:function(){},render:function(t){var e=t.data,n=this.rect,r=n.width,i=n.height;this.stngs=this.settings.settings||{};var a=!this.stngs.coordinates||void 0===this.stngs.coordinates.minor0,o=Kh({data:e,stngs:this.stngs,rect:this.rect,resolver:this.resolver,style:this.style,missingMinor0:a,domain:this.stngs.coordinates&&this.stngs.coordinates.major&&this.stngs.coordinates.major.scale?this.chart.scale(this.stngs.coordinates.major.scale).domain():[]});if(this.stngs.layers&&this.stngs.layers.sort){var s=o.map((function(t){return{id:t.layerObj.id,data:t.layerObj.data}})).sort(this.stngs.layers.sort).map((function(t){return t.id}));o.sort((function(t,e){return s.indexOf(t.layerObj.id)-s.indexOf(e.layerObj.id)}))}else o.sort((function(t,e){return t.median-e.median}));return function(t,e){var n=e.width,r=e.height,i=e.missingMinor0,a=e.stngs,o=[],s=a.layers||{};return t.forEach((function(t){var e,u,l=t.lineObj,c=t.layerObj,h=t.areaObj,f=t.points,d=jt(),p=a.coordinates?a.coordinates.defined:null,g={size:r,p:"y"},v={size:n,p:"x"};if("vertical"===a.orientation){var y=M(!0,{},v);v=M(!0,{},g),g=M(!0,{},y)}d[v.p]((function(t){return t.major*v.size}))["".concat(g.p,"1")]((function(t){return t.minor*g.size}))["".concat(g.p,"0")]((function(t){return t.minor0*g.size})).curve(Uh["monotone"===c.curve?"monotone".concat(v.p):c.curve]),p?d.defined((function(t){return!t.dummy&&"number"==typeof t.minor&&!isNaN(t.minor)&&t.defined})):d.defined((function(t){return!t.dummy&&"number"==typeof t.minor&&!isNaN(t.minor)}));var m=a.connect?f.filter(d.defined()):f;e=d["line".concat(g.p.toUpperCase(),"1")](),u=d["line".concat(g.p.toUpperCase(),"0")](),s.area&&!1!==h.show&&o.push(Xh(m,{data:t.consumableData,item:h,generator:d})),l&&!1!==l.show&&(o.push(Xh(m,{data:t.consumableData,item:l,generator:e},"none")),!i&&s.area&&!1!==h.show&&!1!==l.showMinor0&&o.push(Xh(m,{data:t.consumableData,item:l,generator:u},"none")))})),o}(o,{width:r,height:i,missingMinor0:a,stngs:this.stngs})}};function Zh(t,e){var n,r,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"object"===R(e.center)?(n=e.center.x,r=e.center.y):(n=e.clientX,r=e.clientY);var a=n-t.state.boundingRect.left,o=r-t.state.boundingRect.top;return{x:i?Math.max(0,Math.min(a,t.rect.width)):a,y:i?Math.max(0,Math.min(o,t.rect.height)):o}}function Jh(t,e){return{x:e.x+t.rect.x,y:e.y+t.rect.y}}function Qh(t,e){var n=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return{x:n,y:r,width:Math.max(t.x,e.x)-n,height:Math.max(t.y,e.y)-r}}var tf={require:["chart","renderer"],defaultSettings:{layout:{displayOrder:99},settings:{brush:{components:[]}},style:{area:"$selection-area-target"}},on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaCancel:function(){this.cancel()}},created:function(){this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1}},preferredSize:function(){return 0},render:function(){},start:function(t){this.state.boundingRect=this.renderer.element().getBoundingClientRect();var e=Zh(this,t,!1);Is({x:0,y:0,width:this.rect.width,height:this.rect.height},e)&&(this.state.brushConfig=function(t){return t.settings.brush.components.map((function(t){return{key:t.key,contexts:t.contexts,data:t.data,action:t.action||"set"}}))}(this.settings),this.state.start=Zh(this,t),this.state.active=!0)},move:function(t){var e;this.state.active&&(this.state.end=Zh(this,t),function(t){if(t.state.active){var e=Jh(t,t.state.start),n=Jh(t,t.state.end),r=t.chart.shapesAt(Qh(e,n),{components:t.state.brushConfig});t.chart.brushFromShapes(r,{components:t.state.brushConfig})}}(this),(e=this).renderer.render([M({type:"rect"},Qh(e.state.start,e.state.end),e.style.area)]))},end:function(){this.state.active&&(this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach((function(t){Array.isArray(t.contexts)&&t.contexts.forEach((function(t){e.brush(t).end()}))})),this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))}};function ef(t,e,n){var r=n.renderer,i=n.style,a=n.props,o=n.h,s=function(t,e){return{tooltip:"function"==typeof t.tooltipClass?t.tooltipClass({dock:e.dock}):t.tooltipClass,content:"function"==typeof t.contentClass?t.contentClass({dock:e.dock}):t.contentClass,arrow:"function"==typeof t.arrowClass?t.arrowClass({dock:e.dock}):t.arrowClass}}(a,e),u=function(t,e,n,r){return r.content({h:t,style:n,data:e})}(o,t,i,a),l=o("div",{dir:a.direction,class:Dh(M({"pic-tooltip":!0},s.tooltip)),style:M({position:"relative",display:"inline-block"},e.computedTooltipStyle)},o("div",{style:i.content,class:Dh(M({"pic-tooltip-content":!0},s.content))},u),o("div",{class:Dh(M({"pic-tooltip-arrow":!0},s.arrow)),style:M({},i.arrow,i["arrow-".concat(e.dock)],e.computedArrowStyle)}));return r.render(l),r.element().children[0]}function nf(t){var e=t.defaultDuration,n=t.defaultDelay,r=null,i=null,a=!1,o=function(){var t=function(){},e={pending:[],debounced:[],active:[],cancelled:[],rejected:[],fulfilled:[]};return t.set=function(t){e[t].forEach((function(e){return e(t)}))},t.on=function(t,n){Array.isArray(t)?t.forEach((function(t){return e[t].push(n)})):e[t].push(n)},t.destroy=function(){Object.keys(e).forEach((function(t){e[t].length=0}))},t}(),s=function(){},u=function(){r=null,i=null,a=!1,o.set("fulfilled")};return s.invoke=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;r&&(clearTimeout(r),o.set("debounced")),o.set("pending"),r=setTimeout((function(){t(),a=!0,r=null,o.set("active")}),l),s>0&&(i&&clearTimeout(i),i=setTimeout(u,s+Math.max(l,0)))},s.clear=function(){a?o.set("cancelled"):r&&(clearTimeout(r),o.set("rejected")),i&&clearTimeout(i),r=null,i=null,a=!1},s.on=function(t,e){o.on(t,e)},s.destroy=function(){s.clear(),o.destroy()},s}function rf(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{left:"translate(-100%,-50%) translateX(".concat(-t,"px)"),right:"translate(".concat(t,"px, -50%)"),top:"translate(-50%, -100%) translateY(".concat(-t,"px)"),bottom:"translate(-50%, ".concat(t,"px)")}}function af(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{left:{x:-t-n,y:-e/2},right:{x:n,y:-e/2},top:{x:-t/2,y:-e-n},bottom:{x:-t/2,y:n}}}function of(t){return{left:{left:"100%",top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},right:{left:"".concat(2*-t,"px"),top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},top:{left:"calc(50% - ".concat(t,"px)"),top:"100%",borderWidth:"".concat(t,"px")},bottom:{left:"calc(50% - ".concat(t,"px)"),top:"".concat(2*-t,"px"),borderWidth:"".concat(t,"px")}}}function sf(t,e,n,r,i,a){var o=e+a.x,s=n+a.y,u=i;return!(o<0||s<0)&&!(o+r>t.width||s+u>t.height)}function uf(t){var e=t.area,n=t.vx,r=t.vy,i=t.width,a=t.height,o=t.offset,s=n+o.x,u=r+o.y,l=i,c=a,h=s<0?-s:0,f=u<0?-u:0;return{x:h+=s+l>e.width?-(s+l-e.width):0,y:f+=u+c>e.height?-(u+c-e.height):0}}function lf(t){var e=t.options,n=t.pointer,r=t.width,i=t.height,a=t.dockOrder,o=t.x,s=t.y,u=n.targetBounds,l=rf(e.offset),c=l[e.dock];if(c)return{computedTooltipStyle:{left:"".concat(o,"px"),top:"".concat(s,"px"),transform:c},computedArrowStyle:of(e.offset)[e.dock],dock:e.dock};for(var h={width:"target"===e.area?u.width:window.innerWidth,height:"target"===e.area?u.height:window.innerHeight},f=af(r,i,e.offset),d=[],p="target"===e.area?o:u.left+o,g="target"===e.area?s:u.top+s,v=0;v<a.length;v+=1){var y=a[v],m=uf({area:h,vx:p,vy:g,width:r,height:i,offset:f[y]}),x={left:"".concat(o,"px"),top:"".concat(s,"px"),transform:l[y]},b=of(e.offset)[y];0!==m.x&&(x.width="".concat(r-20-Math.abs(m.x),"px"),"top"!==y&&"bottom"!==y||(x.left="".concat(o+m.x,"px"),b.left="calc(50% ".concat(m.x>0?"-":"+"," ").concat(Math.abs(m.x),"px)")));var w={computedTooltipStyle:x,computedArrowStyle:b,dock:y,rect:{width:r,height:i}};if(0===m.x&&0===m.y)return w;w.offset=m,d.push(w)}return d.sort((function(t,e){return Math.abs(t.offset.x)-Math.abs(e.offset.x)})),d[0]}function cf(t,e,n){var r=t.key?n.component(t.key):n.componentsFromPoint({x:e.clientX,y:e.clientY})[0];if(!r)return{x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};var i=r.rect;return M({scaleRatio:i.scaleRatio},i.computedInner)}var hf,ff={bounds:function(t){var e=t.resources,n=t.nodes,r=t.pointer,i=t.width,a=t.height,o=t.options,s=r.targetBounds,u=e.getNodeBoundsRelativeToTarget(n[0]),l=u.x,c=u.y,h=u.width,f=u.height,d={left:{x:l,y:c+f/2},right:{x:l+h,y:c+f/2},top:{x:l+h/2,y:c},bottom:{x:l+h/2,y:c+f}},p=rf(o.offset),g=p[o.dock];if(g)return{computedTooltipStyle:{left:"".concat(d[o.dock].x,"px"),top:"".concat(d[o.dock].y,"px"),transform:g},computedArrowStyle:of(o.offset)[o.dock],dock:o.dock};for(var v={width:"target"===o.area?s.width:window.innerWidth,height:"target"===o.area?s.height:window.innerHeight},y=af(i,a,o.offset),m=["top","left","right","bottom"],x=0;x<m.length;x+=1){var b=m[x];if(sf(v,"target"===o.area?d[b].x:s.left+d[b].x,"target"===o.area?d[b].y:s.top+d[b].y,i,a,y[b]))return{computedTooltipStyle:{left:"".concat(d[b].x,"px"),top:"".concat(d[b].y,"px"),transform:p[b]},computedArrowStyle:of(o.offset)[b],dock:b}}return{computedTooltipStyle:{left:"".concat(d.top.x,"px"),top:"".concat(d.top.y,"px"),transform:p.top},computedArrowStyle:of(o.offset).top,dock:"top"}},pointer:function(t){var e=t.options,n=t.pointer,r=t.width,i=t.height;return lf({x:n.x,y:n.y,pointer:n,width:r,height:i,options:e,dockOrder:["top","left","right","bottom"]})},slice:function(t){var e=t.options,n=t.pointer,r=t.width,i=t.height,a=t.nodes,o=t.resources,s=a[0],u=n.dx,l=n.dy,c=o.getComponentBoundsFromNode(s),h=u+c.x+c.width/2,f=l+c.y+c.height/2,d=s.desc.slice,p=d.start,g=d.end,v=d.outerRadius,y=(p+g)/2-Math.PI/2,m=2*Math.PI,x=(y%m+m)%m,b=["top","left","right","bottom"];return"auto"===e.dock&&(b=x<=Math.PI/4||x>=7*Math.PI/4?["right","top","bottom","left"]:x<=3*Math.PI/4?["bottom","left","right","top"]:x<=5*Math.PI/4?["left","top","bottom","right"]:["top","left","right","bottom"]),lf({x:h+v*c.scaleRatio.x*Math.cos(x),y:f+v*c.scaleRatio.y*Math.sin(x),pointer:n,width:r,height:i,options:e,dockOrder:b})}};function df(t,e){var n=t.width,r=t.height,i=e.chart,a=e.state,o=e.props,s={resources:{formatter:i.formatter,scale:i.scale,component:i.component,getComponentBoundsFromNode:function(t){return cf(t,a.pointer,i)},getNodeBoundsRelativeToTarget:function(t){return function(t,e,n){var r=cf(t,e,n),i=t.bounds;return{x:r.x+e.dx+i.x,y:r.y+e.dy+i.y,width:i.width,height:i.height}}(t,a.pointer,i)}},nodes:a.activeNodes,pointer:a.pointer,width:n,height:r},u=R(o.placement);if("object"===u&&"function"==typeof o.placement.fn)return o.placement.fn(s);var l={type:"pointer",offset:8,dock:"auto",area:"viewport"};"function"===u&&(l=M(l,o.placement(s))),"object"===u&&ff[o.placement.type]?l=M(l,o.placement):"string"===u&&ff[o.placement]&&(l=M(l,{type:o.placement})),s.options=l;var c=ff[l.type](s),h=s.resources.getComponentBoundsFromNode(s.nodes[0]),f=h.x,d=h.y,p=h.width,g=h.height;return p+=f+=s.pointer.dx,g+=d+=s.pointer.dy,c.computedTooltipStyle.left="".concat(Math.min(Math.max(0,f,parseFloat(c.computedTooltipStyle.left)),p),"px"),c.computedTooltipStyle.top="".concat(Math.min(Math.max(0,d,parseFloat(c.computedTooltipStyle.top)),g),"px"),c}function pf(){hf=null}function gf(t,e){var n=e.chart,r=e.state,i=0,a=0;t.center?(i+=t.center.x,a+=t.center.y):(i+=t.clientX,a+=t.clientY);var o=n.element.getBoundingClientRect(),s=r.targetElement.getBoundingClientRect(),u=i,l=a,c=o.left-s.left,h=o.top-s.top,f=i-o.left,d=a-o.top;return{x:i-=s.left,y:a-=s.top,dx:c,dy:h,cx:f,cy:d,clientX:u,clientY:l,targetBounds:s,chartBounds:o}}var vf={require:["chart","renderer"],defaultSettings:{settings:{duration:8e3,delay:500,filter:function(t){return t.filter((function(t){return t.data&&void 0!==t.data.value}))},extract:function(t){return t.node.data.value},content:function(t){var e=t.h;return t.data.map((function(t){return e("div",{},t)}))},isEqual:function(t,e){return t.length&&t.length===e.length&&t.every((function(t,n){return e[n]&&JSON.stringify(t.data)===JSON.stringify(e[n].data)}))},placement:{type:"pointer",dock:"auto",offset:8,area:"viewport"},tooltipClass:{},contentClass:{},arrowClass:{},direction:"ltr",appendTo:void 0,beforeShow:void 0,afterShow:void 0,beforeHide:void 0,onHide:void 0,afterHide:void 0},style:{tooltip:{},content:{backgroundColor:"$gray-25",color:"$font-color--inverted",fontFamily:"$font-family",fontSize:"$font-size",lineHeight:"$line-height",borderRadius:"4px",padding:"8px",opacity:.9},arrow:{position:"absolute",width:"0px",height:"0px",borderStyle:"solid",color:"$gray-25",opacity:.9},"arrow-bottom":{borderTopColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-top":{borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-right":{borderTopColor:"transparent",borderLeftColor:"transparent",borderBottomColor:"transparent"},"arrow-left":{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightColor:"transparent"}}},renderer:"dom",on:{hide:function(){this.hide()},show:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.show(t,e)},prevent:function(t){this.prevent(t)}},hide:function(){this.dispatcher.clear(),this.state.activeNodes=[],this.state.pointer={}},show:function(t){var e,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.nodes,a=r.duration,o=r.delay;!this.state.prevent&&this.state.targetElement&&(this.state.pointer=gf(t,this),e=Array.isArray(i)?this.props.filter(i):this.props.filter(this.chart.shapesAt({x:this.state.pointer.cx,y:this.state.pointer.cy})),this.props.isEqual(this.state.activeNodes,e)||(this.dispatcher.clear(),this.state.activeNodes=e,this.state.activeNodes.length&&this.dispatcher.invoke((function(){return n.invokeRenderer(n.state.activeNodes)}),a,o)))},prevent:function(t){this.state.prevent=!!t},init:function(t){var e=this;this.state={activeNodes:[],pointer:{},targetElement:null,prevent:!1},this.props=t.settings,this.dispatcher=nf({defaultDuration:this.props.duration,defaultDelay:this.props.delay});var n=this.dispatcher.clear;this.dispatcher.on("pending",(function(){!function(t){hf&&hf!==t&&hf()}(n),hf=n,"function"==typeof e.props.beforeShow&&e.props.beforeShow.call(void 0,{resources:{formatter:e.chart.formatter,scale:e.chart.scale}})})),this.dispatcher.on(["cancelled","fulfilled"],(function(){var t={resources:{formatter:e.chart.formatter,scale:e.chart.scale}};"function"==typeof e.props.beforeHide&&e.props.beforeHide.call(void 0,M({element:e.state.tooltipElm},t)),"function"==typeof e.props.onHide?e.props.onHide.call(void 0,M({element:e.state.tooltipElm},t)):e.renderer.clear([]),"function"==typeof e.props.afterHide&&e.props.afterHide.call(void 0,t),hf===n&&(hf=null),e.state.tooltipElm=void 0})),this.dispatcher.on("active",(function(){"function"==typeof e.props.afterShow&&e.props.afterShow.call(void 0,{element:e.state.tooltipElm,resources:{formatter:e.chart.formatter,scale:e.chart.scale}})}))},created:function(){this.init(this.settings)},beforeUpdate:function(t){var e=t.settings;this.dispatcher&&(this.dispatcher.destroy(),pf()),this.init(e)},render:function(t){return this.h=t,[]},beforeDestroy:function(){this.dispatcher.destroy(),pf()},appendTo:function(){if(this.props.appendTo){this.state.targetElement="function"==typeof this.props.appendTo?this.props.appendTo({resources:{formatter:this.chart.formatter,scale:this.chart.scale}}):this.props.appendTo;var t=this.state.targetElement.getBoundingClientRect(),e=t.width,n=t.height;this.renderer.destroy(),this.renderer.size({width:e,height:n}),this.renderer.appendTo(this.state.targetElement)}else this.state.targetElement=this.renderer.element()},mounted:function(){this.appendTo()},updated:function(){this.appendTo()},invokeRenderer:function(t){var e=function(t,e){var n=e.chart,r=e.scale,i=e.props,a=e.h,o={resources:{dataset:n.dataset,scale:n.scale,formatter:n.formatter},scale:r,h:a},s=[];return t.forEach((function(t){if("function"==typeof i.extract){var e=M({node:t},o);s.push(i.extract(e))}})),s}(t,this),n=df(ef(e,{style:{left:"0px",top:"0px",visibility:"hidden"}},this).getBoundingClientRect(),this);this.state.tooltipElm=ef(e,n,this)}};var yf={require:["renderer","chart"],defaultSettings:{settings:{target:"",selector:"*",fill:"rgba(0, 255, 0, 0.1)",stroke:"lime",opacity:1,useOuterRect:!1}},on:{update:function(){this.draw()}},draw:function(){var t=this,e=this.chart.findShapes(this.props.selector).filter((function(e){return e.key===t.props.target})).filter((function(t){return t.collider})).map((function(t){return t.collider}));e.forEach((function(e){e.fill=t.props.fill,e.stroke=t.props.stroke,e.opacity=t.props.opacity,e.collider={type:null}})),this.renderer.render(e)},created:function(){this.props=this.settings.settings},resize:function(t){var e=t.outer,n=t.inner;return this.props.useOuterRect?e:n},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}},mf=2*Math.PI;function xf(t,e,n,r){return Math.abs(t.x+n.x-(e.x+e.x))+Math.abs(t.y+n.y-(e.y+e.y))+Math.abs(e.x+r.x-(n.x+n.x))+Math.abs(e.y+r.y-(n.y+n.y))}function bf(t,e){return{x:.5*(t.x+e.x),y:.5*(t.y+e.y)}}function wf(t,e,n,r,i){var a=1-t;return Math.pow(a,3)*e+3*Math.pow(a,2)*t*n+3*a*Math.pow(t,2)*r+Math.pow(t,3)*i}function kf(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8;if(a<1||xf(t,e,n,r)<=10)return i[i.length-1]!==t&&i.push(t),i.push(r),i;var o=.5,s=bf(t,e),u=bf(e,n),l=bf(n,r),c={x:wf(o,t.x,e.x,n.x,r.x),y:wf(o,t.y,e.y,n.y,r.y)},h=bf(s,u),f=bf(u,l);return kf(t,s,h,c,i,a-1),kf(c,f,l,r,i,a-1),i}function Mf(t,e,n){var r=function(t,e,n){return{cp1:{x:t.x+2/3*(e.x-t.x),y:t.y+2/3*(e.y-t.y)},cp2:{x:n.x+2/3*(e.x-n.x),y:n.y+2/3*(e.y-n.y)}}}(t,e,n);return kf(t,r.cp1,r.cp2,n)}function _f(t,e,n){var r,i,a,o,s=[],u=!!t[4],l=!!t[5],c=t[3],h=t[6],f=t[7],d=t[1],p=t[2];if("a"===t[0]&&(h+=e,f+=n),e===f&&n===f)return s;if(!d||!p)return s.push({x:h,y:f}),s;var g=function(t,e,n,r,i,a,o,s,u){var l,c,h,f,d,p,g=Ko(n%360),v=Math.cos(g),y=Math.sin(g),m=(s-a)/2,x=(u-o)/2,b=v*m+y*x,w=v*x-y*m;t=Math.abs(t),e=Math.abs(e),(p=Math.pow(b,2)/Math.pow(t,2)+Math.pow(w,2)/Math.pow(e,2))>1&&(t*=p=Math.sqrt(p),e*=p);var k=t*e,M=t*w,_=e*b,S=Math.pow(M,2)+Math.pow(_,2),C=Math.pow(k,2)-S,R=Math.sqrt(Math.max(C/S,0));r===i&&(R=-R);var q=R*(M/e),N=R*(-_/t);f=v*q-y*N+(s+a)/2,d=y*q+v*N+(u+o)/2;var A=(b-q)/t,D=(w-N)/e,O=(-b-q)/t,E=(-w-N)/e;return l=Math.atan2(D,A),l+=l<0?mf:0,c=Math.atan2(E,O),h=(c+=c<0?mf:0)-l,!i&&l<c?h-=mf:i&&c<l&&(h+=mf),{startAngle:l,sweepAngle:h%=mf,cx:f,cy:d,rx:t,ry:e}}(d,p,c,u,l,h,f,e,n);r=g.cx,i=g.cy,d=g.rx,p=g.ry,a=g.sweepAngle,o=g.startAngle;for(var v=Math.abs(a*Math.sqrt((Math.pow(d,2)+Math.pow(p,2))/2)),y=Math.ceil(v/10),m=a/y,x=1;x<=y;x++){var b=(o+m*x)%mf,w=Math.cos(b),k=Math.sin(b);s.push({x:r+w*d+-k*w,y:i+k*p+w*k})}return s}function Sf(t){for(var e=p.parsePath(t),n=[],r=[],i=0,a=0,o=null,s=null,u=null,l=null,c=0;c<e.length;++c){var h=e[c],f=h[0];switch("S"!==f&&"s"!==f&&"C"!==f&&"c"!==f&&(o=null,s=null),"T"!==f&&"t"!==f&&"Q"!==f&&"q"!==f&&(u=null,l=null),f){case"m":r.length&&n.push(r.splice(0));case"l":i+=h[1],a+=h[2],r.push({x:i,y:a});break;case"M":r.length&&n.push(r.splice(0));case"L":i=h[1],a=h[2],r.push({x:i,y:a});break;case"H":i=h[1],r.push({x:i,y:a});break;case"h":i+=h[1],r.push({x:i,y:a});break;case"V":a=h[1],r.push({x:i,y:a});break;case"v":a+=h[1],r.push({x:i,y:a});break;case"a":r.push.apply(r,$(_f(h,i,a))),i+=h[6],a+=h[7];break;case"A":r.push.apply(r,$(_f(h,i,a))),i=h[6],a=h[7];break;case"c":r.push.apply(r,$(kf({x:i,y:a},{x:h[1]+i,y:h[2]+a},{x:h[3]+i,y:h[4]+a},{x:h[5]+i,y:h[6]+a}))),o=h[3]+i,s=h[4]+a,i+=h[5],a+=h[6];break;case"C":r.push.apply(r,$(kf({x:i,y:a},{x:h[1],y:h[2]},{x:h[3],y:h[4]},{x:h[5],y:h[6]}))),o=h[3],s=h[4],i=h[5],a=h[6];break;case"s":null!==o&&null!==o||(o=i,s=a),r.push.apply(r,$(kf({x:i,y:a},{x:2*i-o,y:2*a-s},{x:h[1]+i,y:h[2]+a},{x:h[3]+i,y:h[4]+a}))),o=h[1]+i,s=h[2]+a,i+=h[3],a+=h[4];break;case"S":null!==o&&null!==o||(o=i,s=a),r.push.apply(r,$(kf({x:i,y:a},{x:2*i-o,y:2*a-s},{x:h[1],y:h[2]},{x:h[3],y:h[4]}))),o=h[1],s=h[2],i=h[3],a=h[4];break;case"Q":r.push.apply(r,$(Mf({x:i,y:a},{x:h[1],y:h[2]},{x:h[3],y:h[4]}))),u=h[1],l=h[2],i=h[3],a=h[4];break;case"q":r.push.apply(r,$(Mf({x:i,y:a},{x:h[1]+i,y:h[2]+a},{x:h[3]+i,y:h[4]+a}))),u=h[1]+i,l=h[2]+a,i+=h[3],a+=h[4];break;case"T":null!==u&&null!==u||(u=i,l=a),u=2*i-u,l=2*a-l,r.push.apply(r,$(Mf({x:i,y:a},{x:u,y:l},{x:h[1],y:h[2]}))),i=h[1],a=h[2];break;case"t":null!==u&&null!==u||(u=i,l=a),u=2*i-u,l=2*a-l,r.push.apply(r,$(Mf({x:i,y:a},{x:u,y:l},{x:h[1]+i,y:h[2]+a}))),i+=h[1],a+=h[2];break;case"z":case"Z":r.length&&r.push({x:r[0].x,y:r[0].y})}}return function(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];Math.abs(n.x-r.x)<1e-12&&Math.abs(n.y-r.y)<1e-12&&(t.splice(e,1),e--)}}(r),n.push(r.splice(0)),n}var Cf={require:["renderer","chart"],defaultSettings:{settings:{target:"",fill:"transparent",stroke:"lime",opacity:1,radius:2,useOuterRect:!1}},on:{update:function(){this.draw()}},draw:function(){var t=this,e=this.chart.findShapes("path").filter((function(e){return e.key===t.props.target})),n=[];e.forEach((function(e){Sf(e.attrs.d).forEach((function(e){e.forEach((function(e){n.push({type:"circle",cx:e.x,cy:e.y,r:t.props.radius,fill:t.props.fill,stroke:t.props.stroke,opacity:t.props.opacity,collider:{type:null}})}))}))})),this.renderer.render(n)},created:function(){this.props=this.settings.settings},resize:function(t){var e=t.outer,n=t.inner;return this.props.useOuterRect?e:n},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}};var Rf=[function(t){t.component("box",Pu),t.component("box-marker",Pu)},function(t){t.component("point",Wu),t.component("point-marker",Wu)},function(t){t.component("pie",Xu)},function(t){t.component("grid-line",Qu)},function(t){t.component("ref-line",ol)},function(t){t.component("axis",ql)},function(t){t.component("container",Nl)},function(t){t.component("text",Ol)},function(t){t.component("scrollbar",Tl)},function(t){t.component("brush-range",Gl),t.component("brush-area-dir",Ql)},function(t){t.component("range",rc)},function(t){t.component("brush-lasso",lc)},function(t){t.component("labels",Ch)},function(t){t.component("legend-cat",Fh)},function(t){t.component("legend-seq",Vh)},function(t){t.component("line",Gh)},function(t){t.component("brush-area",tf)},function(t){t.component("tooltip",vf)},function(t){t.component("debug-collider",yf)},function(t){t.component("debug-path-to-points",Cf)}],qf=function(){function t(e){q(this,t),this._parent=null,this._children=[],this._ancestors=null,this.type=e,this.data=null}return A(t,[{key:"detach",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"parent",get:function(){return this._parent}},{key:"isBranch",get:function(){return this._children&&this._children.length}},{key:"children",get:function(){return this._children}},{key:"ancestors",get:function(){var t;this._ancestors||(this._ancestors=[],this.parent&&(t=this._ancestors).push.apply(t,[this.parent].concat($(this.parent.ancestors))));return this._ancestors}},{key:"descendants",get:function(){var t,e,n=[],r=this.children.length;for(t=0;t<r;t++)e=this.children[t],n.push(e),e.children.length&&(n=[].concat($(n),$(e.descendants)));return n}},{key:"equals",value:function(t){var e=this.children,n=t.children;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(n[r]))return!1;return!0}},{key:"toJSON",value:function(){return{type:this.type,children:this.children.map((function(t){return t.toJSON()}))}}}]),t}(),Nf=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x,r=void 0===n?0:n,i=e.y,a=void 0===i?0:i,o=e.width,s=void 0===o?0:o,u=e.height,l=void 0===u?0:u,c=e.minWidth,h=void 0===c?0:c,f=e.minHeight,d=void 0===f?0:f;q(this,t),this.set({x:r,y:a,width:s,height:l,minWidth:h,minHeight:d})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,a=t.width,o=void 0===a?0:a,s=t.height,u=void 0===s?0:s,l=t.minWidth,c=void 0===l?0:l,h=t.minHeight,f=void 0===h?0:h;this.type="rect",o>=0?(this.x=n,this.width=Math.max(o,c)):(this.x=n+Math.min(o,-c),this.width=-Math.min(o,-c)),u>=0?(this.y=i,this.height=Math.max(u,f)):(this.y=i+Math.min(u,-f),this.height=-Math.min(u,-f))}},{key:"containsPoint",value:function(t){return Is(this,t)}},{key:"intersectsLine",value:function(t){return Ts(this,tt(t))}},{key:"intersectsRect",value:function(t){return Os(this,Q(t))}},{key:"intersectsCircle",value:function(t){return Cs(t,this)}},{key:"intersectsPolygon",value:function(t){return Ds(t,this)}},{key:"intersectsGeoPolygon",value:function(t){return $s(t,this)}},{key:"points",value:function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]}}]),t}();var Af=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cx,r=void 0===n?0:n,i=e.cy,a=void 0===i?0:i,o=e.r,s=void 0===o?0:o,u=e.minRadius,l=void 0===u?0:u;q(this,t),this.set({cx:r,cy:a,r:s,minRadius:l})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,r=t.cy,i=void 0===r?0:r,a=t.r,o=void 0===a?0:a,s=t.minRadius,u=void 0===s?0:s;this.type="circle",this.cx=n,this.cy=i,this.r=Math.max(o,u),this.vector={x:this.cx,y:this.cy}}},{key:"containsPoint",value:function(t){return Ss(this,t)}},{key:"intersectsLine",value:function(t){return Rs(this,tt(t))}},{key:"intersectsRect",value:function(t){return Cs(this,Q(t))}},{key:"intersectsCircle",value:function(t){return function(t,e){if(ws(t)||ws(e))return!1;var n=t.cx-e.cx,r=t.cy-e.cy;return Math.pow(n,2)+Math.pow(r,2)<=Math.pow(t.r+e.r,2)}(this,t)}},{key:"intersectsPolygon",value:function(t){return qs(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return Ls(this,t)}},{key:"points",value:function(){return[{x:this.cx,y:this.cy}]}}]),t}();var Df=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x1,r=void 0===n?0:n,i=e.y1,a=void 0===i?0:i,o=e.x2,s=void 0===o?0:o,u=e.y2,l=void 0===u?0:u,c=e.tolerance,h=void 0===c?0:c;q(this,t),this.set({x1:r,y1:a,x2:s,y2:l,tolerance:h})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,r=t.y1,i=void 0===r?0:r,a=t.x2,o=void 0===a?0:a,s=t.y2,u=void 0===s?0:s,l=t.tolerance,c=void 0===l?0:l;this.type="line",this.x1=n,this.y1=i,this.x2=o,this.y2=u,this.tolerance=Math.max(0,Math.round(c)),this.vectors=this.points(),this.zeroSize=n===o&&i===u}},{key:"containsPoint",value:function(t){return this.tolerance>0?Rs({cx:t.x,cy:t.y,r:this.tolerance},this):Ps(this,t)}},{key:"intersectsLine",value:function(t){return js(this,tt(t))}},{key:"intersectsRect",value:function(t){return Ts(Q(t),this)}},{key:"intersectsCircle",value:function(t){return Rs(t,this)}},{key:"intersectsPolygon",value:function(t){return As(t,this)}},{key:"intersectsGeoPolygon",value:function(t){return Hs(t,this)}},{key:"points",value:function(){return[{x:this.x1,y:this.y1},{x:this.x2,y:this.y2}]}}]),t}();function Of(t){var e=t[0],n=t[t.length-1];e.x===n.x&&e.y===n.y||t.push(e)}function Ef(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];n.x===r.x&&n.y===r.y&&(t.splice(e,1),e--)}}var If=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vertices,r=void 0===n?[]:n;q(this,t),this.set({vertices:r})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertices,n=void 0===e?[]:e;if(this.type="polygon",this.vertices=n.slice(),this.edges=[],Ef(this.vertices),!(this.vertices.length<=2)){Of(this.vertices),this.xMin=NaN,this.yMin=NaN,this.xMax=NaN,this.yMax=NaN;for(var r=0;r<this.vertices.length;r++)r<this.vertices.length-1&&this.edges.push([this.vertices[r],this.vertices[r+1]]),this.xMin=isNaN(this.xMin)?this.vertices[r].x:Math.min(this.xMin,this.vertices[r].x),this.xMax=isNaN(this.xMax)?this.vertices[r].x:Math.max(this.xMax,this.vertices[r].x),this.yMin=isNaN(this.yMin)?this.vertices[r].y:Math.min(this.yMin,this.vertices[r].y),this.yMax=isNaN(this.yMax)?this.vertices[r].y:Math.max(this.yMax,this.vertices[r].y);this._bounds=null,this._boundingRect=null}}},{key:"containsPoint",value:function(t){return Ns(this,t)}},{key:"intersectsCircle",value:function(t){return qs(t,this)}},{key:"intersectsLine",value:function(t){return As(this,tt(t))}},{key:"intersectsRect",value:function(t){return Ds(this,Q(t))}},{key:"intersectsPolygon",value:function(t){return zs(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return Fs(t,this)}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){return this._bounds||(this._bounds=[{x:this.xMin,y:this.yMin},{x:this.xMax,y:this.yMin},{x:this.xMax,y:this.yMax},{x:this.xMin,y:this.yMax}]),this._bounds}},{key:"boundingRect",value:function(){return this._boundingRect||(this._boundingRect={x:this.xMin,y:this.yMin,width:this.xMax-this.xMin,height:this.yMax-this.yMin}),this._boundingRect}}]),t}();function Tf(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(If,e)}function jf(t){var e=t[0],n=t[t.length-1];e.x===n.x&&e.y===n.y||t.push(e)}function Pf(t){for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];n.x===r.x&&n.y===r.y&&(t.splice(e,1),e--)}}var zf=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vertices,r=void 0===n?[[]]:n;q(this,t),this.set({vertices:r})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertices,n=void 0===e?[]:e;this.type="geopolygon",this.vertices=n.slice(),this.numPolygons=this.vertices.length,this.polygons=[],this.xMin=NaN,this.yMin=NaN,this.xMax=NaN,this.yMax=NaN;for(var r=0;r<this.numPolygons;r++)Pf(this.vertices[r]),this.vertices[r].length>2&&jf(this.vertices[r]),this.polygons[r]=Tf({vertices:this.vertices[r]}),this.xMin=isNaN(this.xMin)?this.polygons[r].xMin:Math.min(this.xMin,this.polygons[r].xMin),this.xMax=isNaN(this.xMax)?this.polygons[r].xMax:Math.max(this.xMax,this.polygons[r].xMax),this.yMin=isNaN(this.yMin)?this.polygons[r].yMin:Math.min(this.yMin,this.polygons[r].yMin),this.yMax=isNaN(this.yMax)?this.polygons[r].yMax:Math.max(this.yMax,this.polygons[r].yMax);this._bounds=null,this._boundingRect=null}},{key:"containsPoint",value:function(t){return Bs(this,t)}},{key:"intersectsCircle",value:function(t){return Ls(t,this)}},{key:"intersectsLine",value:function(t){return Hs(this,tt(t))}},{key:"intersectsRect",value:function(t){return $s(this,Q(t))}},{key:"intersectsPolygon",value:function(t){return Fs(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return n=t,r=(e=this).boundingRect(),i=n.boundingRect(),!!Os(r,i)&&(Es(i,r)?_s(n,e):_s(e,n));var e,n,r,i}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){return this._bounds||(this._bounds=[{x:this.xMin,y:this.yMin},{x:this.xMax,y:this.yMin},{x:this.xMax,y:this.yMax},{x:this.xMin,y:this.yMax}]),this._bounds}},{key:"boundingRect",value:function(){return this._boundingRect||(this._boundingRect={x:this.xMin,y:this.yMin,width:this.xMax-this.xMin,height:this.yMax-this.yMin}),this._boundingRect}}]),t}();function Ff(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(zf,e)}function Lf(t,e){return t.x!==e.x||t.y!==e.y}var Bf=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.points,r=void 0===n?[]:n;q(this,t),this.set({points:r})}return A(t,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.points,n=void 0===e?[]:e;if(this.type="polyline",this.segments=[],this._points=n.slice(),this._points.length>1)for(var r=0,i=this._points.length-1;r<i;r++)Lf(this._points[r],this._points[r+1])&&this.segments.push({x1:this._points[r].x,y1:this._points[r].y,x2:this._points[r+1].x,y2:this._points[r+1].y})}},{key:"containsPoint",value:function(t){return this.segments.some((function(e){return Ps(e,t)}))}},{key:"intersectsCircle",value:function(t){return this.segments.some((function(e){return Rs(t,e)}))}},{key:"intersectsLine",value:function(t){var e=tt(t);return this.segments.some((function(t){return js(t,e)}))}},{key:"intersectsRect",value:function(t){var e=Q(t);return this.segments.some((function(t){return Ts(e,t)}))}},{key:"intersectsPolygon",value:function(t){return this.segments.some((function(e){return As(t,e)}))}},{key:"intersectsGeoPolygon",value:function(t){return this.segments.some((function(e){return Hs(t,e)}))}},{key:"points",value:function(){return this._points}}]),t}();var Hf=ue();function $f(t,e){return Hf.get(t)(e)}Hf.add("rect",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Nf,e)})),Hf.add("circle",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Af,e)})),Hf.add("line",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Df,e)})),Hf.add("polygon",Tf),Hf.add("geopolygon",Ff),Hf.add("polyline",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Bf,e)}));var Wf=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];q(this,t),this.set(e)}return A(t,[{key:"set",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.geometries=[],e.forEach((function(e){var n=$f(e.type,e);n&&t.geometries.push(n)}))}},{key:"containsPoint",value:function(t){return this.geometries.some((function(e){return e.containsPoint(t)}))}},{key:"intersectsLine",value:function(t){return this.geometries.some((function(e){return e.intersectsLine(t)}))}},{key:"intersectsRect",value:function(t){return this.geometries.some((function(e){return e.intersectsRect(t)}))}},{key:"intersectsCircle",value:function(t){return this.geometries.some((function(e){return e.intersectsCircle(t)}))}},{key:"intersectsPolygon",value:function(t){return this.geometries.some((function(e){return e.intersectsPolygon(t)}))}},{key:"intersectsGeoPolygon",value:function(t){return this.geometries.some((function(e){return e.intersectsGeoPolygon(t)}))}}]),t}();var Vf=function(){function t(){q(this,t),this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]}return A(t,[{key:"clone",value:function(){return(new t).multiply(this)}},{key:"set",value:function(t){return this._elements=t,this}},{key:"save",value:function(){return this._stack.push(this.elements),this}},{key:"restore",value:function(){return this._stack.length&&(this._elements=this._stack.pop()),this}},{key:"add",value:function(t){var e,n;for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)this._elements[e][n]+=t;return this}},{key:"translate",value:function(t,e){return this.multiply([[1,0,t],[0,1,e],[0,0,1]]),this}},{key:"rotate",value:function(t){var e=Math.cos(-t),n=Math.sin(-t);return this.multiply([[e,n,0],[-n,e,0],[0,0,1]]),this}},{key:"multiply",value:function(e){var n,r,i,a;if(e instanceof t&&(e=e._elements),Array.isArray(e)){for(i=[[0,0,0],[0,0,0],[0,0,0]],n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)for(a=0;a<3;a++)i[n][r]+=this._elements[n][a]*e[a][r];this._elements=i}else for(n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)this._elements[n][r]*=e;return this}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.multiply([[t,0,0],[0,e,0],[0,0,1]]),this}},{key:"transform",value:function(t,e,n,r,i,a){return this.multiply([[t,n,i],[e,r,a],[0,0,1]]),this}},{key:"determinant",value:function(){var t=this._elements[0][0],e=this._elements[0][1],n=this._elements[0][2],r=this._elements[1][0],i=this._elements[1][1],a=this._elements[1][2],o=this._elements[2][0],s=this._elements[2][1],u=this._elements[2][2];return t*i*u+e*a*o+n*r*s-n*i*o-e*r*u-t*a*s}},{key:"invert",value:function(){var t=this.determinant(),e=this._elements[0][0],n=this._elements[0][1],r=this._elements[0][2],i=this._elements[1][0],a=this._elements[1][1],o=this._elements[1][2],s=this._elements[2][0],u=this._elements[2][1],l=this._elements[2][2];return this._elements=[[a*l-o*u,r*u-n*l,n*o-r*a],[o*s-i*l,e*l-r*s,r*i-e*o],[i*u-a*s,s*n-e*u,e*a-n*i]],this.multiply(1/t),this}},{key:"transpose",value:function(){var t=Object.create(this._elements);return this._elements=[[t[0][0],t[1][0],t[2][0]],[t[0][1],t[1][1],t[2][1]],[t[0][2],t[1][2],t[2][2]]],this}},{key:"identity",value:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this}},{key:"toString",value:function(){return"".concat(this._elements.map((function(t){return t.join("\t")})).join("\n"))}},{key:"isIdentity",value:function(){var t=this._elements;return 1===t[0][0]&&0===t[0][1]&&0===t[0][2]&&0===t[1][0]&&1===t[1][1]&&0===t[1][2]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]}},{key:"transformPoint",value:function(t){var e,n,r=[t.x,t.y,1],i=this._elements,a=[0,0,0];for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)a[e]+=r[n]*i[e][n];return{x:a[0],y:a[1]}}},{key:"transformPoints",value:function(t){var e,n,r,i,a,o=this._elements,s=[];for(i=0;i<t.length;i++){for(e=[t[i].x,t[i].y,1],a=[0,0,0],n=0;n<this._elements.length;n++)for(r=0;r<this._elements[n].length;r++)a[n]+=e[r]*o[n][r];s.push({x:a[0],y:a[1]})}return s}},{key:"elements",get:function(){var t=this._elements;return[[t[0][0],t[0][1],t[0][2]],[t[1][0],t[1][1],t[1][2]],[t[2][0],t[2][1],t[2][2]]]}}]),t}(),Uf=/(translate|scale|rotate|matrix)\(([0-9,.eE+-\s]+)(?:,|\s?)+\)/g;function Yf(t,e){var n=e.args[0]*(Math.PI/180);if(e.args.length>2){var r=e.args[1],i=e.args[2];t.translate(r,i),t.rotate(n),t.translate(-r,-i)}else 1===e.args.length&&t.rotate(n)}function Xf(t,e){var n=e.args[0],r=isNaN(e.args[1])?e.args[0]:e.args[1];t.scale(n,r)}function Kf(t,e){var n=e.args[0],r=isNaN(e.args[1])?0:e.args[1];t.translate(n,r)}function Gf(t,e){e.args.length>=6&&t.transform.apply(t,$(e.args))}function Zf(t,e){for(var n,r=function(t){for(var e,n=[];null!==(e=Uf.exec(t));){var r=e[2].trim(),i=-1===r.indexOf(",")?r.split(" "):r.split(",");n.push({cmd:e[1],args:i.filter((function(t){return t.trim().length>0})).map((function(t){return Number(t)}))})}return n}(t),i=0,a=r.length;i<a;i++)"rotate"===(n=r[i]).cmd?Yf(e,n):"scale"===n.cmd?Xf(e,n):"matrix"===n.cmd?Gf(e,n):"translate"===n.cmd&&Kf(e,n)}var Jf={type:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/,universal:/^(\*)/,tag:/^\.(\w+)/},Qf={type:function(t,e){return e.filter((function(e){var n=e.type;return!!n&&n.toLowerCase()===t.toLowerCase()}))},attr:function(t,e,n,r){return r.filter((function(r){var i=r.attrs[t];if(!e)return void 0!==i;if(void 0===i)return!1;switch(e){case"=":return n===String(i);case"!=":return n!==String(i);default:return!1}}))},universal:function(t){return t},tag:function(t,e){return e.filter((function(e){var n=e.tag;return!!n&&-1!==n.trim().split(/\s+/).indexOf(t.replace(".",""))}))}};var td={find:function(t,e){var n,r,i=[],a=[];if(e.isBranch){var o;n=function(t){var e,n,r,i,a=[];return t.split(/\s*,\s*/).forEach((function(t){t=t.trim(),e=[];for(var o=function(a){(r=t.match(Jf[a]))&&(i=!0,t=t.slice(r[0].length),n={type:a,value:r[0]},"attr"===a&&(r=r[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),n.attribute=r[1],n.operator=r[2],n.attributeValue=r[3]),e.push(n))};t&&(i=!1,(r=t.match(/^\s*([>+~]|\s)\s*/))&&(i=!0,e.push({type:" ",value:r[0]}),t=t.slice(r[0].length)),Object.keys(Jf).forEach(o),e&&e.length&&a.indexOf(e)<0&&a.push(e),i););})),a}(t),r=e.descendants;for(var s=function(t,e){o=n[t];var i=[],s=r.slice(),u=!1;o.reverse().forEach((function(t){if(" "===t.type)return i.push(s),s=r.slice(),void(u=!1);s=function(t,e){if(!e||!e.length||!t||"function"!=typeof Qf[t.type])return[];switch(t.type){case"type":return Qf[t.type](t.value,e);case"attr":return Qf[t.type](t.attribute,t.operator,t.attributeValue,e);case"universal":return Qf[t.type](e);case"tag":return Qf[t.type](t.value,e);default:return[]}}(t,s),u=!0})),u&&i.push(s);var l=i[0].filter((function(t){for(var e,n=t.parent,r=1;r<i.length;r++){for(e=i[r].indexOf(n);n&&e<0;)n=n.parent,e=i[r].indexOf(n);if(e<0)return!1}return!0}));a.push(l)},u=0,l=n.length;u<l;u++)s(u);for(var c=0,h=a.length;c<h;c++)for(var f=0,d=a[c].length;f<d;f++)i.indexOf(a[c][f])<0&&i.push(a[c][f])}return i||[]}};function ed(t,e,n){var r=t.type,i=t.points();n&&(i=i.every((function(t){return Array.isArray(t)}))?i.map((function(t){return n.transformPoints(t)})):n.transformPoints(i)),function(t,e){for(var n=0,r=t.length;n<r;n++)t[n].x/=e,t[n].y/=e}(i,e);var a=null;if("rect"===r||"bounds"===r)(a=Q(i)).type=r;else if("circle"===r)(a=function(t,e){return{cx:t[0].x,cy:t[0].y,r:e}}(i,t.r)).type=r;else if("line"===r)(a=tt(i)).type=r;else if("polygon"===r||"polyline"===r){a={type:"path",d:Yo(i,"polygon"===r)}}else if("geopolygon"===r){for(var o="",s=0;s<i.length;s++)o+=Yo(i[s],!0);a={type:"path",d:o}}return a}var nd=function(){function t(e){var n=this;q(this,t),this._bounds=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e.boundingRect?e.boundingRect(t):{x:0,y:0,width:0,height:0},r=n.x,i=n.y,a=n.width,o=n.height;return{x:r,y:i,width:a,height:o}},this._attrs=e.attrs,this._type=e.type,this._data=e.data,this._dpi=e.stage?e.stage.dpi:1,this._collider=function(){return function(t,e){if(t.collider){var n=t.modelViewMatrix;return"collection"===t.colliderType?{type:"container",children:t.collider.geometries.map((function(t){return ed(t,e,n)}))}:ed(t.collider,e,n)}return null}(e,n._dpi)},this._desc=e.desc,this._tag=e.tag,this._children=function(){return e.children.map((function(e){return new t(e)}))},this._parent=function(){return e.parent?new t(e.parent):null},this._cache={elementBoundingRect:null},this._getElementBoundingRect=function(){return!n._cache.elementBoundingRect&&n.element&&(n._cache.elementBoundingRect=n.element.getBoundingClientRect()),n._cache.elementBoundingRect||{left:0,top:0}}}return A(t,[{key:"children",get:function(){return this._children()}},{key:"parent",get:function(){return this._parent()}},{key:"type",get:function(){return this._type}},{key:"data",get:function(){return this._data}},{key:"attrs",get:function(){return this._attrs}},{key:"element",get:function(){return this._element},set:function(t){this._cache.elementBoundingRect=null,this._element=t}},{key:"key",get:function(){return this._key},set:function(t){this._key=t}},{key:"bounds",get:function(){var t=this._bounds();return t.x/=this._dpi,t.y/=this._dpi,t.width/=this._dpi,t.height/=this._dpi,t}},{key:"localBounds",get:function(){return this._bounds(!1)}},{key:"boundsRelativeTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=R(t),r=e?this.bounds:this.localBounds,i=this._getElementBoundingRect(),a=i.left,o=i.top;if("object"===n&&null!==t&&"function"==typeof t.getBoundingClientRect){var s=t.getBoundingClientRect(),u=s.left,l=void 0===u?0:u,c=s.top,h=void 0===c?0:c;a-=l,o-=h}return r.x+=a,r.y+=o,r}},{key:"collider",get:function(){return this._collider()}},{key:"desc",get:function(){return this._desc}},{key:"tag",get:function(){return this._tag}}]),t}();function rd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(nd,e)}var id=function(){function t(e){q(this,t),this._node=rd(e),this._parent=null,this._input=null}return A(t,[{key:"node",get:function(){return this._node}},{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t}},{key:"input",get:function(){return this._input},set:function(t){this._input=t}}]),t}();function ad(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(id,e)}function od(t,e){var n=t.parent;if(n&&"stage"!==n.type){e.parent=ad(n);var r=n.parent;r&&"stage"!==r.type&&od(r,e.parent)}}function sd(t,e,n){if(null===t.colliderType)return null;var r=function(t,e){var n={};if(t.modelViewMatrix)if(Array.isArray(e))n=t.inverseModelViewMatrix.transformPoints(e);else if(isNaN(e.r))Array.isArray(e.vertices)?n.vertices=t.inverseModelViewMatrix.transformPoints(e.vertices):n=t.inverseModelViewMatrix.transformPoint(e);else{var r={x:e.cx,y:e.cy},i=t.inverseModelViewMatrix.transformPoint(r);n.cx=i.x,n.cy=i.y,n.r=e.r}else n=e;return Array.isArray(n.vertices)&&(n=n.vertices.every((function(t){return Array.isArray(t)}))?Ff(n):Tf(n)),n}(t,n);return"frontChild"===t.colliderType?function(t,e,n){for(var r=t.descendants.length-1;r>=0;r--){var i=t.descendants[r];if(null!==i.collider&&i.collider[e](n)){var a=ad(i);return od(i,a),a}}return null}(t,e,r):function(t,e,n){if(t.collider[e](n)){var r=ad(t);return od(t,r),r}return null}(t,e,r)}function ud(t,e,n,r){for(var i=t.length,a=0;a<i;a++){var o=t[a],s=sd(o,e,r);s&&n.push(s),!o.children||s||o.collider||ud(o.children,e,n,r)}}function ld(t,e,n){for(var r=t.length,i=0;i<r;i++){var a=t[i];if(null!==sd(a,e,n))return!0;if(a.children&&!a.collider)return ld(a.children,e,n)}return!1}function cd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=et(t),r={};switch(n){case"circle":return r.cx=t.cx*e,r.cy=t.cy*e,r.r=t.r,["intersectsCircle",r];case"rect":return["intersectsRect",r=J(t).map((function(t){return Qo(t,e)}))];case"line":return["intersectsLine",r=Z(t).map((function(t){return Qo(t,e)}))];case"point":return["containsPoint",r=Qo(t,e)];case"polygon":return r.vertices=t.vertices.map((function(t){return Qo(t,e)})),["intersectsPolygon",r];case"geopolygon":return r.vertices=t.vertices.map((function(t){return t.map((function(t){return Qo(t,e)}))})),["intersectsGeoPolygon",r];default:return[]}}function hd(t,e){var n=H(cd(e,t.dpi),2),r=n[0],i=n[1],a=[];return r&&(ud([t],r,a,i),function(t,e){for(var n=0,r=e.length;n<r;n++)e[n].input=t}(e,a)),a}function fd(t,e){var n=H(cd(e,t.dpi),2);return ld([t],n[0],n[1])}var dd=function(t){O(n,t);var e=F(n);function n(t){var r;return q(this,n),(r=e.call(this,t))._stage=null,r._collider={type:null,definition:null,fn:null},r._attrs={},r._node=null,r}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.node=t;var e=t.data,n=t.desc,r=t.tag,i=t.strokeReference,a=t.fillReference;Uo(this.attrs,t),void 0!==e&&(this.data=e),"object"===R(n)&&(this.desc=M(!0,{},n)),"string"==typeof r&&(this.tag=r),"string"==typeof i&&(this.strokeReference=i),"string"==typeof a&&(this.fillReference=a)}},{key:"findShapes",value:function(t){return td.find(t,this).map((function(t){return rd(t)}))}},{key:"getItemsFrom",value:function(t){return hd(this,t)}},{key:"containsPoint",value:function(t){return fd(this,t)}},{key:"intersectsLine",value:function(t){return fd(this,t)}},{key:"intersectsRect",value:function(t){return fd(this,t)}},{key:"intersectsCircle",value:function(t){return fd(this,t)}},{key:"intersectsPolygon",value:function(t){return fd(this,t)}},{key:"intersectsGeoPolygon",value:function(t){return fd(this,t)}},{key:"resolveLocalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Vf;void 0!==this.attrs.transform&&Zf(this.attrs.transform,t),this.modelViewMatrix=t.clone()}},{key:"resolveGlobalTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Vf,e=this.ancestors;if(e.length>0)for(var n=e.length-1;n>=0;n--)e[n].resolveLocalTransform(t),t=e[n].modelViewMatrix;this.resolveLocalTransform(t)}},{key:"attr",value:function(t){return this.attrs[t]}},{key:"equals",value:function(t){var e=this.attrs,r=Object.keys(e),i=t.attrs,a=Object.keys(i);if(r.length!==a.length)return!1;for(var o=0;o<r.length;o++){var s=r[o];if(!Object.hasOwnProperty.call(i,s))return!1;if(e[s]!==i[s])return!1}return B(E(n.prototype),"equals",this).call(this,t)}},{key:"toJSON",value:function(){var t=B(E(n.prototype),"toJSON",this).call(this);return t.attrs=this.attrs,t}},{key:"attrs",get:function(){return this._attrs}},{key:"stage",get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}},{key:"modelViewMatrix",get:function(){return this._mvm},set:function(t){this._mvm=t,this._imvm=null}},{key:"inverseModelViewMatrix",get:function(){return this._imvm=this._imvm?this._imvm:this._mvm.clone().invert(),this._imvm}},{key:"node",get:function(){return this._node},set:function(t){this._node=t}},{key:"collider",get:function(){if(null!==this._collider.fn)return this._collider.fn;switch(this._collider.type){case"collection":this._collider.fn=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Wf,e)}(this._collider.definition);break;case"frontChild":return!0;case"bounds":this._collider.fn=$f("rect",this.boundingRect());break;case"line":case"rect":case"circle":case"polygon":case"geopolygon":case"polyline":this._collider.fn=$f(this._collider.type,this._collider.definition);break;default:return null}return this._collider.fn},set:function(t){var e=Array.isArray(t)?"collection":t&&t.type;return"string"!=typeof e?(this._collider.type=null,this._collider.definition=null,void(this._collider.fn=null)):null!==this._collider&&this._collider.type===e&&null!==this._collider.fn?(this._collider.fn.set(t),void(this._collider.definition=t)):(this._collider.type=e,void(this._collider.definition=t))}},{key:"colliderType",get:function(){return this._collider.type}}]),n}(qf),pd=function(t){O(n,t);var e=F(n);function n(){return q(this,n),e.apply(this,arguments)}return A(n,[{key:"addChild",value:function(t){if(!(t&&t instanceof qf))throw new TypeError("Expecting a Node as argument, but got ".concat(t));if(t===this)throw new Error("Can not add itself as child!");if(t._children&&t._children.length&&this.ancestors.indexOf(t)>=0)throw new Error("Can not add an ancestor as child!");return t._parent&&t._parent!==this&&t._parent.removeChild(t),this._children.push(t),t._parent=this,t._ancestors=null,this}},{key:"addChildren",value:function(t){var e,n=t?t.length:0;for(e=0;e<n;e++)this.addChild(t[e]);return this}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);return e>=0&&(this._children.splice(e,1),t._parent=null,t._ancestors=null),this}},{key:"removeChildren",value:function(t){var e,n;if(!this._children)return this;if(t)for(n=t.length,e=0;e<n;e++)this.removeChild(t[e]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}}]),n}(qf),gd=pd.prototype,vd=function(t){O(n,t);var e=F(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(this,n);var i=r.type,a=void 0===i?"container":i;return(t=e.call(this,a)).set(r),t}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};B(E(n.prototype),"set",this).call(this,t);var e=t.collider,r=M({type:null},e);this.collider=r,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"appendChildRect",value:function(t,e){if(void 0!==t.bounds){var n=this.__boundingRect[e]||{},r=H(t.bounds(e),3),i=r[0],a=r[2],o=i.x,s=i.y,u=a.x,l=a.y,c=isNaN(n.width)?u:Math.max(u,n.width+n.x),h=isNaN(n.height)?l:Math.max(l,n.height+n.y);n.x=isNaN(n.x)?o:Math.min(o,n.x),n.y=isNaN(n.y)?s:Math.min(s,n.y),n.width=c-n.x,n.height=h-n.y,this.__boundingRect[e]=n}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];for(var e=this.children.length,n=0;n<e;n++)this.appendChildRect(this.children[n],t);return this.__boundingRect[t]=M({x:0,y:0,width:0,height:0},this.__boundingRect[t]),this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}},{key:"addChild",value:function(t){var e=gd.addChild.call(this,t);if(this._collider&&"bounds"===this._collider.type){this.appendChildRect(t,!0);var n=M({type:"bounds",x:0,y:0,width:0,height:0},this.__boundingRect.true);this.collider=n}return e}},{key:"addChildren",value:function(t){var e=gd.addChildren.call(this,t),n=t.length;if(this._collider&&"bounds"===this._collider.type&&n>0){for(var r=0;r<n;r++)this.appendChildRect(t[r],!0);var i=M({type:"bounds",x:0,y:0,width:0,height:0},this.__boundingRect.true);this.collider=i}return e}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;if(gd.removeChild.call(this,t),this._collider&&"bounds"===this._collider.type){this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null};var i=M(this.boundingRect(!0),{type:"bounds"});this.collider=i}return this}},{key:"removeChildren",value:function(t){if(gd.removeChildren.call(this,t),this._collider&&"bounds"===this._collider.type){this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null};var e=M(this.boundingRect(!0),{type:"bounds"});this.collider=e}return this}}]),n}(dd);function yd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(vd,e)}var md=function(t){O(n,t);var e=F(n);function n(t){var r;return q(this,n),(r=e.call(this,"stage"))._stage=P(r),r._dpiRatio=t||1,r}return A(n,[{key:"dpi",get:function(){return this._dpiRatio}}]),n}(vd);var xd=pd.prototype,bd=["x1","x2","y1","y2","id","offset","style"],wd=function(t){O(n,t);var e=F(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(this,n);var i=r.type,a=void 0===i?"container":i;return(t=e.call(this,a)).set(r),t._boundingRect={},t}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};B(E(n.prototype),"set",this).call(this,t);for(var e=this.attrs,r="",i=0,a=bd.length;i!==a;i++)void 0!==t[r=bd[i]]&&(e[r]=t[r])}},{key:"addChild",value:function(t){return xd.addChild.call(this,t)}},{key:"addChildren",value:function(t){return xd.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;return xd.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return xd.removeChildren.call(this,t),this}}]),n}(dd);function kd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(wd,e)}var Md=pd.prototype,_d=["patternUnits","x","y","width","height","id"],Sd=function(t){O(n,t);var e=F(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(this,n);var i=r.type,a=void 0===i?"container":i;return(t=e.call(this,a)).set(r),t._boundingRect={},t}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};B(E(n.prototype),"set",this).call(this,t);for(var e=this.attrs,r="",i=0,a=_d.length;i!==a;i++)void 0!==t[r=_d[i]]&&(e[r]=t[r])}},{key:"addChild",value:function(t){return Md.addChild.call(this,t)}},{key:"addChildren",value:function(t){return Md.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,r=n?n.length:0;for(e=0;e<r;e++)n[e]._stage=null;return Md.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return Md.removeChildren.call(this,t),this}}]),n}(dd);var Cd=function(t){O(n,t);var e=F(n);function n(){var t,r;return q(this,n),(t=r=e.call(this,"rect")).set.apply(t,arguments),r}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,r=void 0===e?0:e,i=t.y,a=void 0===i?0:i,o=t.width,s=void 0===o?0:o,u=t.height,l=void 0===u?0:u,c=t.rx,h=void 0===c?0:c,f=t.ry,d=void 0===f?0:f,p=t.collider,g=M({type:"rect",x:r,y:a,width:s,height:l},p);B(E(n.prototype),"set",this).call(this,t),s>=0?(this.attrs.x=r,this.attrs.width=s):(this.attrs.x=r+s,this.attrs.width=-s),l>=0?(this.attrs.y=a,this.attrs.height=l):(this.attrs.y=a+l,this.attrs.height=-l),h>0&&(this.attrs.rx=h),d>0&&(this.attrs.ry=d),this.collider=g,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=J(this.attrs),n=t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e,r=G(n),i=H(r,4),a=i[0],o=i[1],s=i[2],u=i[3];return this.__boundingRect[t]={x:a,y:o,width:s-a,height:u-o},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}(dd);var Rd=function(t){O(n,t);var e=F(n);function n(){var t,r;return q(this,n),(t=r=e.call(this,"circle")).set.apply(t,arguments),r}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,r=void 0===e?0:e,i=t.cy,a=void 0===i?0:i,o=t.r,s=void 0===o?0:o,u=t.collider,l=M({type:"circle",cx:r,cy:a,r:s},u);B(E(n.prototype),"set",this).call(this,t),this.attrs.cx=r,this.attrs.cy=a,this.attrs.r=s,this.collider=l,this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=this.bounds(t);return this.__boundingRect[t]={x:e[0].x,y:e[0].y,width:e[2].x-e[0].x,height:e[2].y-e[0].y},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.attrs,n=e.cx,r=e.cy,i=e.r,a=e.r,o=n-i,s=r-a,u=2*i,l=2*a,c=[{x:o,y:s},{x:o+u,y:s},{x:o+u,y:s+l},{x:o,y:s+l}];if(t&&this.modelViewMatrix){var h=G(c=this.modelViewMatrix.transformPoints(c)),f=H(h,4),d=f[0],p=f[1],g=f[2],v=f[3];u=g-d,l=v-p,this.__bounds[t]=[{x:d,y:p},{x:d+u,y:p},{x:d+u,y:p+l},{x:d,y:p+l}]}else this.__bounds[t]=c;return this.__bounds[t]}}]),n}(dd);var qd=function(t){O(n,t);var e=F(n);function n(){var t,r;return q(this,n),(t=r=e.call(this,"line")).set.apply(t,arguments),r}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,r=void 0===e?0:e,i=t.y1,a=void 0===i?0:i,o=t.x2,s=void 0===o?0:o,u=t.y2,l=void 0===u?0:u,c=t.collider;B(E(n.prototype),"set",this).call(this,t),this.attrs.x1=r,this.attrs.y1=a,this.attrs.x2=s,this.attrs.y2=l;var h={type:"line",x1:r,y1:a,x2:s,y2:l};this.collider=M(h,c),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];var e=Z(this.attrs);t&&this.modelViewMatrix&&(e=this.modelViewMatrix.transformPoints(e));var n=G(e),r=H(n,4),i=r[0],a=r[1],o=r[2],s=r[3],u=i!==o||a!==s;return this.__boundingRect[t]={x:i,y:a,width:u?Math.max(1,o-i):0,height:u?Math.max(1,s-a):0},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}(dd);var Nd=Math.PI/2;function Ad(t,e){var n=Math.atan2(e.y-t.y,e.x-t.x);return n<0?n+2*Math.PI:n}function Dd(t,e,n){return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}}function Od(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],i=[];if("h"===n.forceOrientation){var a=t[0].x<t[1].x?-1:1,o=t[t.length-1].x>t[t.length-2].x?1:-1;t.unshift({x:t[0].x+a,y:t[0].y}),t.push({x:t[t.length-1].x+o,y:t[t.length-1].y})}else if("v"===n.forceOrientation){var s=t[0].y<t[1].y?-1:1,u=t[t.length-1].y>t[t.length-2].y?1:-1;t.unshift({x:t[0].x,y:t[0].y+s}),t.push({x:t[t.length-1].x,y:t[t.length-1].y+u})}for(var l=t.length-1,c=1;c<l;c++){var h=t[c-1],f=t[c],d=t[c+1],p=Ad(f,h),g=Ad(f,d),v=(p+g)/2,y=v+Math.PI,m=Math.max(v,y),x=Math.min(v,y),b=p>g;if(1===c){var w=Ad(h,f);r.push(Dd(h,w-Nd,e)),i.unshift(Dd(h,w+Nd,e))}var k=b?m:x,M=b?x:m;if(r.push(Dd(f,k,e)),i.unshift(Dd(f,M,e)),c===l-1){var _=Ad(d,f);r.push(Dd(d,_+Nd,e)),i.unshift(Dd(d,_-Nd,e))}}return{type:"polygon",vertices:[].concat(r,i)}}function Ed(t){for(var e,n=[],r=t.length,i=0;i<r;i++){e=t[i];for(var a=0;a<e.length;a++)n.push(e[a])}return n}function Id(t){if(t.length<2)return!1;var e=t[0],n=t[t.length-1];return Math.abs(e.x-n.x)<1e-12&&Math.abs(e.y-n.y)<1e-12}var Td=function(t){O(n,t);var e=F(n);function n(){var t,r;return q(this,n),(t=r=e.call(this,"path")).set.apply(t,arguments),r}return A(n,[{key:"set",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(B(E(n.prototype),"set",this).call(this,e),this.segments=[],this.points=[],e.arcDatum){var r=Dt();r.innerRadius(e.desc.slice.innerRadius),r.outerRadius(e.desc.slice.outerRadius),r.cornerRadius(e.desc.slice.cornerRadius);var i=r(e.arcDatum);this.attrs.d=i}else e.d&&(this.attrs.d=e.d);if(this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null},Array.isArray(e.collider)||"object"===R(e.collider)&&void 0!==e.collider.type)this.collider=e.collider;else if(e.arcDatum||e.d){if(this.segments=Sf(this.attrs.d),this.segments.length>1&&this.segments.every((function(t){return Id(t)})))return void(this.collider=M({type:"geopolygon",vertices:this.segments},e.collider));this.segments.forEach((function(n){if(n.length<=1);else if(Id(n))t.collider=M({type:"polygon",vertices:n},e.collider);else if("object"===R(e.collider)&&e.collider.visual){var r=t.attrs["stroke-width"]/2;t.collider=Od(n,r,e.collider)}else t.collider=M({type:"polyline",points:n},e.collider)}))}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];this.points.length||(this.segments=this.segments.length?this.segments:Sf(this.attrs.d),this.points=Ed(this.segments));var e=t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(this.points):this.points,n=G(e),r=H(n,4),i=r[0],a=r[1],o=r[2],s=r[3];return this.__boundingRect[t]={x:i||0,y:a||0,width:o-i||0,height:s-a||0},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}(dd);function jd(t){var e=t.data,n=t._boundingRect,r=t._textBoundsFn;return null!=e&&(n||r)}var Pd=function(t){O(n,t);var e=F(n);function n(){var t,r;return q(this,n),(t=r=e.call(this,"text")).set.apply(t,arguments),r}return A(n,[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,r=void 0===e?0:e,i=t.y,a=void 0===i?0:i,o=t.dx,s=void 0===o?0:o,u=t.dy,l=void 0===u?0:u,c=t.textBoundsFn,h=t.text,f=t.title,d=t.collider,p=t.boundingRect,g=t.ellipsed;B(E(n.prototype),"set",this).call(this,t),this.attrs.x=r,this.attrs.y=a,this.attrs.dx=s,this.attrs.dy=l,this.attrs.text=h,void 0!==f&&(this.attrs.title=String(f)),"object"===R(p)?this._textBoundsFn=function(){return p}:"function"==typeof c&&(this._textBoundsFn=c),"string"==typeof g&&(this.ellipsed=g),this.collider=M({type:jd(this)?"bounds":null},d),this.__boundingRect={true:null,false:null},this.__bounds={true:null,false:null}}},{key:"boundingRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__boundingRect[t])return this.__boundingRect[t];if("function"!=typeof this._textBoundsFn)return{x:0,y:0,width:0,height:0};var e=J(this._textBoundsFn(this.attrs)),n=t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e,r=G(n),i=H(r,4),a=i[0],o=i[1],s=i[2],u=i[3];return this.__boundingRect[t]={x:a,y:o,width:s-a,height:u-o},this.__boundingRect[t]}},{key:"bounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this.__bounds[t])return this.__bounds[t];var e=this.boundingRect(t);return this.__bounds[t]=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],this.__bounds[t]}}]),n}(dd);var zd=ue();function Fd(t,e){return zd.get(t)(e)}zd.add("rect",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Cd,e)})),zd.add("circle",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Rd,e)})),zd.add("text",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Pd,e)})),zd.add("line",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(qd,e)})),zd.add("path",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Td,e)})),zd.add("stage",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(md,e)})),zd.add("container",yd),zd.add("defs",yd),zd.add("linearGradient",kd),zd.add("radialGradient",kd),zd.add("stop",kd),zd.add("pattern",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return j(Sd,e)}));var Ld=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[{}];function n(){return e[e.length-1]}return n.save=function(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n(),a={},o="",s=0;s<t.length;s++)void 0!==i[o=t[s]]&&(a[o]=i[o]);return M(a,r),e.push(a),n()},n.restore=function(){e.splice(e.length-1,1)},n}(["stroke","fill","strokeWidth","opacity","fontFamily","fontSize","baseline"]);function Bd(t,e){if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)e[n](t)}function Hd(t,e,n){t.node=n[e],t.index=e}function $d(t,e,n,r){for(var i={siblings:t,node:null,index:0},a=0,o=t.length;a<o;a++)if(Hd(i,a,t),Bd(i,r.create),!("function"==typeof i.node.disabled?i.node.disabled():i.node.disabled)){i.node=Ld.save(i.node);var s=Fd(i.node.type,i.node);s&&(i.node.transform&&(n.save(),Zf(i.node.transform,n)),n.isIdentity()||(s.modelViewMatrix=n.clone()),e.addChild(s),i.node.children&&$d(i.node.children,s,n,r),i.node.transform&&n.restore()),Ld.restore()}}function Wd(t){var e=t.items,n=t.stage,r=t.dpi,i=t.on,a=void 0===i?{}:i;return n||(n=Fd("stage",r)),$d(e,n,new Vf,a),n}function Vd(t,e,n){var r=n.orientation,i=n.degree,a=n.stops,o=void 0===a?[]:a,s=null;if("radial"===r){var u=e.boundingRect();s=t.createRadialGradient(u.x+u.width/2,u.y+u.height/2,1e-5,u.x+u.width/2,u.y+u.height/2,Math.max(u.width,u.height)/2)}else{var l=Go(i);["x1","x2","y1","y2"].forEach((function(t){t in n&&(l[t]=n[t])}));var c=e.boundingRect();s=t.createLinearGradient(c.x+l.x1*c.width,c.y+l.y1*c.height,c.x+l.x2*c.width,c.y+l.y2*c.height)}for(var h=0,f=o.length;h<f;h++){var d=o[h];s.addColorStop(d.offset,d.color)}return s}function Ud(t,e,n){return e.width=t.width,e.height=t.height,n.save(),n.fillStyle=t.fill,t.shapes.forEach((function(t){switch(t.type){case"rect":n.rect(t.x,t.y,t.width,t.height)}})),n.fill(),n.restore(),n.createPattern(e,"repeat")}function Yd(t){var e=t.createElement("canvas"),n=e.getContext("2d"),r={};return{create:function(t){var i=t.key;return i?(r[i]=r[i]||Ud(t,e,n),r[i]):Ud(t,e,n)},clear:function(){r={}}}}function Xd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,r=t.width,i=t.height,a=t.scaleRatio,o=t.margin,s=t.edgeBleed,u={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1},margin:{left:0,top:0},edgeBleed:{left:0,right:0,top:0,bottom:0,bool:!1}};return u.x=isNaN(e)?u.x:e,u.y=isNaN(n)?u.y:n,u.width=isNaN(r)?u.width:r,u.height=isNaN(i)?u.height:i,void 0!==a&&(u.scaleRatio.x=isNaN(a.x)?u.scaleRatio.x:a.x,u.scaleRatio.y=isNaN(a.y)?u.scaleRatio.y:a.y),void 0!==o&&(u.margin.left=isNaN(o.left)?0:o.left,u.margin.top=isNaN(o.top)?0:o.top),"object"===R(s)&&["left","right","top","bottom"].forEach((function(t){!isNaN(s[t])&&s[t]>0&&(u.edgeBleed[t]=s[t],u.edgeBleed.bool=!0)})),u.computedPhysical={x:Math.round(u.margin.left+(u.x-u.edgeBleed.left)*u.scaleRatio.x),y:Math.round(u.margin.top+(u.y-u.edgeBleed.top)*u.scaleRatio.y),width:Math.round((u.width+u.edgeBleed.left+u.edgeBleed.right)*u.scaleRatio.x),height:Math.round((u.height+u.edgeBleed.top+u.edgeBleed.bottom)*u.scaleRatio.y)},u}function Kd(){var t={element:function(){},root:function(){},settings:function(){},appendTo:function(){},getScene:function(){return[]},render:function(){return!1},itemsAt:function(){return[]},findShapes:function(){return[]},clear:function(){},destory:function(){},size:function(){},measureText:yh,textBounds:xh,setKey:function(e){t.element().setAttribute("data-key",e)}};return t}function Gd(t){return function(e){var n=e.node;"text"===n.type&&function(t){return null!=t}(n.data)&&!n.textBoundsFn&&(n.textBoundsFn=t.textBounds)}}var Zd=200,Jd=200,Qd=function(){function t(e){q(this,t),this.targetCanvas=e,this.bufferCanvas=e.cloneNode()}return A(t,[{key:"updateSize",value:function(t){var e,n=t.rect,r=t.dpiRatio,i=t.canvasBufferSize;e=i?"function"==typeof i?i(n):i:{width:n.computedPhysical.width+2*Zd,height:n.computedPhysical.height+2*Jd},this.bufferCanvas.style.width="".concat(e.width,"px"),this.bufferCanvas.style.height="".concat(e.height,"px"),this.bufferCanvas.width=Math.round(e.width*r),this.bufferCanvas.height=Math.round(e.height*r)}},{key:"apply",value:function(){this.targetCanvas.getContext("2d").drawImage(this.bufferCanvas,0,0)}},{key:"clear",value:function(){this.bufferCanvas.width=this.bufferCanvas.width}},{key:"getContext",value:function(){return this.bufferCanvas.getContext("2d")}}]),t}(),tp=ue();function ep(t){return Array.isArray(t)?t:"string"==typeof t?-1!==t.indexOf(",")?t.split(","):t.split(" "):[]}function np(t){return("undefined"==typeof window?1:window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function rp(t,e){e.setTransform(t[0][0],t[1][0],t[0][1],t[1][1],t[0][2],t[1][2])}function ip(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Object.keys(r),a=0,o=n.length;a<o;a++){var s=n[a],u=s[0],l=s[1],c=s[2];if(u in e.attrs&&!(l in r)&&t[l]!==e.attrs[u]){var h=c?c(e.attrs[u]):e.attrs[u];"function"==typeof t[l]?t[l](h):t[l]=h}}for(var f=0,d=i.length;f<d;f++){var p=i[f];t[p]=r[p]}}function ap(t,e,n,r){for(var i=0,a=t.length;i<a;i++){var o=t[i],s={};e.save(),o.attrs&&(o.attrs.fill||o.attrs.stroke)&&(o.attrs.fill&&"object"===R(o.attrs.fill)&&"gradient"===o.attrs.fill.type?s.fillStyle=Vd(e,o,o.attrs.fill):o.attrs.fill&&"object"===R(o.attrs.fill)&&"pattern"===o.attrs.fill.type&&(s.fillStyle=r.patterns.create(o.attrs.fill)),o.attrs.stroke&&"object"===R(o.attrs.stroke)&&"gradient"===o.attrs.stroke.type?s.strokeStyle=Vd(e,o,o.attrs.stroke):o.attrs.stroke&&"object"===R(o.attrs.stroke)&&"pattern"===o.attrs.stroke.type&&(s.strokeStyle=r.patterns.create(o.attrs.stroke))),ip(e,o,n,s),o.modelViewMatrix&&rp(o.modelViewMatrix.elements,e),tp.has(o.type)&&tp.get(o.type)(o.attrs,{g:e,doFill:"fill"in o.attrs&&"none"!==o.attrs.fill,doStroke:"stroke"in o.attrs&&0!==o.attrs["stroke-width"],ellipsed:o.ellipsed}),o.children&&ap(o.children,e,n,r),e.restore()}}function op(t){var e=t.el,n=t.dpiRatio,r=t.transform;if("object"===R(r)){var i=[r.horizontalScaling,r.horizontalSkewing,r.verticalSkewing,r.verticalScaling,r.horizontalMoving*n,r.verticalMoving*n],a=e.getContext("2d");a.setTransform.apply(a,i)}}function sp(){var t,e,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wd,a={transform:void 0,canvasBufferSize:void 0,progressive:void 0},o=!1,s=Xd(),u=[["fill","fillStyle"],["stroke","strokeStyle"],["opacity","globalAlpha"],["globalAlpha","globalAlpha"],["stroke-width","lineWidth"],["stroke-linejoin","lineJoin"],["stroke-dasharray","setLineDash",ep]],l=Kd();return l.element=function(){return t},l.root=function(){return t},l.settings=function(t){return t&&Object.keys(a).forEach((function(e){void 0!==t[e]&&(a[e]=t[e])})),a},l.appendTo=function(n){return t||((t=n.ownerDocument.createElement("canvas")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),"function"!=typeof a.transform||e||(e=new Qd(t)),n.appendChild(t),t},l.getScene=function(n){var r=np(e&&e.getContext()||t.getContext("2d")),a=s.scaleRatio.x,o=s.scaleRatio.y,u={type:"container",children:n,transform:s.edgeBleed.bool?"translate(".concat(s.edgeBleed.left*r*a,", ").concat(s.edgeBleed.top*r*o,")"):""};return 1===r&&1===a&&1===o||(u.transform+="scale(".concat(r*a,", ").concat(r*o,")")),i({items:[u],dpi:r,on:{create:[uh(l.measureText),Gd(l)]}})},l.render=function(i){if(!t)return!1;r||(r=Yd(t.ownerDocument));var c=e&&e.getContext()||t.getContext("2d"),h=np(c),f=e&&a.transform();if(f)return t.width=t.width,op({el:t,dpiRatio:h,transform:f}),e.apply(),!0;o&&(t.style.left="".concat(s.computedPhysical.x,"px"),t.style.top="".concat(s.computedPhysical.y,"px"),t.style.width="".concat(s.computedPhysical.width,"px"),t.style.height="".concat(s.computedPhysical.height,"px"),t.width=Math.round(s.computedPhysical.width*h),t.height=Math.round(s.computedPhysical.height*h),e&&e.updateSize({rect:s,dpiRatio:h,canvasBufferSize:a.canvasBufferSize}));var d=l.getScene(i),p=!n||!d.equals(n);r.clear();var g,v=o||p,y="function"==typeof a.progressive&&a.progressive();(v&&(y&&!y.isFirst||l.clear(),ap(d.children,c,u,{patterns:r})),e&&(t.width=t.width,e.apply()),o=!1,y&&!y.isFirst)&&(g=d.children).unshift.apply(g,$(n.children));return n=d,v},l.itemsAt=function(t){return n?n.getItemsFrom(t):[]},l.findShapes=function(t){return n?n.findShapes(t):[]},l.clear=function(){return t&&(t.width=t.width),e&&e.clear(),n=null,l},l.size=function(t){if(t){var e=Xd(t);JSON.stringify(s)!==JSON.stringify(e)&&(o=!0,s=e)}return s},l.destroy=function(){t&&(t.parentElement&&t.parentElement.removeChild(t),t=null),e&&(e=null),n=null},l}function up(t,e){tp.add(t,e)}function lp(t,e){return Math.max(0,Math.min(t,e))}var cp=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),hp=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),fp=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]");function dp(t){return cp.test(t)}function pp(t){return hp.test(t)||fp.test(t)}function gp(t){var e,n,r=t?t.length:0;for(e=0;e<r;e++){if(dp(n=t[e]))return"ltr";if(pp(n))return"rtl"}return"ltr"}var vp={start:"end",end:"start",center:"center",middle:"middle"};function yp(t,e){return"rtl"===e?vp[t]:t}function mp(t,e){var n,r,i,a=[],o=[],s=[],u=[],l=function(t){return t.id},c=function(t,e){var n;return n="object"===R(t)?"id"in t?t.id:e:t,{content:t,id:"".concat(n,"__").concat(t.type||"")}};t.isTree||(t=t.map(c)),e=e.map(c),r=t.map(l),i=e.map(l);for(var h=0,f=e.length;h<f;h++){-1===r.indexOf(e[h].id)?a.push(e[h]):s.push(e[h])}for(var d=0,p=t.length;d<p;d++){-1===i.indexOf(t[d].id)?o.push(t[d]):u.push(t[d])}for(var g=0,v=a.length;g<v;g++)a[g].content.children&&(a[g].diff=mp([],a[g].content.children),a[g].children=a[g].diff.updatedNew.concat(a[g].diff.added),a[g].children.isTree=!0);for(var y=0,m=s.length;y<m;y++)s[y].diff=mp(u[y].children||[],s[y].content.children||[]),s[y].object=u[y].object,s[y].children=s[y].diff.items;return n=s.concat(a),a.isTree=!0,o.isTree=!0,s.isTree=!0,u.isTree=!0,n.isTree=!0,{added:a,updatedNew:s,updatedOld:u,removed:o,items:n}}function xp(t,e,n){for(var r=0,i=t.length;r<i;r++)t[r].object=n(t[r].content.type,e)}function bp(t,e){for(var n=0,r=t.length;n<r;n++)null!==t[n].object&&void 0!==t[n].object&&(e(t[n].object),t[n].object=null)}function wp(t,e,n,r){for(var i,a=0,o=t.length;a<o;a++)null!==(i=t[a]).object&&void 0!==i.object&&(n(i.object,i.content),i.diff&&(xp(i.diff.added,i.object,e),bp(i.diff.removed,r),wp(i.diff.items,e,n,r)))}function kp(t,e,n,r,i,a){var o=mp(t,e);return xp(o.added,n,r),bp(o.removed,a),wp(o.items,r,i,a),o.items}up("rect",(function(t,e){var n=e.g,r=e.doFill,i=e.doStroke;n.beginPath(),t.rx>0||t.ry>0?function(t,e,n,r,i,a,o){a=lp(r/2,a>0?a:o),o=lp(i/2,o>0?o:a),t.moveTo(e,n+o),t.lineTo(e,n+i-o),t.quadraticCurveTo(e,n+i,e+a,n+i),t.lineTo(e+r-a,n+i),t.quadraticCurveTo(e+r,n+i,e+r,n+i-o),t.lineTo(e+r,n+o),t.quadraticCurveTo(e+r,n,e+r-a,n),t.lineTo(e+a,n),t.quadraticCurveTo(e,n,e,n+o)}(n,t.x,t.y,t.width,t.height,t.rx,t.ry):n.rect(t.x,t.y,t.width,t.height),r&&n.fill(),i&&n.stroke()})),up("circle",(function(t,e){var n=e.g,r=e.doFill,i=e.doStroke;n.beginPath(),n.moveTo(t.cx+t.r,t.cy),n.arc(t.cx,t.cy,t.r,0,2*Math.PI,!1),r&&n.fill(),i&&n.stroke()})),up("line",(function(t,e){var n=e.g,r=e.doStroke;n.beginPath(),n.moveTo(t.x1,t.y1),n.lineTo(t.x2,t.y2),r&&n.stroke()})),up("path",(function(t,e){var n=e.g,r=e.doStroke,i=e.doFill,a=new Path2D(t.d);i&&n.fill(a),r&&n.stroke(a)})),up("text",(function(t,e){var n=e.g,r=e.ellipsed,i=e.doStroke,a=r||lh(t,yh);t["font-weight"]?n.font="".concat(t["font-weight"]," ").concat(t["font-size"]," ").concat(t["font-family"]):n.font="".concat(t["font-size"]," ").concat(t["font-family"]);var o=gp(t.text);n.canvas.dir!==o&&(n.canvas.dir=o);var s=yp("middle"===t["text-anchor"]?"center":t["text-anchor"],n.canvas.dir);s&&n.textAlign!==s&&(n.textAlign=s);var u=ch(t);n.fillText(a,t.x+t.dx,t.y+t.dy+u),i&&n.strokeText(a,t.x+t.dx,t.y+t.dy+u)}));var Mp="http://www.w3.org/2000/svg",_p=function(t,e){if(!t||"string"!=typeof t)throw new Error("Invalid type: ".concat(t));var n=e.ownerDocument.createElementNS(Mp,"container"===t?"g":t);return e.appendChild(n),n},Sp=function(t){t.parentNode&&t.parentNode.removeChild(t)},Cp=function(t,e){if(function(t){switch(t.type){case"circle":return!isNaN(t.attrs.cx)&&!isNaN(t.attrs.cy)&&!isNaN(t.attrs.r);case"line":return!(isNaN(t.attrs.x1)||isNaN(t.attrs.y1)||isNaN(t.attrs.x2)||isNaN(t.attrs.y2));case"rect":return!(isNaN(t.attrs.x)||isNaN(t.attrs.y)||isNaN(t.attrs.width)||isNaN(t.attrs.height));case"text":return!isNaN(t.attrs.x)&&!isNaN(t.attrs.y);default:return!0}}(e)){for(var n in e.attrs)if("stroke"===n&&e.strokeReference)t.setAttribute("stroke",e.strokeReference);else if("fill"===n&&e.fillReference)t.setAttribute("fill",e.fillReference);else if("text"===n){t.setAttribute("style","white-space: pre"),t.textContent=e.ellipsed||lh(e.attrs,yh);var r=gp(e.attrs.text);"rtl"===r&&(t.setAttribute("direction","rtl"),t.setAttribute("dir","rtl"),t.setAttribute("text-anchor",yp(t.getAttribute("text-anchor"),r)))}else if("text"!==e.type||"dy"!==n&&"dominant-baseline"!==n)if("text"===e.type&&"title"===n&&e.attrs.title){var i=t.ownerDocument.createElementNS(Mp,"title");i.textContent=e.attrs.title,t.appendChild(i)}else t.setAttribute(n,e.attrs[n]);else{var a=+t.getAttribute(n)||0,o=0;o="dominant-baseline"===n?ch(e.attrs):e.attrs[n],t.setAttribute("dy",o+a)}if("string"==typeof e.data||"number"==typeof e.data||"boolean"==typeof e.data)t.setAttribute("data",e.data);else if("object"===R(e.data)&&null!==e.data)for(var s in e.data)"string"!=typeof e.data[s]&&"number"!=typeof e.data[s]&&"boolean"!=typeof e.data[s]||t.setAttribute("data-".concat(s),e.data[s])}},Rp=function(){function t(e,n,r,i){q(this,t),this.create=e,this.nodeCreator=n,this.nodeMaintainer=r,this.nodeDestroyer=i}return A(t,[{key:"render",value:function(t,e){return this.create([],t,e,this.nodeCreator,this.nodeMaintainer,this.nodeDestroyer)}}]),t}();function qp(){return new Rp(kp,_p,Cp,Sp)}function Np(t){var e,n,r=0;if(0===(t=JSON.stringify(t)).length)return r;for(e=0,n=t.length;e<n;e++)r=(r<<5)-r+t.charCodeAt(e),r&=r;return r}function Ap(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Np,n={},r=Date.now(),i={getOrCreateGradient:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e(i[a]),u="picasso-gradient-".concat(r,"-").concat(s);if(!n[s]){var l=i[a],c=l.orientation,h=l.degree,f=l.stops,d=void 0===f?[]:f,p={};void 0===h&&(h=90),"radial"===c?p.type="radialGradient":(p=Go(h),["x1","x2","y1","y2"].forEach((function(t){t in i[a]&&(p[t]=i[a][t])})),p.type="linearGradient"),p.id=u,p.children=d.map((function(t){var e=t.offset,n=t.color,r=t.opacity;return{type:"stop",offset:"".concat(100*e,"%"),style:"stop-color:".concat(n,";stop-opacity:").concat(void 0!==r?r:1)}})),t.push(p),n[s]=u}return"url('".concat(o,"#").concat(u,"')")},onCreate:function(t){var e="";"undefined"!=typeof window&&(e=window.location.href.split("#")[0]);var n=t.node;n.fill&&"object"===R(n.fill)&&"gradient"===n.fill.type&&(n.fillReference=i.getOrCreateGradient(n,"fill",e)),n.stroke&&"object"===R(n.stroke)&&"gradient"===n.stroke.type&&(n.strokeReference=i.getOrCreateGradient(n,"stroke",e))},clear:function(){n={}}};return i}function Dp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Np,n={},r=Date.now(),i={onCreate:function(i){var a={};i.node&&"object"===R(i.node.fill)&&"pattern"===i.node.fill.type&&i.node.fill.shapes&&(a.fill=i.node.fill),i.node&&"object"===R(i.node.stroke)&&"pattern"===i.node.stroke.type&&i.node.stroke.shapes&&(a.stroke=i.node.stroke),Object.keys(a).forEach((function(o){var s="",u=a[o],l=e(u),c="picasso-pattern-".concat(r,"-").concat(l);if("undefined"!=typeof window&&(s=window.location.href.split("#")[0]),!n[l]){var h={patternUnits:"userSpaceOnUse",x:0,y:0,width:u.width,height:u.height,type:"pattern",id:c,children:[],fill:u.fill};u.shapes.forEach((function(t){h.children.push(t)})),t.push(h),n[l]=!0}i.node["".concat(o,"Reference")]="url('".concat(s,"#").concat(c,"')")}))},clear:function(){n={}}};return i}function Op(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qp,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mp,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wd,o=r(),s=!1,u=Xd(),l={transform:void 0},c=Kd(),h={type:"defs",children:[]},f=Dp(h.children),d=Ap(h.children);return c.element=function(){return t},c.root=function(){return e},c.settings=function(t){return t&&Object.keys(l).forEach((function(e){void 0!==t[e]&&(l[e]=t[e])})),l},c.appendTo=function(n){return t||((t=n.ownerDocument.createElementNS(i,"svg")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none",t.setAttribute("xmlns",i),(e=n.ownerDocument.createElementNS(i,"g")).style.pointerEvents="auto",t.appendChild(e)),n.appendChild(t),t},c.getScene=function(t){var e=u.scaleRatio.x,n=u.scaleRatio.y,r={type:"container",children:Array.isArray(t)?[].concat($(t),[h]):t,transform:u.edgeBleed.bool?"translate(".concat(u.edgeBleed.left*e,", ").concat(u.edgeBleed.top*n,")"):""};return 1===e&&1===n||(r.transform+="scale(".concat(e,", ").concat(n,")")),a({items:[r],on:{create:[function(t){t.node.fillReference=void 0,t.node.strokeReference=void 0},d.onCreate,f.onCreate,uh(c.measureText),Gd(c)]}})},c.render=function(r){if(!t)return!1;var i="function"==typeof l.transform&&l.transform();if(i){var a=i.a,p=i.b,g=i.c,v=i.d,y=i.e,m=i.f;return e.style.transform="matrix(".concat(a,", ").concat(p,", ").concat(g,", ").concat(v,", ").concat(y,", ").concat(m,")"),!0}e.style.transform="",s&&(t.style.left="".concat(u.computedPhysical.x,"px"),t.style.top="".concat(u.computedPhysical.y,"px"),t.setAttribute("width",u.computedPhysical.width),t.setAttribute("height",u.computedPhysical.height)),d.clear(),f.clear(),h.children.length=0;var x=c.getScene(r),b=!n||!x.equals(n),w=s||b;return w&&(c.clear(),o.render(x.children,e)),s=!1,n=x,w},c.itemsAt=function(t){return n?n.getItemsFrom(t):[]},c.findShapes=function(t){return n?n.findShapes(t):[]},c.clear=function(){if(!e)return c;n=null;var r=e.cloneNode(!1);return t.replaceChild(r,e),e=r,c},c.destroy=function(){t&&t.parentNode&&t.parentNode.removeChild(t),t=null,e=null},c.size=function(t){if(t){var e=Xd(t);JSON.stringify(u)!==JSON.stringify(e)&&(s=!0,u=e)}return u},c}var Ep,Ip,Tp,jp,Pp,zp={},Fp=[],Lp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Bp(t,e){for(var n in e)t[n]=e[n];return t}function Hp(t){var e=t.parentNode;e&&e.removeChild(t)}function $p(t,e,n){var r,i,a,o={};for(a in e)"key"==a?r=e[a]:"ref"==a?i=e[a]:o[a]=e[a];if(arguments.length>2&&(o.children=arguments.length>3?Ep.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(a in t.defaultProps)void 0===o[a]&&(o[a]=t.defaultProps[a]);return Wp(t,o,r,i,null)}function Wp(t,e,n,r,i){var a={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++Tp:i};return null==i&&null!=Ip.vnode&&Ip.vnode(a),a}function Vp(t){return t.children}function Up(t,e){this.props=t,this.context=e}function Yp(t,e){if(null==e)return t.__?Yp(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?Yp(t):null}function Xp(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return Xp(t)}}function Kp(t){(!t.__d&&(t.__d=!0)&&jp.push(t)&&!Gp.__r++||Pp!==Ip.debounceRendering)&&((Pp=Ip.debounceRendering)||setTimeout)(Gp)}function Gp(){for(var t;Gp.__r=jp.length;)t=jp.sort((function(t,e){return t.__v.__b-e.__v.__b})),jp=[],t.some((function(t){var e,n,r,i,a,o;t.__d&&(a=(i=(e=t).__v).__e,(o=e.__P)&&(n=[],(r=Bp({},i)).__v=i.__v+1,ig(o,i,r,e.__n,void 0!==o.ownerSVGElement,null!=i.__h?[a]:null,n,null==a?Yp(i):a,i.__h),ag(n,i),i.__e!=a&&Xp(i)))}))}function Zp(t,e,n,r,i,a,o,s,u,l){var c,h,f,d,p,g,v,y=r&&r.__k||Fp,m=y.length;for(n.__k=[],c=0;c<e.length;c++)if(null!=(d=n.__k[c]=null==(d=e[c])||"boolean"==typeof d?null:"string"==typeof d||"number"==typeof d||"bigint"==typeof d?Wp(null,d,null,null,d):Array.isArray(d)?Wp(Vp,{children:d},null,null,null):d.__b>0?Wp(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d)){if(d.__=n,d.__b=n.__b+1,null===(f=y[c])||f&&d.key==f.key&&d.type===f.type)y[c]=void 0;else for(h=0;h<m;h++){if((f=y[h])&&d.key==f.key&&d.type===f.type){y[h]=void 0;break}f=null}ig(t,d,f=f||zp,i,a,o,s,u,l),p=d.__e,(h=d.ref)&&f.ref!=h&&(v||(v=[]),f.ref&&v.push(f.ref,null,d),v.push(h,d.__c||p,d)),null!=p?(null==g&&(g=p),"function"==typeof d.type&&d.__k===f.__k?d.__d=u=Jp(d,u,t):u=Qp(t,d,f,y,p,u),"function"==typeof n.type&&(n.__d=u)):u&&f.__e==u&&u.parentNode!=t&&(u=Yp(f))}for(n.__e=g,c=m;c--;)null!=y[c]&&sg(y[c],y[c]);if(v)for(c=0;c<v.length;c++)og(v[c],v[++c],v[++c])}function Jp(t,e,n){for(var r,i=t.__k,a=0;i&&a<i.length;a++)(r=i[a])&&(r.__=t,e="function"==typeof r.type?Jp(r,e,n):Qp(n,r,r,i,r.__e,e));return e}function Qp(t,e,n,r,i,a){var o,s,u;if(void 0!==e.__d)o=e.__d,e.__d=void 0;else if(null==n||i!=a||null==i.parentNode)t:if(null==a||a.parentNode!==t)t.appendChild(i),o=null;else{for(s=a,u=0;(s=s.nextSibling)&&u<r.length;u+=1)if(s==i)break t;t.insertBefore(i,a),o=a}return void 0!==o?o:i.nextSibling}function tg(t,e,n){"-"===e[0]?t.setProperty(e,n):t[e]=null==n?"":"number"!=typeof n||Lp.test(e)?n:n+"px"}function eg(t,e,n,r,i){var a;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof r&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||tg(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||tg(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])a=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+a]=n,n?r||t.addEventListener(e,a?rg:ng,a):t.removeEventListener(e,a?rg:ng,a);else if("dangerouslySetInnerHTML"!==e){if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null==n||!1===n&&-1==e.indexOf("-")?t.removeAttribute(e):t.setAttribute(e,n))}}function ng(t){this.l[t.type+!1](Ip.event?Ip.event(t):t)}function rg(t){this.l[t.type+!0](Ip.event?Ip.event(t):t)}function ig(t,e,n,r,i,a,o,s,u){var l,c,h,f,d,p,g,v,y,m,x,b,w,k,M,_=e.type;if(void 0!==e.constructor)return null;null!=n.__h&&(u=n.__h,s=e.__e=n.__e,e.__h=null,a=[s]),(l=Ip.__b)&&l(e);try{t:if("function"==typeof _){if(v=e.props,y=(l=_.contextType)&&r[l.__c],m=l?y?y.props.value:l.__:r,n.__c?g=(c=e.__c=n.__c).__=c.__E:("prototype"in _&&_.prototype.render?e.__c=c=new _(v,m):(e.__c=c=new Up(v,m),c.constructor=_,c.render=ug),y&&y.sub(c),c.props=v,c.state||(c.state={}),c.context=m,c.__n=r,h=c.__d=!0,c.__h=[],c._sb=[]),null==c.__s&&(c.__s=c.state),null!=_.getDerivedStateFromProps&&(c.__s==c.state&&(c.__s=Bp({},c.__s)),Bp(c.__s,_.getDerivedStateFromProps(v,c.__s))),f=c.props,d=c.state,h)null==_.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==_.getDerivedStateFromProps&&v!==f&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(v,m),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(v,c.__s,m)||e.__v===n.__v){for(c.props=v,c.state=c.__s,e.__v!==n.__v&&(c.__d=!1),c.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach((function(t){t&&(t.__=e)})),x=0;x<c._sb.length;x++)c.__h.push(c._sb[x]);c._sb=[],c.__h.length&&o.push(c);break t}null!=c.componentWillUpdate&&c.componentWillUpdate(v,c.__s,m),null!=c.componentDidUpdate&&c.__h.push((function(){c.componentDidUpdate(f,d,p)}))}if(c.context=m,c.props=v,c.__v=e,c.__P=t,b=Ip.__r,w=0,"prototype"in _&&_.prototype.render){for(c.state=c.__s,c.__d=!1,b&&b(e),l=c.render(c.props,c.state,c.context),k=0;k<c._sb.length;k++)c.__h.push(c._sb[k]);c._sb=[]}else do{c.__d=!1,b&&b(e),l=c.render(c.props,c.state,c.context),c.state=c.__s}while(c.__d&&++w<25);c.state=c.__s,null!=c.getChildContext&&(r=Bp(Bp({},r),c.getChildContext())),h||null==c.getSnapshotBeforeUpdate||(p=c.getSnapshotBeforeUpdate(f,d)),M=null!=l&&l.type===Vp&&null==l.key?l.props.children:l,Zp(t,Array.isArray(M)?M:[M],e,n,r,i,a,o,s,u),c.base=e.__e,e.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else null==a&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=function(t,e,n,r,i,a,o,s){var u,l,c,h=n.props,f=e.props,d=e.type,p=0;if("svg"===d&&(i=!0),null!=a)for(;p<a.length;p++)if((u=a[p])&&"setAttribute"in u==!!d&&(d?u.localName===d:3===u.nodeType)){t=u,a[p]=null;break}if(null==t){if(null===d)return document.createTextNode(f);t=i?document.createElementNS("http://www.w3.org/2000/svg",d):document.createElement(d,f.is&&f),a=null,s=!1}if(null===d)h===f||s&&t.data===f||(t.data=f);else{if(a=a&&Ep.call(t.childNodes),l=(h=n.props||zp).dangerouslySetInnerHTML,c=f.dangerouslySetInnerHTML,!s){if(null!=a)for(h={},p=0;p<t.attributes.length;p++)h[t.attributes[p].name]=t.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===t.innerHTML)||(t.innerHTML=c&&c.__html||""))}if(function(t,e,n,r,i){var a;for(a in n)"children"===a||"key"===a||a in e||eg(t,a,null,n[a],r);for(a in e)i&&"function"!=typeof e[a]||"children"===a||"key"===a||"value"===a||"checked"===a||n[a]===e[a]||eg(t,a,e[a],n[a],r)}(t,f,h,i,s),c)e.__k=[];else if(p=e.props.children,Zp(t,Array.isArray(p)?p:[p],e,n,r,i&&"foreignObject"!==d,a,o,a?a[0]:n.__k&&Yp(n,0),s),null!=a)for(p=a.length;p--;)null!=a[p]&&Hp(a[p]);s||("value"in f&&void 0!==(p=f.value)&&(p!==t.value||"progress"===d&&!p||"option"===d&&p!==h.value)&&eg(t,"value",p,h.value,!1),"checked"in f&&void 0!==(p=f.checked)&&p!==t.checked&&eg(t,"checked",p,h.checked,!1))}return t}(n.__e,e,n,r,i,a,o,u);(l=Ip.diffed)&&l(e)}catch(t){e.__v=null,(u||null!=a)&&(e.__e=s,e.__h=!!u,a[a.indexOf(s)]=null),Ip.__e(t,e,n)}}function ag(t,e){Ip.__c&&Ip.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){Ip.__e(t,e.__v)}}))}function og(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){Ip.__e(t,n)}}function sg(t,e,n){var r,i;if(Ip.unmount&&Ip.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||og(r,null,e)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){Ip.__e(t,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&sg(r[i],e,n||"function"!=typeof t.type);n||null==t.__e||Hp(t.__e),t.__=t.__e=t.__d=void 0}function ug(t,e,n){return this.constructor(t,n)}function lg(t,e,n){var r,i,a;Ip.__&&Ip.__(t,e),i=(r="function"==typeof n)?null:n&&n.__k||e.__k,a=[],ig(e,t=(!r&&n||e).__k=$p(Vp,null,[t]),i||zp,zp,void 0!==e.ownerSVGElement,!r&&n?[n]:i?null:e.firstChild?Ep.call(e.childNodes):null,a,!r&&n?n:i?i.__e:e.firstChild,r),ag(a,t)}function cg(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.createElement,i=void 0===r?document.createElement.bind(document):r,a=Xd(),o={transform:void 0},s=Kd();return s.element=function(){return t},s.root=function(){return t},s.settings=function(t){return t&&Object.keys(o).forEach((function(e){void 0!==t[e]&&(o[e]=t[e])})),o},s.appendTo=function(e){return t||((t=i("div")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),e.appendChild(t),t},s.render=function(n){if(!t)return!1;var r,i="function"==typeof o.transform&&o.transform();if(i){var s=i.a,u=i.b,l=i.c,c=i.d,h=i.e,f=i.f;return t.style.transform="matrix(".concat(s,", ").concat(u,", ").concat(l,", ").concat(c,", ").concat(h,", ").concat(f,")"),!0}return t.style.transform="",t.style.left="".concat(a.computedPhysical.x,"px"),t.style.top="".concat(a.computedPhysical.y,"px"),t.style.width="".concat(a.computedPhysical.width,"px"),t.style.height="".concat(a.computedPhysical.height,"px"),r=Array.isArray(n)?$p("div",null,n):n,e=lg(r,t,e),!0},s.renderArgs=[$p],s.clear=function(){if(t){for(var n=t.firstChild;n;)t.removeChild(n),n=t.firstChild;e=null}return s},s.destroy=function(){t&&t.parentElement&&t.parentElement.removeChild(t),t=null,e=null},s.size=function(t){return t&&(a=Xd(t)),a},s}Ep=Fp.slice,Ip={__e:function(t,e,n,r){for(var i,a,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((a=i.constructor)&&null!=a.getDerivedStateFromError&&(i.setState(a.getDerivedStateFromError(t)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(t,r||{}),o=i.__d),o)return i.__E=i}catch(e){t=e}throw t}},Tp=0,Up.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Bp({},this.state),"function"==typeof t&&(t=t(Bp({},n),this.props)),t&&Bp(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),Kp(this))},Up.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Kp(this))},Up.prototype.render=Vp,jp=[],Gp.__r=0;var hg=[function(t){t.renderer("svg",Op)},function(t){t.renderer("canvas",sp)},function(t){t.renderer("dom",cg)}],fg={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},dg=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.level,r=void 0===n?fg.OFF:n,i=e.pipe,a=void 0===i?console:i,o=r,s=(D(t={},fg.OFF,(function(){})),D(t,fg.ERROR,(function(){return a.error.apply(a,arguments)})),D(t,fg.WARN,(function(){return a.warn.apply(a,arguments)})),D(t,fg.INFO,(function(){return a.info.apply(a,arguments)})),D(t,fg.DEBUG,(function(){return a.log.apply(a,arguments)})),t),u=function(t){if(t&&!(o<t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(s[t]||s[fg.DEBUG]).apply(void 0,n)}};return{log:u,error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[fg.ERROR].concat(e))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[fg.WARN].concat(e))},info:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[fg.INFO].concat(e))},debug:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u.apply(void 0,[fg.DEBUG].concat(e))},level:function(t){return"number"==typeof t&&(o=t),o},LOG_LEVEL:fg}};function pg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;t(n,e)}var gg=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=dg(e.logger),i={component:ue(n.component,"component",r),data:ue(n.data,"data",r),formatter:ue(n.formatter,"formatter",r),interaction:ue(n.interaction,"interaction",r),renderer:bu(n.renderer),scale:ue(n.scale,"scale",r),symbol:ue(n.symbol,"symbol",r),logger:r};function a(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={palettes:e.palettes.concat(n.palettes||[]),style:M({},e.style,n.style),logger:n.logger||e.logger,renderer:n.renderer||e.renderer};return t(r,i)}return e.renderer&&e.renderer.prio&&i.renderer.default(e.renderer.prio[0]),a.use=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return pg(t,e,i)},a.chart=function(t){return xu(t,{registries:i,logger:r,style:e.style,palettes:e.palettes})},a.config=function(){return e},Object.keys(i).forEach((function(t){a[t]=i[t]})),a.version=_,a}({renderer:{prio:["svg","canvas"]},logger:{level:0},style:{"$font-family":"'Source Sans Pro', Arial, sans-serif","$font-size":"12px","$line-height":"16px","$font-size--l":"16px","$font-weight":"normal","$gray-100":"#ffffff","$gray-98":"#f9f9f9","$gray-95":"#f2f2f2","$gray-90":"#e6e6e6","$gray-35":"#595959","$gray-30":"#4d4d4d","$gray-25":"#404040","$gray-20":"#333333","$border-95":"rgba(255, 255, 255, 0.05)","$border-90":"rgba(255, 255, 255, 0.1)","$border-80":"rgba(255, 255, 255, 0.2)","$border-20":"rgba(0, 0, 0, 0.2)","$border-10":"rgba(0, 0, 0, 0.1)","$border-5":"rgba(0, 0, 0, 0.05)","$primary-blue":"#3F8AB3","$primary-green":"#6CB33F","$primary-red":"#DC423F","$primary-orange":"#EF960F","$spacing--s":4,$spacing:8,"$spacing--l":12,"$font-color":"$gray-35","$font-color--inverted":"$gray-90","$guide-color":"$gray-90","$guide-color--inverted":"$gray-35",$border:"$border-80","$border--inverted":"$border-10",$shape:{fill:"$primary-blue",strokeWidth:1,stroke:"$border"},"$shape-outline":{stroke:"$primary-blue",strokeWidth:2},"$shape-guide":{stroke:"$guide-color",strokeWidth:1},"$shape-guide--inverted":{"@extend":"$shape-guide",stroke:"$guide-color--inverted"},$label:{fontSize:"$font-size",fontFamily:"$font-family",fill:"$font-color"},"$label--inverted":{$extend:"$label",fill:"$font-color--inverted"},"$label-overlay":{fontSize:"$font-size--l",fontFamily:"$font-family",fill:"$gray-100",color:"$font-color",stroke:"$guide-color--inverted",strokeWidth:1,borderRadius:4},$title:{"@extend":"$label",fontSize:"$font-size--l",fontWeight:"$font-weight",stroke:"$guide-color--inverted",strokeWidth:0},"$guide-line":{strokeWidth:1,stroke:"$guide-color"},"$guide-line--minor":{strokeWidth:1,stroke:"$gray-95"},"$padding--s":{left:"$spacing--s",right:"$spacing--s",top:"$spacing--s",bottom:"$spacing--s"},$padding:{left:"$spacing",right:"$spacing",top:"$spacing",bottom:"$spacing"},"$selection-area-target":{fill:"$primary-green",strokeWidth:0,opacity:.2}},palettes:[{key:"categorical",colors:[["#a54343","#d76c6c","#ec983d","#ecc43d","#f9ec86","#cbe989","#70ba6e","#578b60","#79d69f","#26a0a7","#138185","#65d3da"]]},{key:"diverging",colors:[["#3d52a1","#3a89c9","#77b7e5","#b4ddf7","#e6f5fe","#ffe3aa","#f9bd7e","#ed875e","#d24d3e","#ae1c3e"]]},{key:"sequential",colors:[["rgb(180,221,212)","rgb(34, 83, 90)"]]}]},{component:wu,data:Ru,formatter:wr,interaction:qu,renderer:bu(),scale:Ya,symbol:us});function vg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yg(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vg(Object(n),!0).forEach((function(e){kg(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function mg(t){return(mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ag(r.key),r)}}function wg(t,e,n){return e&&bg(t.prototype,e),n&&bg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kg(t,e,n){return(e=Ag(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mg(t,e){return(Mg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Sg(t,e,n){return(Sg=_g()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Mg(i,n.prototype),i}).apply(null,arguments)}function Cg(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(t,e)||qg(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rg(t){return function(t){if(Array.isArray(t))return Ng(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||qg(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qg(t,e){if(t){if("string"==typeof t)return Ng(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ng(t,e):void 0}}function Ng(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ag(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}Rf.forEach(gg.use),hg.forEach(gg.use),[].forEach(gg.use);var Dg=Object.prototype.hasOwnProperty,Og=Object.prototype.toString,Eg=Object.defineProperty,Ig=Object.getOwnPropertyDescriptor,Tg=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Og.call(t)},jg=function(t){if(!t||"[object Object]"!==Og.call(t))return!1;var e,n=Dg.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Dg.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||Dg.call(t,e)},Pg=function(t,e){Eg&&"__proto__"===e.name?Eg(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},zg=function(t,e){if("__proto__"===e){if(!Dg.call(t,e))return;if(Ig)return Ig(t,e).value}return t[e]},Fg=function t(){var e,n,r,i,a,o,s=arguments[0],u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=zg(s,n),s!==(i=zg(e,n))&&(c&&i&&(jg(i)||(a=Tg(i)))?(a?(a=!1,o=r&&Tg(r)?r:[]):o=r&&jg(r)?r:{},Pg(s,{name:n,newValue:t(c,o,i)})):void 0!==i&&Pg(s,{name:n,newValue:i}));return s};function Lg(t,e,n){if(!t)return-1;var r=n.cache,i=t.origin?t.origin():null;i&&(t=i);var a=r.fields.indexOf(t),o=-1,s=-1;if(-1===a)for(var u=0;u<r.wrappedFields.length;u++)if(s=r.wrappedFields[u].attrDims.map((function(t){return t.instance})).indexOf(t),o=r.wrappedFields[u].attrExps.map((function(t){return t.instance})).indexOf(t),-1!==s||-1!==o){a=u;break}return(a-=e.qArea.qLeft)<0||a>=e.qArea.qWidth?-1:s>=0?function(t){return t[a].qAttrDims.qValues[s]}:o>=0?function(t){return t[a].qAttrExps.qValues[o]}:function(t){return t[a]}}function Bg(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function Hg(t){var e=t.cache,n=t.f,r=t.mainCell,i=t.p;t.prop;var a=t.page,o=t.rowIdx,s=t.row,u=t.sourceKey,l=t.target,c=t.targetProp,h=r;if(i.field&&i.field!==n){var f=Lg(i.field,a,{cache:e});if(-1===f)return;h=Fg({qRow:o},f(s))}l[c]=Bg(i,h,{key:u})}function $g(t,e,n,r){for(var i=Array.isArray(t)?t:[t],a=[],o=0;o<i.length;o++)if(void 0!==i[o].field){for(var s=e.raw(),u=e.key(),l="object"===mg(i[o].field)?i[o].field:e.field(i[o].field),c=r.normalizeConfig(i[o],e),h=c.props,f=c.main,d=Object.keys(h),p=!!i[o].trackBy,g=mg(i[o].trackBy),v={},y=[],m=[],x=0;x<s.qDataPages.length;x++){var b=Lg(l,s.qDataPages[x],{cache:n});if(-1!==b)for(var w=0;w<s.qDataPages[x].qMatrix.length;w++){var k=s.qDataPages[x].qArea.qTop+w,M=Fg({qRow:k},b(s.qDataPages[x].qMatrix[w])),_=Bg(f,M,{key:u});if(!(f.filter&&!f.filter(M))){for(var S=0;S<d.length;S++){var C=h[d[S]],R=C.fields||[C];C.fields&&(_[d[S]]=[]);for(var q=0;q<R.length;q++)Hg({cache:n,f:l,mainCell:M,p:R[q],prop:d[S],props:h,page:s.qDataPages[x],rowIdx:k,row:s.qDataPages[x].qMatrix[w],sourceKey:u,target:C.fields?_[d[S]]:_,targetProp:C.fields?q:d[S]});if(C.fields){var N=_[d[S]].map((function(t){return t.value})),A=_[d[S]].map((function(t){return t.label}));_[d[S]]={value:"function"==typeof C.value?C.value(N):void 0!==C.value?C.value:N,label:"function"==typeof C.label?C.label(A):void 0!==C.label?String(C.label):String(_[d[S]].value)}}}p&&r.track({cfg:i[o],itemData:M,obj:_,target:y,tracker:v,trackType:g}),m.push(_)}}}var D=p?r.collect(y,{main:f,propsArr:d,props:h}):m;a=[].concat(Rg(a),Rg(D))}return a}function Wg(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Vg(t,e){var n,r,i,a,o,s=new Kg(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=Ug);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)l.push(r=n.children[a]=new Kg(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Xg)}function Ug(t){return t.children}function Yg(t){t.data=t.data.data}function Xg(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Kg(t){this.data=t,this.depth=this.height=0,this.parent=null}function Gg(t){if("function"!=typeof t)throw new Error;return t}Kg.prototype=Vg.prototype={constructor:Kg,count:function(){return this.eachAfter(Wg)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Vg(this).eachBefore(Yg)}};var Zg={depth:-1},Jg={};function Qg(t){return t.id}function tv(t){return t.parentId}function ev(t,e){"/"===t.charAt(0)&&(t=t.substring(1));for(var n,r=t.split("/"),i=e,a=0;a<r.length;a++){if("*"===r[a]&&Array.isArray(i)){var o=[];n=r.slice(a+1).join("/");for(var s=0;s<i.length;s++){var u=ev(n,i[s]);Array.isArray(u)?o.push.apply(o,Rg(u)):o.push(u)}return o}if(!r[a]&&Array.isArray(i)){var l=new Array(i.length);n=r.slice(a+1).join("/");for(var c=0;c<i.length;c++)l[c]=ev(n,i[c]);return l}r[a]in i&&(i=i[r[a]])}return i}function nv(t,e,n){var r=[];if(!t||!t.length)return r;if(e<=0){var i=n>=0?[t[n]]:t;r=[].concat(Rg(r),Rg(i))}else for(var a=0;a<t.length;a++)t[a].children&&t[a].children.length&&(r=[].concat(Rg(r),Rg(nv(t[a].children,e-1,n))));return r}function rv(t,e,n){if(t===e)return function(t){return t};if(t>e){var r=Math.max(0,Math.min(100,t-e));return function(t){for(var e=t,n=0;n<r;++n)e=e.parent;return e}}if(e>t){var i=Math.max(0,Math.min(100,e-t));return function(t){return nv(t.children,i-1,n)}}return!1}function iv(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];var r=n.allFields;if("function"==typeof t){for(var i=0;i<r.length;i++)if(t(r[i]))return r[i];return!1}if("string"==typeof t){for(var a=0;a<r.length;a++)if(r[a].key()===t||r[a].title()===t)return r[a]}else if(t&&-1!==r.indexOf(t))return t;throw Error("Field not found: ".concat(t))}var av=/^qDimensionInfo(?:\/(\d+))?/,ov=/^\/?qMeasureInfo\/(\d+)/,sv=/\/qAttrExprInfo\/(\d+)/,uv=/\/qAttrDimInfo\/(\d+)/;function lv(t){return(t.qColumnOrder&&t.qColumnOrder.length?t.qColumnOrder:t.qDimensionInfo.map((function(t,e){return e}))).filter((function(e){return e<t.qDimensionInfo.length}))}function cv(t,e){var n=e.cube;if(!t)return-1;var r=t.origin&&t.origin()?t.origin().key():t.key(),i=!1,a=-1,o=-1,s=-1,u=-1,l=-1,c=r,h=n.qEffectiveInterColumnSortOrder,f=lv(n);return av.test(c)&&(i=!0,a=+av.exec(c)[1],c=r.replace(av,"")),ov.test(c)&&("K"===n.qMode?u=+ov.exec(c)[1]:h&&-1!==h.indexOf(-1)?(u=+ov.exec(c)[1],l=0):l=+ov.exec(c)[1],c=c.replace(ov,"")),c&&(uv.exec(c)?s=+uv.exec(c)[1]:sv.exec(c)&&(o=+sv.exec(c)[1])),{fieldDepth:(i?"S"===n.qMode?f[a]:h?h.indexOf(a):a:h&&-1!==h.indexOf(-1)?h.indexOf(-1):n.qDimensionInfo.length-("K"===n.qMode?0:1))+1,pseudoMeasureIndex:u,measureIdx:l,attrDimIdx:s,attrIdx:o}}function hv(t,e){var n,r,i=rv(t.fieldDepth,e.fieldDepth,e.pseudoMeasureIndex);return n=e.measureIdx>=0?function(t){return t.data.qValues[e.measureIdx]}:function(t){return t.data},e.attrDimIdx>=0?r=function(t){var n;return null==t||null===(n=t.qAttrDims)||void 0===n?void 0:n.qValues[e.attrDimIdx]}:e.attrIdx>=0&&(r=function(t){var n;return null==t||null===(n=t.qAttrExps)||void 0===n?void 0:n.qValues[e.attrIdx]}),{nodeFn:i,attrFn:r,valueFn:n}}function fv(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function dv(t){for(var e=t.propsArr,n=t.props,r=t.item,i=t.itemData,a=t.ret,o=t.sourceKey,s=0;s<e.length;s++){var u=n[e[s]],l=u.fields||[u],c=void 0,h=void 0;u.fields&&(c=[],h=[]);for(var f=function(t){var n=l[t],f=void 0,d=void 0,p=void 0,g=void 0,v=void 0,y=void 0;if("primitive"===n.type?(p=n.value,y=String(n.value)):("function"==typeof n.value&&(f=function(t){return n.value(t,r)}),"function"==typeof n.label&&(d=function(t){return n.label(t,r)}),n.accessor?(g=n.accessor(r),Array.isArray(g)?(v=g.map(n.valueAccessor),n.attrAccessor&&(v=v.map(n.attrAccessor)),f&&(p=v.map(f),f=null),d&&(y=v.map(d),d=null),p=n.reduce?n.reduce(p):p,y=n.reduceLabel?n.reduceLabel(y,p):String(p)):y=p=n.attrAccessor?n.attrAccessor(n.valueAccessor(g)):n.valueAccessor(g)):(p=i,y=i)),u.fields){var m=f?f(p):p;c.push(m),h.push(d&&null!=y?d(y):null!=y?y:String(m))}else{var x=f?f(p):p;a[e[s]]={value:x,label:d?d(y):null!=y?y:String(x)},n.field&&(a[e[s]].source={field:n.field.key(),key:o})}},d=0;d<l.length;d++)f(d);c&&(a[e[s]]={value:"function"==typeof u.value?u.value(c,r):c,label:"function"==typeof u.label?u.label(h,r):h})}}var pv=function(t,e,n){var r="K"===t.qMode?"/qStackedDataPages/*/qData":"/qTreeDataPages/*",i="K"===t.qMode?"qSubNodes":"qNodes",a=ev(r,t);return a&&a[0]?(e.tree=Vg(a[0],n.children||function(t){return t[i]}),e.tree):null};function gv(t){for(var e=t.raw().qDataPages.length?t.raw().qDataPages[0].qMatrix:[],n=function(t){var e=t.raw().qColumnOrder,n=t.fields();return e&&e.length===n.length?e:n.map((function(t,e){return e}))}(t),r=t.fields(),i=t.fields().filter((function(t){return"dimension"===t.type()})).map((function(t){return n.indexOf(r.indexOf(t))})),a=t.fields().filter((function(t){return"measure"===t.type()})).map((function(t){return n.indexOf(r.indexOf(t))})),o={__root:{__id:"__root",qValues:[]}},s=0;s<e.length;s++){for(var u=e[s],l="__root",c=!1,h=0;h<i.length;h++){var f,d=u[i[h]],p="".concat(l,"__").concat(null!==(f=d.qElemNumber)&&void 0!==f?f:d.qElemNo);o[p]||(o[p]=yg({__id:p,__parent:l,qValues:[]},d),c=!0),l=p}if(c)for(var g=0;g<a.length;g++){var v=u[a[g]];o[l].qValues.push(v)}}var y=Object.keys(o).map((function(t){return o[t]}));return function(){var t=Qg,e=tv;function n(n){var r,i,a,o,s,u,l,c=n.length,h=new Array(c),f={};for(i=0;i<c;++i)r=n[i],s=h[i]=new Kg(r),null!=(u=t(r,i,n))&&(u+="")&&(f[l="$"+(s.id=u)]=l in f?Jg:s);for(i=0;i<c;++i)if(s=h[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(o=f["$"+u]))throw new Error("missing: "+u);if(o===Jg)throw new Error("ambiguous: "+u);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=Zg,a.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(Xg),a.parent=null,c>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=Gg(e),n):t},n.parentId=function(t){return arguments.length?(e=Gg(t),n):e},n}().id((function(t){return t.__id})).parentId((function(t){return t.__parent}))(y)}var vv=function(t){for(var e=t.propsArr,n=t.props,r=t.cube,i=t.cache,a=t.itemDepthObject,o=t.f,s=0;s<e.length;s++)for(var u=n[e[s]],l=u.fields?u.fields:[u],c=0;c<l.length;c++){var h=l[c];if(h.field!==o){var f=hv(a,cv(h.field,{cube:r,cache:i}));h.accessor=f.nodeFn,h.valueAccessor=f.valueFn,h.attrAccessor=f.attrFn}}};function yv(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=e.raw(),a=e.key(),o="S"===i.qMode?gv(e):pv(i,n,t);if(!o)return null;for(var s=o.height,u=[],l=0;l<=s;l++){var c=null;if(l>0)if("S"===i.qMode){var h=lv(i),f=h[l-1];c=n.fields[f]}else{var d=i.qEffectiveInterColumnSortOrder[l-1];l>i.qEffectiveInterColumnSortOrder.length&&(d=i.qDimensionInfo.length),c=n.fields[d]}var p=r.normalizeConfig(yg(yg({},t),{},{field:c?c.key():void 0}),e),g=p.props,v=p.main,y=Object.keys(g);u[l]={propsArr:y,props:g,main:v};var m=c?cv(c,{cube:i,cache:n}):{fieldDepth:0};vv({propsArr:y,props:g,cube:i,cache:n,itemDepthObject:m,f:c})}for(var x=o.copy(),b=x.descendants(),w=o.descendants(),k=0;k<w.length;k++){var M=u[w[k].depth].propsArr,_=u[w[k].depth].props,S=u[w[k].depth].main,C=b[k],R=C.data,q=fv(S,R,{key:a});dv({propsArr:M,props:_,item:C,itemData:R,ret:q,sourceKey:a,isTree:!0}),w[k].data=q}return o}function mv(t,e,n,r){for(var i=Array.isArray(t)?t:[t],a=[],o=0;o<i.length;o++)if(void 0!==i[o].field){var s=e.raw(),u=e.key();if(!pv(s,n,t))continue;var l="object"===mg(i[o].field)?i[o].field:e.field(i[o].field),c=r.normalizeConfig(i[o],e),h=c.props,f=c.main,d=Object.keys(h),p=cv(l,{cube:s,cache:n}),g=hv({fieldDepth:0},p),v=g.nodeFn,y=g.attrFn,m=g.valueFn;vv({propsArr:d,props:h,cube:s,cache:n,itemDepthObject:p,f:l});for(var x=!!i[o].trackBy,b=mg(i[o].trackBy),w={},k=[],M=v(n.tree),_=[],S=0;S<M.length;S++){var C=M[S],R=y?y(m(C)):m(C);if(!(f.filter&&!f.filter(R))){var q=fv(f,R,{key:u});dv({propsArr:d,props:h,item:C,itemData:R,ret:q,sourceKey:u}),x&&r.track({cfg:i[o],itemData:R,obj:q,target:k,tracker:w,trackType:b}),_.push(q)}}var N=x?r.collect(k,{main:f,propsArr:d,props:h}):_;a=[].concat(Rg(a),Rg(N))}return a}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var xv=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){
/*! javascript-number-formatter - v1.1.11 - http://mottie.github.com/javascript-number-formatter/ * © ecava */
t.exports=function(t,e){if(!t||isNaN(+e))return e;var n,r,i,a,o,s,u,l,c,h,f=t.length,d=t.search(/[0-9\-\+#]/),p=d>0?t.substring(0,d):"",g=t.split("").reverse().join(""),v=g.search(/[0-9\-\+#]/),y=f-v,m=t.substring(y,y+1),x=y+("."===m||","===m?1:0),b=v>0?t.substring(x,f):"";if(n=(e="-"===(t=t.substring(d,x)).charAt(0)?-e:+e)<0?e=-e:0,i=(r=t.match(/[^\d\-\+#]/g))&&r[r.length-1]||".",a=r&&r[1]&&r[0]||",",t=t.split(i),e=+(e=e.toFixed(t[1]&&t[1].length))+"",s=t[1]&&t[1].lastIndexOf("0"),(!(l=e.split("."))[1]||l[1]&&l[1].length<=s)&&(e=(+e).toFixed(s+1)),c=t[0].split(a),t[0]=c.join(""),(o=t[0]&&t[0].indexOf("0"))>-1)for(;l[0].length<t[0].length-o;)l[0]="0"+l[0];else 0==+l[0]&&(l[0]="");if((e=e.split("."))[0]=l[0],u=c[1]&&c[c.length-1].length){for(g="",y=(h=e[0]).length%u,f=h.length,x=0;x<f;x++)g+=h.charAt(x),!((x-y+1)%u)&&x<f-u&&(g+=a);e[0]=g}return e[1]=t[1]&&e[1]?i+e[1]:"","0"!==(r=e.join(""))&&""!==r||(n=!1),p+(n?"-":"")+r+b}}));function bv(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}var wv={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},kv=/%\)?$/,Mv=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,_v=/^\(oct\)/i,Sv=/^\(dec\)/i,Cv=/^\(hex\)/i,Rv=/^\(bin\)/i,qv=/^\(rom\)/i,Nv=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i,Av=/#|0/g;function Dv(t,e,n,r){return t=t.toString(e),n[1]===n[1].toUpperCase()&&(t=t.toUpperCase()),t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11)),t.replace(".",r||".")}function Ov(t,e,n){var r;return Mv.test(e)?t=Dv(t,Number(/\d{2}/.exec(e)[0]),e,n):_v.test(e)?t=Dv(t,8,e,n):Sv.test(e)?t=Dv(t,10,e,n):Cv.test(e)?t=Dv(t,16,e,n):Rv.test(e)?t=Dv(t,2,e,n):qv.test(e)&&(r="",t<0&&(r="-",t=-t),t=0===(t=Math.floor(t))?"0":t<=5e5?r+(t=function(t,e){for(var n,r="",i=Number(String(t).slice(-3)),a=(t-i)/1e3,o=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),s=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();i>0;)for(n=0;n<o.length;n++)if(o[n]<=i){r+=s[n],i-=o[n];break}for(n=0;n<a;n++)r="M".concat(r);return e[1]!==e[1].toUpperCase()&&(r=r.toLowerCase()),r}(t,e)):e+r+t.toExponential(0)),t}function Ev(t,e,n){var r=bv(t);return n?r:new RegExp(r||"",e)}function Iv(t,e,n,r){var i,a,o,s,u,l,c,h,f,d,p,g=t.pattern;r&&(t.abbreviate=!0),d=e,(p=n)&&(p=bv(p)),d&&(d=bv(d)),f=new RegExp("(?:[#0]+".concat(d,")?[#0]+(?:").concat(p,"[#0]+)?")),s=(o=(o=g.match(f))?o[0]:"")?g.substr(0,g.indexOf(o)):g,u=o?g.substring(g.indexOf(o)+o.length):"",o||(o=g?"#":"##########"),e&&e===n&&(a=(i=o.split(n)).pop(),o=i.join("")+n+a,e=""),l=e,e=/,/.test(n)?"¤":",",l&&(o=o.replace(Ev(l,"g"),e)),c=n,n=".",c&&(o=o.replace(Ev(c,"g"),n)),h=(h=o.match(/#/g))?h.length:0;var v,y=g.split(c);y[1]&&(v=y[1].match(Av)),t.prefix=s||"",t.postfix=u||"",t.pattern=g,t.maxPrecision=v?v.length:2,t.percentage=kv.test(g),t.numericPattern=o||"",t.numericRegex=new RegExp("".concat(Ev(e,null,!0),"|").concat(Ev(n,null,!0)),"g"),t.groupTemp=l,t.decTemp=c,t.t=e,t.d=n,t.temp=h}var Tv=function(){function t(e,n,r,i,a){xg(this,t),this.localeInfo=e,this.pattern=n,this.thousandDelimiter=r||",",this.decimalDelimiter=i||".",this.type=a||"numeric",this.patternSeparator=";",this.abbreviations=function(t,e){if(!t||!t.qNumericalAbbreviation)return wv;var n={};return t.qNumericalAbbreviation.split(e).forEach((function(t){var e=t.split(":");2===e.length&&(n[e[0]]=e[1])})),n}(e,this.patternSeparator),this.prepare()}return wg(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e,n,r){return this.prepare(e,n,r),this.formatValue(t)}},{key:"prepare",value:function(t,e,n){var r;if(void 0===t&&(t=this.pattern),void 0===e&&(e=this.thousandDelimiter),void 0===n&&(n=this.decimalDelimiter),t){this._prepared={positive:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},zero:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},r=this._prepared,t=t.split(this.patternSeparator),r.positive.pattern=t[0],r.negative.pattern=t[1],r.zero.pattern=t[2],Nv.test(t[0])&&(r.positive.isFunctional=!0),t[1]?Nv.test(t[1])&&(r.negative.isFunctional=!0):r.negative=!1,t[2]?Nv.test(t[2])&&(r.zero.isFunctional=!0):r.zero=!1;var i="U"===this.type;r.positive.isFunctional||Iv(r.positive,e,n,i),r.negative&&!r.negative.isFunctional&&Iv(r.negative,e,n,i),r.zero&&!r.zero.isFunctional&&Iv(r.zero,e,n,i)}else this._prepared={pattern:!1}}},{key:"formatValue",value:function(t){var e,n,r,i,a,o,s,u,l,c=this._prepared,h="",f="",d=t;if(isNaN(t))return"".concat(d);if(t=+t,!1===c.pattern)return t.toString();if(0===t&&c.zero)return(c=c.zero).pattern;if(t<0&&c.negative?(c=c.negative,t=-t):c=c.positive,a=c.d,o=c.t,c.isFunctional)t=Ov(t,c.pattern,a);else{if(c.percentage&&(t*=100),c.abbreviate){var p,g,v=Object.keys(this.abbreviations).map((function(t){return parseInt(t,10)})).sort((function(t,e){return t-e})),y=v[0];for(s=0,n=Number(Number(t).toExponential().split("e")[1]);y<=n&&s<v.length;)y=v[++s];s>0&&(p=v[s-1]),p&&n>0&&p>0?g=p:(n<0&&p<0||!p)&&(y<0&&y-n<=c.maxPrecision?g=y:p<=n&&!(y>0&&-n<=c.maxPrecision)&&(g=p)),g&&(h=this.abbreviations[g],t/=Math.pow(10,g))}if(r=Math.abs(t),e=c.temp,l=(u=c.numericPattern).split(a)[1],"I"===this.type&&(t=Math.round(t)),i=t,l||"#"!==u.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)t=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var m=Number(t.toFixed(Math.min(20,l?l.length:0)).split(".")[0]),x=u.split(a)[0];if(t=xv(x+=a,m)||"0",l){var b=Math.max(0,Math.min(14,l.length)),w=l.replace(/#+$/,"").length,k=("I"===this.type?0:r%1).toFixed(b).slice(2).replace(/0+$/,"");for(s=k.length;s<w;s++)k+="0";k&&(t+=a+k)}else 0===m&&(i=0)}else if(r>=Math.pow(10,e)||r<1||r<1e-4)0===t?t="0":r<1e-4||r>=1e20?(t=(t=i.toExponential(Math.max(1,Math.min(14,e))-1)).replace(/\.?0+(?=e)/,""),f=""):(t=t.toPrecision(Math.max(1,Math.min(14,e)))).indexOf(".")>=0&&(t=(t=t.replace(t.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"")).replace(".",a));else{for(u+=a,e=Math.max(0,Math.min(20,e-Math.ceil(Math.log(r)/Math.log(10)))),s=0;s<e;s++)u+="#";t=xv(u,t)}t=t.replace(c.numericRegex,(function(t){return t===o?c.groupTemp:t===a?c.decTemp:""})),i<0&&!/^-/.test(t)&&(t="-".concat(t))}return c.prefix+t+f+h+c.postfix}}],[{key:"getStaticFormatter",value:function(){return{prepare:function(){},formatValue:function(t){return"".concat(t)}}}}]),t}();function jv(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.size,a=void 0===i?5e3:i,o=r.multipleArguments,s=void 0!==o&&o,u=r.toKey,l=void 0===u?function(t){return t}:u,c=Object.create(null),h=Object.create(null),f=0,d=0;return(e=s?function(){return n=l.apply(void 0,arguments),e.has(n)?e.get(n):e.set(n,t.apply(void 0,arguments))}:function(r){return n=l(r),e.has(n)?e.get(n):e.set(n,t(r))}).set=function(t,e){return f>=a&&(delete c[h[d]],delete h[d],f--,d++),c[t]=e,h[f]=t,f++,e},e.get=function(t){return c[t]},e.has=function(t){return t in c},e.clear=function(){c=Object.create(null),h=Object.create(null),f=0,d=0},e.size=function(){return f},e}function Pv(t,e,n,r,i){var a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Sg(Tv,e)}(i,t,e,n,r),o=jv(a.formatValue.bind(a),{toKey:function(t){return isNaN(t)?t:+t}});function s(t){return o(t)}return s.format=function(t,e,n,r){return o.clear(),a.format(e,t,n,r)},s.pattern=function(t){return t&&(o.clear(),a.pattern=t,a.prepare()),a.pattern},s}var zv="D",Fv="T",Lv="TS",Bv="IV",Hv=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],$v=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Wv=["January","February","March","April","May","June","July","August","September","October","November","December"],Vv=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Uv(t,e){for(var n=t.length;n<e;n++)t="0".concat(t);return t}function Yv(t){var e=t.toString().split(".");return e[1]?e=Number("0.".concat(e[1])):0}function Xv(t,e){var n,r=function(t){var e=t,n=24*Yv(e),r=60*Yv(n),i=60*Yv(r),a=1e3*Yv(i);return{d:Math.floor(e),h:Math.floor(n),m:Math.floor(r),s:Math.floor(i),f:Math.round(a)}}(t),i=r.d,a=r.h,o=r.m,s=r.s,u=r.f,l=0;/w+|t+/gi.test(e)&&(n=new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,Math.round(86400*(t-Math.floor(t))))),isNaN(n.getTime())&&(n=null)),/D+/gi.test(e)||(a+=24*i),/h+/gi.test(e)||(o+=60*a),/m+/gi.test(e)||(s+=60*o),/w+/gi.test(e)&&(l=n?n.getDay()-1:0)<0&&(l=6);var c="";return n&&(c=n.getUTCHours()>=12?"pm":"am"),{year:0,month:0,day:l,date:i,h:a,m:o,s:s,f:u,t:c}}var Kv=function(){function t(e,n,r){xg(this,t);var i,a=e||{};(a.qCalendarStrings||(a.qCalendarStrings={qLongDayNames:Hv,qDayNames:$v,qLongMonthNames:Wv,qMonthNames:Vv}),this.localeInfo=a,this.locale_days=a.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=a.qCalendarStrings.qDayNames.slice(),this.locale_months=a.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=a.qCalendarStrings.qMonthNames.slice(),n)||(n=(kg(i={},Fv,a.qTimeFmt||"hh:mm:ss"),kg(i,zv,a.qDateFmt||"YYYY-MM-DD"),kg(i,Lv,a.qTimestampFmt||"YYYY-MM-DD hh:mm:ss"),i)[r]);this.pattern=n}return wg(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e){e||(e=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),e=e.replace(/\[.+]|\[|]/g,"");var n,r=/t+/gi.test(e);t instanceof Date?n=function(t,e){var n=t.getUTCHours(),r=t.getUTCDay()-1;return e&&((n%=12)||(n=12)),r<0&&(r=6),{year:t.getUTCFullYear(),month:t.getUTCMonth(),day:r,date:t.getUTCDate(),h:n,m:t.getUTCMinutes(),s:t.getUTCSeconds(),f:t.getUTCMilliseconds(),t:t.getUTCHours()>=12?"pm":"am"}}(t,r):(t<0&&(t=-t,e="-".concat(e)),n=Xv(t,e));var i=function(t,e){return{"Y+|y+":{Y:"".concat(Number("".concat(e.year).slice(-2))),YY:Uv("".concat(e.year).slice(-2),2),YYY:Uv("".concat(e.year).slice(-3),3),def:function(t){return Uv("".concat(e.year),t.length)}},"M+":{M:e.month+1,MM:Uv("".concat(e.month+1),2),MMM:t.locale_months_abbr[e.month],def:t.locale_months[e.month]},"W+|w+":{W:e.day,WW:Uv("".concat(e.day),2),WWW:t.locale_days_abbr[e.day],def:t.locale_days[e.day]},"D+|d+":{D:e.date,def:function(t){return Uv("".concat(e.date),t.length)}},"h+|H+":{h:e.h,def:function(t){return Uv("".concat(e.h),t.length)}},"m+":{m:e.m,def:function(t){return Uv("".concat(e.m),t.length)}},"s+|S+":{s:e.s,def:function(t){return Uv("".concat(e.s),t.length)}},"f+|F+":{def:function(t){var n="".concat(e.f),r=t.length-n.length;if(r>0)for(var i=0;i<r;i++)n+="0";else r<0&&(n=n.slice(0,t.length));return n}},"t{1,2}|T{1,2}":{def:function(t){var n=e.t;return t[0].toUpperCase()===t[0]&&(n=n.toUpperCase()),n.slice(0,t.length)}}}}(this,n),a=[];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.push(o);var s=new RegExp(a.join("|"),"g");return e.replace(s,(function(t){var e,n,r;for(n in i)if(Object.prototype.hasOwnProperty.call(i,n)&&(e=new RegExp(n)).test(t))break;if(!e)return"";for(var a in i[n])if(a===t||a.toLowerCase()===t){void 0===(r=i[n][a])&&(r=i[n][a.toLowerCase()]);break}return void 0===r&&(r=i[n].def),"function"==typeof r&&(r=r(t)),r}))}}]),t}();function Gv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Sg(Kv,e)}function Zv(t){return new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,0,Math.round(864e5*(t-Math.floor(t)))))}function Jv(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TS",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=Gv(n,t,e),i=jv(r.format.bind(r),{toKey:function(t){return"object"===mg(t)&&"function"==typeof t.getTime?t.getTime():t}});function a(t){return e!==Bv?Zv(t):t}function o(t){return t=a(t),i(t)}return o.format=function(t,e){return i.clear(),e=a(e),r.format(e,t)},o.locale=function(n){return r=Gv(n,t,e),i=jv(r.format.bind(r),{toKey:function(t){return"object"===mg(t)?t.getTime():t}}),this},o.qtype=function(t){return void 0!==t&&(e=t,i.clear()),e},o}function Qv(t,e){if(t&&t.qNumFormat&&-1!==["D","T","TS","IV"].indexOf(t.qNumFormat.qType))return Jv(t.qNumFormat.qFmt,t.qNumFormat.qType,e);var n="#",r=e&&void 0!==e.qThousandSep?e.qThousandSep:",",i=e&&void 0!==e.qDecimalSep?e.qDecimalSep:".",a="U",o=t&&!!t.qIsAutoFormat;return t&&t.qNumFormat?(n=t.qNumFormat.qFmt||n,r=t.qNumFormat.qThou||r,i=t.qNumFormat.qDec||i,a=t.qNumFormat.qType||a,o=o&&-1===["M"].indexOf(t.qNumFormat.qType)):o=!0,(o||"U"===a)&&(n="#".concat(i,"##"),a="U"),Pv(n,r,i,a,e)}function ty(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.meta,r=e.id,i=e.key,a=e.localeInfo,o=e.fieldExtractor,s=e.value,u=e.type,l=e.sourceField,c=s||("dimension"===u?function(t){return t.qElemNo}:function(t){return t.qValue}),h=function(t){return t.qText||""},f="dimension"===u?"first":"avg",d=Qv(n,a),p="dimension"===u?"first":function(t,e){return d(e)},g={id:function(){return r},key:function(){return i},raw:function(){return n},title:function(){return n.qFallbackTitle||n.label},type:function(){return u},origin:function(){return l},items:function(){return t||(t=o(g)),t},min:function(){return n.qMin},max:function(){return n.qMax},value:c,label:h,reduce:f,reduceLabel:p,formatter:function(){return d},tags:function(){return n.qTags}};return g}function ey(t,e,n,r,i){return(e[t]||[]).map((function(e,a){var o="".concat(r?"".concat(r,"/"):"").concat(t,"/").concat(a),s={instance:ty(Fg({id:"".concat(n?"".concat(n,"/"):"").concat(o),key:o,meta:e},i))};return s.attrDims=ey("qAttrDimInfo",e,n,o,Fg({},i,{value:function(t){return t.qElemNo},type:"dimension"})),s.attrExps=ey("qAttrExprInfo",e,n,o,Fg({},i,{value:function(t){return t.qNum},type:"measure"})),s.measures=ey("qMeasureInfo",e,n,o,Fg({},i,{value:function(t){return t.qValue},type:"measure"})),s}))}function ny(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.key,a=r.data,o=r.config,s=void 0===o?{}:o,u={fields:[],wrappedFields:[],allFields:[],virtualFields:[]},l=a;if(!l)throw new Error('Missing "data" input');if(!l.qDimensionInfo)throw new Error('The "data" input is not recognized as a hypercube');var c=ny.util,h={cache:u,cube:l,localeInfo:s.localeInfo,fieldExtractor:null,pages:null,hierarchy:function(){return null},virtualFields:s.virtualFields},f={key:function(){return i},raw:function(){return l},field:function(t){return iv(t,h)},fields:function(){return u.fields.slice()},extract:function(t){return h.extractor(t,f,u,c)},hierarchy:function(t){return h.hierarchy(t,f,u,c)},_cache:function(){return u}};"K"===l.qMode||"T"===l.qMode||!l.qMode&&l.qNodesOnDim?(h.extractor=mv,h.hierarchy=yv,h.pages="K"===l.qMode?l.qStackedDataPages:l.qTreeDataPages):"S"===l.qMode?(h.extractor=$g,h.pages=l.qDataPages,h.hierarchy=yv):h.extractor=function(){return[]},h.fieldExtractor=function(t){return h.extractor({field:t},f,u,c)};var d="S"===l.qMode?function(t){return t.qElemNumber}:void 0,p="S"===l.qMode?function(t){return t.qNum}:void 0;(t=u.wrappedFields).push.apply(t,Rg(ey("qDimensionInfo",l,i,"",Fg({},h,{value:d,type:"dimension"})))),(e=u.wrappedFields).push.apply(e,Rg(ey("qMeasureInfo",l,i,"",Fg({},h,{value:p,type:"measure"})))),u.fields=u.wrappedFields.map((function(t){return t.instance}));var g=function t(e){e.forEach((function(e){u.allFields.push(e.instance),t(e.measures),t(e.attrDims),t(e.attrExps)}))};return g(u.wrappedFields),(s.virtualFields||[]).forEach((function(t){var e=f.field(t.from),n=ty(yg({meta:e.raw(),id:"".concat(i,"/").concat(t.key),sourceField:e,fieldExtractor:function(t){return h.extractor({field:t},f,u,c)},key:t.key,type:e.type(),localeInfo:h.localeInfo,value:e.value},t.override||{}));u.virtualFields.push(n)})),(n=u.allFields).push.apply(n,Rg(u.virtualFields)),f}var ry=[["qHyperCube","qHyperCubeDef"],["qTreeData","qTreeDataDef"],["qDimensionInfo","qDimensions"],["qMeasureInfo","qMeasures"],["qAttrDimInfo","qAttributeDimensions"],["qAttrExprInfo","qAttributeExpressions"]],iy=/\/qDimensionInfo(?:\/(\d+))?/,ay=/\/qMeasureInfo\/(\d+)/,oy=/\/qAttrDimInfo\/(\d+)(?:\/(\d+))?/,sy=/\/qAttrExprInfo\/(\d+)/,uy=/\/?qHyperCube/,ly=/\/?qTreeData/,cy=function(t){return"".concat(t.substr(0,t.indexOf("/qHyperCubeDef")+14))},hy=function(t){return"".concat(t.substr(0,t.indexOf("/qTreeDataDef")+13))};function fy(t,e){var n=t,r=-1,i=-1,a="",o=function(t){return t};uy.test(t)?(a="".concat(n.substr(0,n.indexOf("qHyperCube")+10)),o=cy):ly.test(t)&&(a="".concat(n.substr(0,n.indexOf("qTreeData")+9)),o=hy);var s=!0;if(iy.test(t)&&(r=+iy.exec(t)[1]),ay.test(t)&&(i=+ay.exec(t)[1]),oy.test(t)){i=-1,r=0;var u=+oy.exec(n)[2];isNaN(u)||(r=u,n=n.replace(/\/\d+$/,"")),s=!1}if(sy.test(t)){var l=i;if(e){i=0;var c=ev(a,e);i+=(c.qMeasureInfo||[]).length,r>-1?(i=c.qDimensionInfo.slice(0,r).reduce((function(t,e){return t+e.qAttrExprInfo.length}),i),r=-1):(i=c.qDimensionInfo.reduce((function(t,e){return t+e.qAttrExprInfo.length}),i),i=c.qMeasureInfo.slice(0,l).reduce((function(t,e){return t+e.qAttrExprInfo.length}),i)),i+=+sy.exec(n)[1]}else r>-1?(r=-1,i=+sy.exec(n)[1]):i+=+sy.exec(n)[1]+1}return ry.forEach((function(t){var e=Cg(t,2),r=e[0],i=e[1];n=n.replace(r,i)})),s&&(n=o(n)),n&&"/"!==n[0]&&(n="/".concat(n)),{measureIdx:i,dimensionIdx:r,path:n}}function dy(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=n.byCells,a=n.primarySource,o=[],s={},u=t.isActive(),l=!1;if(t.brushes().forEach((function(t){var e=fy(t.id,r);if("range"===t.type&&e.measureIdx>-1&&e.dimensionIdx>-1){var n=t.brush.ranges();n.length&&(l=!0,s.multiRangeSelectTreeDataValues||(s.multiRangeSelectTreeDataValues={path:e.path,ranges:[]}),n.forEach((function(t){return s.multiRangeSelectTreeDataValues.ranges.push({qMeasureIx:e.measureIdx,qDimensionIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})})))}else{if("range"===t.type&&e.measureIdx>-1){var u=t.brush.ranges();u.length&&(l=!0,s.rangeSelectHyperCubeValues||(s.rangeSelectHyperCubeValues={path:e.path,ranges:[]}),u.forEach((function(t){return s.rangeSelectHyperCubeValues.ranges.push({qMeasureIx:e.measureIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})})))}if("range"===t.type&&e.dimensionIdx>-1){var c=t.brush.ranges();c.length&&(l=!0,s.selectHyperCubeContinuousRange||(s.selectHyperCubeContinuousRange={path:e.path,ranges:[]}),c.forEach((function(t){return s.selectHyperCubeContinuousRange.ranges.push({qDimIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!1}})})))}if("value"===t.type&&e.dimensionIdx>-1)if(i)if(r&&r.qHyperCube&&("P"===r.qHyperCube.qMode||"T"===r.qHyperCube.qMode||"K"===r.qHyperCube.qMode)){var h=r.qHyperCube,f=h.qNoOfLeftDims,d=h.qEffectiveInterColumnSortOrder.indexOf(e.dimensionIdx);if(s.selectPivotCells||(s.selectPivotCells={path:e.path,cells:[]}),t.id===a||!a){var p=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)}));(0===f||d>=f)&&f>-1?p.forEach((function(t){s.selectPivotCells.cells.push({qType:"T",qCol:t,qRow:d-f})})):p.forEach((function(t){s.selectPivotCells.cells.push({qType:"L",qCol:e.dimensionIdx,qRow:t})})),l=!!s.selectPivotCells.cells.length}}else s.selectHyperCubeCells||(s.selectHyperCubeCells={path:e.path,cols:[]}),s.selectHyperCubeCells.cols.push(e.dimensionIdx),t.id!==a&&(a||s.selectHyperCubeCells.values)||(s.selectHyperCubeCells.values=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)})),l=!!s.selectHyperCubeCells.values.length);else{var g=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)}));l=!!g.length,o.push({params:[e.path,e.dimensionIdx,g,!1],method:"selectHyperCubeValues"})}}})),!l&&u)return[{method:"resetMadeSelections",params:[]}];s.rangeSelectHyperCubeValues&&o.push({method:"rangeSelectHyperCubeValues",params:[s.rangeSelectHyperCubeValues.path,s.rangeSelectHyperCubeValues.ranges,[],null===(e=n.orMode)||void 0===e||e]});return s.selectHyperCubeContinuousRange&&o.push({method:"selectHyperCubeContinuousRange",params:[s.selectHyperCubeContinuousRange.path,s.selectHyperCubeContinuousRange.ranges]}),s.selectHyperCubeCells&&o.push({method:"selectHyperCubeCells",params:[s.selectHyperCubeCells.path,s.selectHyperCubeCells.values,s.selectHyperCubeCells.cols]}),s.selectPivotCells&&o.push({method:"selectPivotCells",params:[s.selectPivotCells.path,s.selectPivotCells.cells]}),s.multiRangeSelectTreeDataValues&&o.push({method:"multiRangeSelectTreeDataValues",params:[s.multiRangeSelectTreeDataValues.path,s.multiRangeSelectTreeDataValues.ranges]}),o}function py(t){ny.util=t.data("matrix").util,t.data("q",ny),t.formatter("q-number",Pv),t.formatter("q-time",Jv)}py.qBrushHelper=dy,py.selections=dy;const gy={fill:"steelblue",num:1},vy=.9,yy=150,my=(t,e,n)=>{let r=0,i=0,a=0,o={},s=0;if("labelCenter"===t)r=e.bottomLeft.x,i=e.topRight.y,a=e.bottomRight.x-e.bottomLeft.x,s=e.bottomRight.y-e.topRight.y,o={share:n.share,fill:n.fill};else{const t=180/Math.PI*Math.atan((e.bottomRight.y-e.topRight.y)/(e.topRight.x-e.bottomRight.x));r=t<15&&t>=0?e.topRight.x:t>-15&&t<0?e.bottomRight.x:t<-15?(e.bottomRight.x-e.topRight.x)/2+e.topRight.x+15:(e.topRight.x-e.bottomRight.x)/2+e.bottomRight.x+15,i=e.topRight.y,a=e.width-r,s=e.bottomRight.y-e.topRight.y,o={fill:n.fill}}return{tag:t,type:"rect",x:r,y:i,width:a,height:s,data:n.data,desc:o,fill:"none"}},xy=(t,e)=>{const n=(t=>{const e=(t=>{let e=0;return t.forEach((t=>{t.num>e&&(e=t.num)})),e})(t);let n=0;return t.slice().reverse().map((t=>{const r={datum:t,s:n/e,e:t.num/e};return n=t.num,r})).reverse()})(t),r=e.width*vy,i=e.height*vy,a=(e.width-r)/2,o=(e.height-i)/2,s=r-(r>yy&&i>yy?100:0),u=(i-1*(n.length-1))/n.length,l=[];return n.forEach(((t,r)=>{const i=(c=t.e,h=r<n.length-1?t.s:t.e,[.5-.5*c,.5+.5*c,.5+.5*h,.5-.5*h]).map((t=>Math.round(t*s+a)));var c,h;const f=u*r+1*r+o,d={bottomRight:{x:i[2],y:Math.round(f+u)},bottomLeft:{x:i[3],y:Math.round(f+u)},topRight:{x:i[1],y:Math.round(f)},topLeft:{x:i[0],y:Math.round(f)},width:e.width},p=`M${d.topLeft.x},${d.topLeft.y} L${d.topRight.x},${d.topRight.y} ${d.bottomRight.x},${d.bottomRight.y} ${d.bottomLeft.x},${d.bottomLeft.y}Z`;l.push({tag:"section",type:"path",d:p,data:t.datum.data,fill:t.datum.fill});const g={share:t.e,fill:t.datum.fill,data:t.datum.data};u>12&&(d.bottomRight.x-d.bottomLeft.x>32&&l.push(my("labelCenter",d,g)),l.push(my("labelLeft",d,g)))})),l},by=(t,e,n,r)=>(r-t)/r*(e-n)+n,wy=(t,e,n)=>{const r=t.filter((t=>"NaN"!==t.num&&t.num>0)),i=r.length,a=n.width*vy,o=n.height*vy,s=Math.round((n.width-a)/2),u=Math.round((n.height-o)/2),l=a-(a>yy&&o>yy?100:0),c=o-1*(i-1),h=[],f=r[0].data.num.value;let d=u;return r.forEach(((t,r)=>{const i=e[r]*c,a=Math.round(by(d-u,l,.2*l,o)/2),p=Math.round(by(d-u+i,l,.2*l,o)/2),g=s+Math.round(l/2),v={bottomRight:{x:g+p,y:Math.round(d+i)},bottomLeft:{x:g-p,y:Math.round(d+i)},topRight:{x:g+a,y:d},topLeft:{x:g-a,y:d},width:n.width},y=`M${v.topLeft.x},${v.topLeft.y} L${v.topRight.x},${v.topRight.y} ${v.bottomRight.x},${v.bottomRight.y} ${v.bottomLeft.x},${v.bottomLeft.y}Z`;h.push({tag:"section",type:"path",d:y,data:t.data,fill:t.fill});const m={share:t.data.num.value/f,fill:t.fill,data:t.data};i>2&&(v.bottomRight.x-v.bottomLeft.x>32&&h.push(my("labelCenter",v,m)),h.push(my("labelLeft",v,m))),d+=i+1})),h},ky=(t,e,n)=>{const r=t.filter((t=>"NaN"!==t.num&&t.num>0));if(r&&r.length>0)switch(e){case"WIDTH":return xy(r,n);case"ORDER":return wy(r,r.map((()=>1/r.length)),n);case"HEIGHT":return wy(r,(t=>{const e=t.reduce(((t,e)=>t+e.data.num.value),0);return t.map((t=>t.data.num.value/e))})(r),n);case"AREA":return wy(r,((t,e,n)=>{const r=t.reduce(((t,e)=>t+e.data.num.value),0),i=e.width*vy,a=e.height*vy,o=i*n,s=a*(i+o)/2,u=(i-o)/2/a,l=[];let c=0;for(let e=t.length-1;e>=0;e--){const n=t[e].data.num.value/r,i=2*u*c+o,h=-i/(2*u)+Math.sqrt(i*i/(4*u*u)+n*s/u);l[e]=h/a,c+=h}return l})(r,n,.2),n);default:return xy(r,n)}return[]};var My={require:["resolver"],defaultSettings:{settings:{},data:{},style:{item:"$shape"}},render({data:t}){const e=this.resolver.resolve({data:t,defaults:{...gy,...this.style.item},settings:this.settings.settings});return ky(e.items,this.settings.settings.mode,this.rect)}};const _y={version:"1.5.3",color:{auto:!0,autoMinMax:!0,byDimDef:void 0,byMeasureDef:void 0,colorExpression:void 0,dimensionScheme:"12",expressionIsColor:!0,expressionLabel:"",measureMin:void 0,measureMax:void 0,measureScheme:"sg",mode:"primary",paletteColor:{index:6},persistent:!1,reverseScheme:!1,singleColor:void 0,useBaseColors:"off",useDimColVal:!0,useMeasureGradient:!0},dataPoint:{auto:!0,labelMode:"share"},footnote:"",funnel:{mode:"WIDTH"},qHyperCubeDef:{qDimensions:[],qMeasures:[],qInterColumnSortOrder:[],qInitialDataFetch:[{qWidth:2,qHeight:5e3}],qSuppressMissing:!0,qSuppressZero:!1},showDimensionTitle:!0,showTitles:!0,subtitle:"",title:""};var Sy={definition:{type:"items",component:"accordion",items:{data:{uses:"data",items:{dimensions:{uses:"dimensions",items:{others:{items:{suppressOther:{defaultValue:!0,show:!1}}}},disabledRef:""},measures:{uses:"measures",disabledRef:""}}},sorting:{uses:"sorting"},settings:{uses:"settings",items:{presentation:{type:"items",label:"Presentation",grouped:!0,items:{funnelmode:{ref:"funnel.mode",label:"Funnel Mode",type:"string",component:"dropdown",options:[{value:"AREA",label:"Area"},{value:"HEIGHT",label:"Height"},{value:"WIDTH",label:"Width"},{value:"ORDER",label:"Ordering"}],defaultValue:"WIDTH"},dimensionTitle:{ref:"showDimensionTitle",type:"boolean",component:"switch",label:"Dimension title",defaultValue:!0,options:[{value:!0,label:"Auto"},{value:!1,label:"Off"}]},valuesAuto:{ref:"dataPoint.auto",type:"boolean",label:"Value labels",component:"switch",defaultValue:!0,options:[{value:!0,label:"Auto"},{value:!1,label:"Custom"}]},labelMode:{ref:"dataPoint.labelMode",type:"string",component:"dropdown",options:[{value:"none",label:"None"},{value:"share",label:"Share"},{value:"value",label:"Values"}],defaultValue:"share",show:t=>!t.dataPoint.auto}}},colorsAndLegend:{uses:"colorsAndLegend",translation:"Colors",items:{colors:{items:{colorByLabel:{show:!1},expressionLabel:{show:!1}}},legend:{show:!1}}}}}}},support:{export:!0,exportData:!0,snapshot:!0,viewData:!1},importProperties:null,exportProperties:null};const Cy=[{path:"/qHyperCubeDef",dimensions:{min:1,max:1,description:()=>"Segments"},measures:{min:1,max:1,description(t){switch(t.funnel.mode){case"WIDTH":return"Width";case"AREA":return"Area";case"HEIGHT":return"Height";case"ORDER":return"Order";default:return""}},added(t,e){2===e.qHyperCubeDef.qInterColumnSortOrder.length&&1!==e.qHyperCubeDef.qInterColumnSortOrder[0]&&(e.qHyperCubeDef.qInterColumnSortOrder=[1,0])}}}];function Ry(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qy(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ry(Object(n),!0).forEach((function(e){Ey(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ry(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ny(){Ny=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var a=e&&e.prototype instanceof f?e:f,o=Object.create(a.prototype),s=new S(i||[]);return r(o,"_invoke",{value:w(t,n,s)}),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var h={};function f(){}function d(){}function p(){}var g={};u(g,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(C([])));y&&y!==e&&n.call(y,a)&&(g=y);var m=p.prototype=f.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,a,o,s){var u=c(t[r],t,a);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,s)}),(function(t){i("throw",t,o,s)})):e.resolve(h).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,s)}))}s(u.arg)}var a;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return a=a?a.then(r,r):r()}})}function w(t,e,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=k(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function k(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=c(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function C(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=p,r(m,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:d,configurable:!0}),d.displayName=u(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,o,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new b(l(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(m),u(m,s,"Generator"),u(m,a,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=C,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Ay(t){return(Ay="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dy(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function Oy(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Dy(a,r,i,o,s,"next",t)}function s(t){Dy(a,r,i,o,s,"throw",t)}o(void 0)}))}}function Ey(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iy(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Ty(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(t,e)||Py(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jy(t){return function(t){if(Array.isArray(t))return zy(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Py(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Py(t,e){if(t){if("string"==typeof t)return zy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zy(t,e):void 0}}function zy(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Fy=Object.prototype.hasOwnProperty,Ly=Object.prototype.toString,By=Object.defineProperty,Hy=Object.getOwnPropertyDescriptor,$y=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Ly.call(t)},Wy=function(t){if(!t||"[object Object]"!==Ly.call(t))return!1;var e,n=Fy.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Fy.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||Fy.call(t,e)},Vy=function(t,e){By&&"__proto__"===e.name?By(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},Uy=function(t,e){if("__proto__"===e){if(!Fy.call(t,e))return;if(Hy)return Hy(t,e).value}return t[e]},Yy=function t(){var e,n,r,i,a,o,s=arguments[0],u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=Uy(s,n),s!==(i=Uy(e,n))&&(c&&i&&(Wy(i)||(a=$y(i)))?(a?(a=!1,o=r&&$y(r)?r:[]):o=r&&Wy(r)?r:{},Vy(s,{name:n,newValue:t(c,o,i)})):void 0!==i&&Vy(s,{name:n,newValue:i}));return s};function Xy(t,e){return{range:function(t){var n=t.resources,r=t.data,i=n.theme.palette("categorical",0===e?r.items.length:e);return r.items.map((function(t){return i[t.value%i.length]}))},valueAccessor:t.value}}function Ky(t,e){return{range:function(t){var n=t.resources,r=t.data,i=n.theme.palette("categorical",0===e?r.items.length:e);return r.items.map((function(t){return i[t.row.value%i.length]}))},valueAccessor:t.value}}function Gy(t,e,n,r,i){var a,o,s=i.byRow,u=i.byElemNo;if(r&&(e.input.persistent||t.hc.qDimensionInfo.length>1||void 0===n.activeDimensionIndex&&t.hc.qSize.qcy>((null===(o=(a=t.hc).qDataPages[0]||a.qStackedDataPages[0])||void 0===o?void 0:o.qArea.qHeight)||0)))return u(r,r.raw().qCardinal);if(r){var l=e.pic.extract({field:r.key(),trackBy:r.value}).length;return s(r,l)}return{}}function Zy(t,e){var n=t.hc.qDimensionInfo,r=e.input.byDimDef||{activeDimensionIndex:n.length-1};if(r.activeDimensionIndex>=0){var i=n[r.activeDimensionIndex];r=i.coloring&&i.coloring.colorMapRef?{type:"libraryItem",key:i.coloring.colorMapRef,activeDimensionIndex:r.activeDimensionIndex}:{activeDimensionIndex:r.activeDimensionIndex}}return r}function Jy(t,e){var n;return e.activeDimensionIndex>=0?n=t.pic.fields().filter((function(t){return"dimension"===t.type()}))[e.activeDimensionIndex]:"libraryItem"===e.type?!1===(n=e.key?t.pic.field((function(t){return t.raw().colorMapRef===e.key})):void 0)&&(n=t.pic.field((function(t){return"colorByAlternative"===t.raw().id}))):"expression"===e.type&&(n=t.pic.field((function(t){return"colorByAlternative"===t.raw().id}))),n}function Qy(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function tm(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function em(){}var nm=1/.7,rm="\\s*([+-]?\\d+)\\s*",im="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",am="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",om=/^#([0-9a-f]{3,8})$/,sm=new RegExp("^rgb\\("+[rm,rm,rm]+"\\)$"),um=new RegExp("^rgb\\("+[am,am,am]+"\\)$"),lm=new RegExp("^rgba\\("+[rm,rm,rm,im]+"\\)$"),cm=new RegExp("^rgba\\("+[am,am,am,im]+"\\)$"),hm=new RegExp("^hsl\\("+[im,am,am]+"\\)$"),fm=new RegExp("^hsla\\("+[im,am,am,im]+"\\)$"),dm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function pm(){return this.rgb().formatHex()}function gm(){return this.rgb().formatRgb()}function vm(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=om.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ym(e):3===n?new wm(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?mm(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?mm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=sm.exec(t))?new wm(e[1],e[2],e[3],1):(e=um.exec(t))?new wm(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=lm.exec(t))?mm(e[1],e[2],e[3],e[4]):(e=cm.exec(t))?mm(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=hm.exec(t))?Sm(e[1],e[2]/100,e[3]/100,1):(e=fm.exec(t))?Sm(e[1],e[2]/100,e[3]/100,e[4]):dm.hasOwnProperty(t)?ym(dm[t]):"transparent"===t?new wm(NaN,NaN,NaN,0):null}function ym(t){return new wm(t>>16&255,t>>8&255,255&t,1)}function mm(t,e,n,r){return r<=0&&(t=e=n=NaN),new wm(t,e,n,r)}function xm(t){return t instanceof em||(t=vm(t)),t?new wm((t=t.rgb()).r,t.g,t.b,t.opacity):new wm}function bm(t,e,n,r){return 1===arguments.length?xm(t):new wm(t,e,n,null==r?1:r)}function wm(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function km(){return"#"+_m(this.r)+_m(this.g)+_m(this.b)}function Mm(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function _m(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Sm(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Rm(t,e,n,r)}function Cm(t){if(t instanceof Rm)return new Rm(t.h,t.s,t.l,t.opacity);if(t instanceof em||(t=vm(t)),!t)return new Rm;if(t instanceof Rm)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Rm(o,s,u,t.opacity)}function Rm(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function qm(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Nm(t){return function(){return t}}function Am(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Nm(isNaN(t)?e:t)}Qy(em,vm,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:pm,formatHex:pm,formatHsl:function(){return Cm(this).formatHsl()},formatRgb:gm,toString:gm}),Qy(wm,bm,tm(em,{brighter:function(t){return t=null==t?nm:Math.pow(nm,t),new wm(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new wm(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:km,formatHex:km,formatRgb:Mm,toString:Mm})),Qy(Rm,(function(t,e,n,r){return 1===arguments.length?Cm(t):new Rm(t,e,n,null==r?1:r)}),tm(em,{brighter:function(t){return t=null==t?nm:Math.pow(nm,t),new Rm(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Rm(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new wm(qm(t>=240?t-240:t+120,i,r),qm(t,i,r),qm(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Dm=function t(e){var n=function(t){return 1==(t=+t)?Am:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Nm(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=bm(t)).r,(e=bm(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Am(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1),Om=/^class(-pyramid)?/,Em=function(t,e,n,r){var i=void 0!==n.min?n.min:r.min(),a=void 0!==n.max?n.max:r.max(),o=i,s=a,u=e.limits,l={},c="percent"===e.limitType?u.map((function(t){return i+(a-i)*t})):u,h=e.colors.map((function(e){return t.resolveUIColor(e)}));if(i=Math.min.apply(Math,[i].concat(jy(c))),a=Math.max.apply(Math,[a].concat(jy(c))),l.min=i,l.max=a,e.breakTypes&&-1===e.breakTypes.indexOf(!0))l.type="categorical",Object.assign(l,function(t){var e=t.min,n=t.max,r=t.limits,i=t.range,a=[],o=[];if(r.length)if(r[r.length-1]<e)o.push(e,n),a.push(i[i.length-1],i[i.length-1],i[i.length-1]);else if(r[0]>n)o.push(e,n),a.push(i[0],i[0],i[0]);else{if(r[0]>e)o.push(e),a.push(i[0]);else{o.push(e);for(var s=0;s<r.length;s++)if(e<r[s]){a.push(i[s]);break}}for(var u=0;u<r.length;u++)e<r[u]&&r[u]<n&&(o.push(r[u]),a.push(i[u]));if(r[r.length-1]<n)o.push(n),a.push(i[r.length]),a.push(i[r.length]);else{o.push(n);for(var l=0;l<r.length;l++)if(r[l]>n){a.push(i[l]),a.push(i[l]);break}}}else a.push(i[0]);return{min:e,max:n,range:a,domain:o}}({min:"percent"===e.limitType?i:o,max:"percent"===e.limitType?a:s,range:h,limits:"percent"===e.limitType?c:u}));else if(e.breakTypes){var f=e.breakTypes;l.type="continuous",l.domain=[i],l.range=[h[0]];for(var d=0;d<c.length;d+=1)if(f[d]){var p=h[d],g=h[d+1],v=Dm(p,g)(.5);l.range.push(v),l.domain.push(c[d]),d<c.length-1&&f[d+1]&&(l.range.push(h[d+1]),l.domain.push((c[d]+c[d+1])/2))}else l.range.push(h[d]),l.range.push(h[d+1]),l.domain.push(c[d]),l.domain.push(c[d]+Math.min(1e-6,(a-i)/1e6));l.range.push(h[h.length-1]),l.domain.push(a)}else l.domain=c,l.range=h;return l};function Im(t,e,n,r,i){var a,o,s,u=0,l=[],c=(t-e)/(r+1);if(0===c)return 1;for(a=0;a<n.length;a+=1)o=.99*(n[a]-e),s=n[a]>t?Math.floor(t/c):n[a]<e?0:Math.floor(o/c),Number.isNaN(s)||(l[s]?l[s]+=1:l[s]=1);for(a=0;a<l.length;a+=1)l[a]&&(u+=1);return u<=r||u>=i?Math.max(u,r):Im(t,e,n,r+1,i)}var Tm=function(t,e,n,r){var i,a,o=e.theme,s=e.hc,u=r.f,l={mode:"field",fieldType:"measure",field:u?u.key():void 0,reverse:n.input.reverseScheme||!1,type:"continuous",range:function(t){return t.resources.theme.palette("quant")}},c=[],h=!0;if(u){if(Number.isNaN(+u.min())||Number.isNaN(+u.max()))return{invalid:!0};(h=!("S"===(i=n.pic.raw()).qMode&&(i.qDataPages[0]&&i.qSize.qcy>i.qDataPages[0].qArea.qHeight||!i.qDataPages.length&&i.qSize.qcy>0)||"K"===i.qMode&&i.qStackedDataPages[0]&&i.qSize.qcy>i.qStackedDataPages[0].qArea.qHeight||"T"===i.qMode&&i.qSize.qcy>i.qTreeDataPages[0].qGroupSize))&&(c=n.pic.extract({field:0,props:{num:{field:u.key()},exclude:{fields:s.qDimensionInfo.map((function(t,e){return{field:"qDimensionInfo/".concat(e)}})),value:function(t){return Math.min.apply(Math,jy(t))<0}}}}).filter((function(t){return t.value>=0&&!t.exclude.value})).map((function(t){return t.num.value})).filter((function(t){return"number"==typeof t})))}if(!1===n.input.autoMinMax){if(l.min=n.input.measureMin,l.max=n.input.measureMax,l.max<l.min)return{invalid:!0}}else if(u&&!h)l.min=u.min(),l.max=u.max();else if(u){if(!c.length)return{invalid:!0};l.min=Math.min.apply(Math,jy(c)),l.max=Math.max.apply(Math,jy(c))}if(n.input.measureScheme&&(l.palettes={quant:n.input.measureScheme}),o){var f=o.getDataColorScales().filter((function(t){return t.key===n.input.measureScheme}))[0];l.type=f&&Om.test(f.type)?"categorical":"continuous","categorical"===l.type&&(a=f.colors.some((function(t){return Array.isArray(t)}))?Math.max.apply(Math,jy(f.colors.map((function(t){return t?t.length:0})))):f.colors.length)}if("categorical"===l.type){for(var d=h?Im(l.max,l.min,c,1,a):a,p=(l.max-l.min)/d,g=[],v=0;v<d+1;v+=1)g.push(l.min+p*v);l.domain=g,l.range=function(t){for(var e=t.resources.theme.palette("quant",d),n=Math.max(1,Math.floor(e.length/d)),r=[],i=0;i<d;i+=1)r.push(e[i*n]);return[r[0]].concat(r,[r[r.length-1]])}}return l};function jm(t,e){var n;return e.activeMeasureIndex>=0?n=t.pic.fields().filter((function(t){return"measure"===t.type()}))[e.activeMeasureIndex]:"libraryItem"===e.type?n=t.pic.field((function(t){return t.raw().colorMapRef===e.key&&void 0!==e.key})):"expression"===e.type&&(n=t.pic.field((function(t){return"colorByAlternative"===t.raw().id}))),n||(n=t.pic.field((function(t){return void 0!==t.raw().matchMeasure})))&&(n=t.pic.fields().filter((function(t){return"measure"===t.type()}))[n.raw().matchMeasure]),n}function Pm(t){var e,n=t.cm,r=t.defaults,i=t.index,a=t.input,o=t.pic;if(!a||!a.on)return null;var s=null!==(e=a.mode)&&void 0!==e?e:"primary";return"primary"===s?function(t,e,n){var r=n.primary;return void 0!==e.paletteColor&&e.paletteColor&&(r=t.resolveUIColor(e.paletteColor)),qy(qy({},n),{},{mode:"constant",type:"constant",primary:r})}(n,a,r):"byExpression"===s?function(t,e,n){var r="qMeasureInfo/".concat(t,"/"),i=e.field((function(t){return t.id().startsWith(r)&&"colorByMeasureExpression"===t.raw().id})),a=i;return qy(qy({},n),{},a?{mode:"field",fieldType:"expression",field:i?i.key():void 0,type:"color"}:{mode:"constant",type:"constant",primary:n.nil})}(i,o,r):null}function zm(t){t.measureOverrides.every((function(t){return!t}))&&(t.measureOverrides=null)}function Fm(t,e){for(var n=(null==e?void 0:e.domain)||[],r=(null==e?void 0:e.range)||[],i=[],a=0;a<t.length;++a){var o=t[a];if("constant"===(null==o?void 0:o.mode)){var s=n.indexOf(a);-1===s?(n.push(a),r.push(o.primary)):r[s]=o.primary,t[a]=null}else if(o){i.push(a);var u=n.indexOf(a);-1!==u&&(n.splice(u,1),r.splice(u,1))}}return{domain:n,range:r,exclude:i}}function Lm(t,e,n,r){var i,a=function(t,e,n,r){if(e.input&&!e.input.auto){if("byMeasure"===e.input.mode)return function(t,e,n){var r=e.theme,i=e.hc,a=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).getCField,o=void 0===a?jm:a,s=n.input.byMeasureDef||{activeMeasureIndex:0},u=o(n,s),l=Tm(0,{theme:r,hc:i},n,{f:u});if(l.invalid)return l;"expression"===s.type&&(s.activeMeasureIndex<0||void 0===s.activeMeasureIndex)&&(l.label=s.label,u&&"color.altLabel"===u.raw().labelExpRef&&(l.label=n.input.altLabel)),!l.label&&u&&(l.label=u.title());var c=s.activeMeasureIndex>=0?u:null;if(!c&&u&&void 0!==u.raw().matchMeasure&&u.raw().matchMeasure>-1&&(c=n.pic.fields().filter((function(t){return"measure"===t.type()}))[u.raw().matchMeasure]),n.input.useMeasureGradient&&"libraryItem"===s.type)if(c){var h=c.raw().coloring;h&&h.gradient&&Yy(l,Em(t,h.gradient,l,c))}else l.auxiliary=s;return l}(t,n,e);if("byDimension"===e.input.mode)return function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.getCDef,a=void 0===i?Zy:i,o=r.getCByField,s=void 0===o?Jy:o,u=r.getPersistence,l=void 0===u?Gy:u,c=a(e,n),h=s(n,c),f=h?h.raw():{},d=n&&n.pic?n.pic.raw():{};if(f.qError||f.qSize&&0===f.qSize.qcy&&!d.qHasOtherValues)return{invalid:!0};var p={mode:"field",fieldType:"dimension",type:"categorical",field:h?h.key():void 0,isFieldLocked:f.qLocked};return("expression"===c.type||c.activeDimensionIndex<0)&&(p.label=c.label,"color.altLabel"===f.labelExpRef&&(p.label=n.input.altLabel)),!p.label&&h&&(p.label=h.title()),n.input.dimensionScheme&&(p.palettes={categorical:n.input.dimensionScheme}),n.input.useDimColVal&&"libraryItem"===c.type&&(p.auxiliary=c),Yy(p,l(e,n,c,h,{byRow:Ky,byElemNo:Xy})),p}(t,n,e);if("byExpression"===e.input.mode)return function(t,e,n,r){var i=e.hc,a=e.theme,o=e.translator,s=n.pic.field((function(t){return"colorByExpression"===t.raw().id}));if(!s||!s.raw().qFallbackTitle&&!n.input.colorExpression||!(Number.isFinite(s.raw().qMin)&&Number.isFinite(s.raw().qMax)||n.input.expressionIsColor))return{mode:"constant",type:"constant",primary:r.nil};if(n.input.expressionIsColor)return{mode:"field",fieldType:"expression",field:s?s.key():void 0,type:"color"};var u=Tm(0,{hc:i,theme:a},n,{f:s});return u.invalid||(u.label=n.input.expressionLabel||o.get("Object.ChartTooltip.ColorExpression")),u}(0,n,e,r);if("byMultiple"===e.input.mode||"primary"===e.input.mode)return function(t,e,n,r){var i=e.hc,a=e.theme,o=e.translator,s=n.input.useBaseColors;if(("byMultiple"===n.input.mode||"primary"===n.input.mode&&"measure"===n.input.useBaseColors)&&i.qMeasureInfo.length>1&&(s="measure"),"measure"===s){var u=[],l=[];"measure"===n.input.useBaseColors&&i.qMeasureInfo.forEach((function(e,n){if(e.baseColor||e.coloring&&e.coloring.baseColor){u.push(n);var i=t.resolveUIColor(e.baseColor||e.coloring.baseColor);"none"===i?l.push(r.primary):l.push(i)}}));var c=n.input.dimensionScheme?{categorical:n.input.dimensionScheme}:void 0,h=a?a.getDataColorPalettes()[0]:void 0;return"measure"===n.input.useBaseColors&&h&&(c={categorical:h.key}),{mode:"measure",type:"categorical",palettes:c,label:o?o.get("Common.Measures"):void 0,explicit:u.length?{domain:u,range:l}:void 0}}if("dimension"===s){var f=[],d=[];return i.qDimensionInfo.forEach((function(e,n){if(e.baseColor||e.coloring&&e.coloring.baseColor){f.push(n);var i=t.resolveUIColor(e.baseColor||e.coloring.baseColor);"none"===i?d.push(r.primary):d.push(i)}})),{mode:"dimension",type:"categorical",field:f.length?f[0]:void 0,explicit:f.length?{domain:f,range:d}:void 0}}var p=r.primary;if(void 0!==n.input.paletteColor)n.input.paletteColor&&(p=t.resolveUIColor(n.input.paletteColor));else{var g=n.input.singleColor;"number"!=typeof g||Number.isNaN(g)||(p=["#b0afae","#7b7a78","#545352","#4477aa","#7db8da","#b6d7ea","#46c646","#f93f17","#ffcf02","#276e27","#ffffff","#000000"][g])}return{mode:"constant",type:"constant",primary:p}}(t,n,e,r)}return{}}(t,e,n,r);return null!==(i=e.input)&&void 0!==i&&i.measureOverrides?(a.measureOverrides=e.input.measureOverrides.map((function(n,i){return Pm({cm:t,input:n,defaults:r,index:i,pic:e.pic})})),function(t,e){var n,r,i,a=e.translator;if(zm(t),1===(null===(n=t.measureOverrides)||void 0===n?void 0:n.length))return t.measureOverrides[0];if("measure"===t.mode&&t.measureOverrides&&(t.explicit=Fm(t.measureOverrides,t.explicit),zm(t)),null!==(r=t.measureOverrides)&&void 0!==r&&r.every((function(t){return"constant"===(null==t?void 0:t.mode)}))){var o={mode:"measure",type:"categorical",label:null==a?void 0:a.get("Common.Measures")};return o.explicit=Fm(t.measureOverrides),o}return null!==(i=t.measureOverrides)&&void 0!==i&&i.every((function(t){return t}))?{invalid:!0,measureOverrides:t.measureOverrides}:t}(a,n)):a}function Bm(t){var e=qy({hc:null,colorProps:null,layout:null,theme:null},t),n={},r={auto:function(){return{mode:"primary"}},getDimensionColorMap:function(){return Promise.reject()},getMeasure:function(){return Promise.reject()},getAttributeDimension:function(){return Promise.reject()}},i={auto:function(t){return t?(r.auto=t,i):r.auto},getDimensionColorMap:function(t){return t?(r.getDimensionColorMap=t,i):r.getDimensionColorMap},getAttributeDimension:function(t){return t?(r.getAttributeDimension=t,i):r.getAttributeDimension},getMeasure:function(t){return t?(r.getMeasure=t,i):r.getMeasure},set:function(t){var i;if(!t.colorProps)throw new Error('Missing "colorProps"');if(Yy(e,t),(n={pic:e.picasso.data("q")({data:e.hc,config:{localeInfo:e.localeInfo}}),input:e.colorProps}).input.auto){var a=r.auto(t.layout);n.input=Yy(!0,{},n.input,a,{auto:!1});var o=e.theme?e.theme.getDataColorPalettes():[];o[0]&&(n.input.dimensionScheme=o[0].key);var s=0;n.input.byDimDef&&+n.input.byDimDef.activeDimensionIndex>=0&&(s=+n.input.byDimDef.activeDimensionIndex),e.hc&&e.hc.qDimensionInfo[s]&&e.hc.qDimensionInfo[s].coloring&&e.hc.qDimensionInfo[s].coloring.colorMapRef&&n.input.byDimDef&&(n.input.byDimDef.type="libraryItem",n.input.byDimDef.key=e.hc.qDimensionInfo[s].coloring.colorMapRef)}null!==(i=n.input.measureOverrides)&&void 0!==i&&i.every((function(t){return!t||!t.on}))&&(n.input=Yy(!1,{},n.input,{measureOverrides:null}))},palettes:function(){if(!n.palettes){var t=e.theme,r=[];(t&&t.getDataColorPickerPalettes()||[]).forEach((function(t){r.push({key:"ui",colors:t.colors})})),n.palettes=r}return n.palettes},getAuxiliaryData:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/qHyperCubeDef";if(!t.auxiliary&&!/qAttrDimInfo/.test(t.field))return Promise.resolve();var i=t.auxiliary||{},a=i.key;if("measure"===t.fieldType)return r.getMeasure(a,e).catch((function(){}));if("dimension"===t.fieldType){var o="".concat(n,"/").concat(t.field).replace("qDimensionInfo","qDimensions").replace("qAttrDimInfo","qAttributeDimensions");return Promise.all([/qAttrDimInfo/.test(t.field)?r.getAttributeDimension(o,e).catch((function(){})):Promise.resolve(),a?r.getDimensionColorMap(a,e).catch((function(){})):Promise.resolve()])}return Promise.resolve()},getAuxiliarySettings:function(t,r){var i=this;return t.auxiliary||/qAttrDimInfo/.test(t.field)?(this.palettes(),this.getAuxiliaryData(t,r).then((function(r){if(!r)return{};if("measure"===t.fieldType){if(r.coloring&&r.coloring.gradient){var a=n.pic.field(t.field);return Em(i,r.coloring.gradient,t,a)}return{}}if("dimension"===t.fieldType){var o={nil:t.nil,others:t.others},s=r[0],u=r[1]?r[1].colorMap:null;if(s){var l=e.picasso.data("q")({data:{qDimensionInfo:[n.pic.field(t.field).raw(),n.pic.field(t.field).raw()],qMeasureInfo:[],qDataPages:s,qInterColumnSortOrder:[0,1],qMode:"S"}});o.legendDataset=l}return u?function(t,e,n,r){var i=r.external,a=r.field,o=qy({},t);Yy(o,Xy(a,a.raw().qCardinal));var s=i.theme?i.theme.getDataColorPalettes()[0]:null;return e.nul&&(o.nil=n.resolveUIColor(e.nul)),e.oth&&(o.others=n.resolveUIColor(e.oth)),e.usePal?(o.palettes={categorical:e.pal},s&&!e.pal&&(o.palettes.categorical=s.key,Yy(o,Xy(a)))):!1===e.autoFill&&e.single?o.range=[n.resolveUIColor(e.single)]:e.autoFill&&(s&&(o.palettes={categorical:s.key}),Yy(o,Xy(a))),e.colors&&e.colors.length&&(o.explicit=function(t,e,n){for(var r={},i=0;i<t.length;i+=1)r[t[i].value]=t[i].baseColor;var a=[];return{domain:function(t){var i=t.data,o=[];a=[];for(var s=0;s<i.items.length;s++){var u=i.items[s],l=(u.text||u).label;r[l]&&-1===o.indexOf(u.value)&&(o.push(u.value),a.push(e.resolveUIColor(r[l])))}return o.push(-3,-2),a.push(n.others),a.push(n.nil),o},range:function(){return a}}}(e.colors,n,o)),o}(o,u,i,{external:e,field:n.pic.field(t.field)}):o}return{}}))):Promise.resolve()},resolveUIColor:function(t){if(t.index<0||void 0===t.index)return t.color;if(void 0===n.uiPalette&&(n.uiPalette=this.palettes().filter((function(t){return"ui"===t.key}))[0]||!1),!n.uiPalette)return t.color;var e="none"===n.uiPalette.colors[0]?t.index:t.index-1;return void 0===n.uiPalette.colors[e]?t.color:n.uiPalette.colors[e]},settings:function(){if(this.palettes(),!n.settings){var t={primary:"steelblue",others:"#aaa",nil:"#ddd"},r=e.theme;r&&(t=qy(qy({},t),r.getDataColorSpecials())),n.settings=Yy(t,Lm(this,n,e,t))}return n.settings}};return i}var Hm=function(t,e){var n=t.fieldType,r={};if(e)if("measure"===n){var i=e.coloring;i&&(r.measureGradient=i.gradient)}else if("dimension"===n){var a=e[0],o=e[1];a&&(r.legendDataPage=a),o&&(r.dimValsData=o.colorMap)}return r},$m=function(t){throw t.isHandled=!0,t},Wm=function(t,e){var n=e.layout,r=e.app;return n&&n.snapshotData?n.snapshotData.content&&n.snapshotData.content.chartData&&n.snapshotData.content.chartData.dimValsData?Promise.resolve({colorMap:n.snapshotData.content.chartData.dimValsData}):Promise.reject():r&&r.getObject?r.getObject("ColorMapModel_".concat(t)).then((function(t){return t.getLayout()})):Promise.reject()},Vm=function(t,e){var n=e.layout,r=e.app;return n&&n.snapshotData?n.snapshotData.content&&n.snapshotData.content.chartData&&n.snapshotData.content.chartData.measureGradient?Promise.resolve({coloring:{gradient:n.snapshotData.content.chartData.measureGradient}}):Promise.reject():r&&r.getMeasure?r.getMeasure(t).then((function(t){return t.getMeasure()})):Promise.reject()},Um=function(t,e){var n=e.layout,r=e.model,i=e.app;return n&&n.snapshotData?n.snapshotData.content&&n.snapshotData.content.chartData&&n.snapshotData.content.chartData.legendDataPage?Promise.resolve(n.snapshotData.content.chartData.legendDataPage):Promise.reject():r&&r.session&&i?r.getHyperCubeData(t,[{qHeight:100,qLeft:0,qTop:0,qWidth:2}]).catch($m):Promise.reject()};function Ym(t){var e=t.hc,n=t.source,r=t.coloring,i={data:{extract:[{source:"dummy",field:0,filter:function(){return i.expando=e.qDataPages[0]?e.qDataPages[0].qArea.qTop:0,!1}},{source:n,field:r.field,trackBy:r.valueAccessor,reduce:"first",props:{row:{reduce:function(){return i.expando++}},text:{value:function(t){return t.qText},reduce:"first"}}}]},expando:0};return i}function Xm(t){return function(e){return"object"===Ay(e.datum[t])?e.datum[t].value:void 0}}function Km(t){return"object"===Ay(t.datum.isNull)?t.datum.isNull.value:-2===t.datum.value}function Gm(t){return-3===t.datum.value}var Zm=function(t,e,n){var r=t&&t.dock||void 0;if("auto"!==r)return r||"right";if(e){var i=e.element.getBoundingClientRect();if(i.height>i.width)return"bottom"}return n?"left":"right"},Jm=function(t,e,n){return!(n.invalid||"color"===n.type||"measure"===n.mode&&e.qMeasureInfo.length<=1||"dimension"===n.mode)&&("function"==typeof t.show?t.show():!1!==t.show)};function Qm(t,e){var n=t.styleReference,r=t.chart,i=t.rtl,a=e.legendProps,o=e.coloring,s=e.theme,u=e.hc;return{layout:{minimumLayoutMode:"MEDIUM",dock:Zm(a,r,i)},show:"function"==typeof a.show?function(){return Jm(a,u,o)}:Jm(a,u,o),renderer:"svg",mounted:function(t){t.childNodes[0].style.pointerEvents="none",t.style.overflow="hidden"},settings:{title:{show:!1!==a.showTitle,wordBreak:"break-word",maxLines:2,lineHeight:1.2,text:o.label||"",fill:s?s.getStyle(n,"legend.title","color"):void 0,fontSize:s?s.getStyle(n,"legend.title","fontSize"):"16px",fontFamily:s?s.getStyle(n,"legend.title","fontFamily"):"'Source Sans Pro', 'Arial', 'sans-serif'"}}}}function tx(t,e,n){return"categorical"===e.coloring.type?function(t,e,n){var r=Qm(t,e);if(!r.show)return!1;var i,a=t.key,o=t.styleReference,s=t.viewState,u=t.rtl,l=t.settings,c=t.style,h=e.scaleKey,f=e.theme,d=e.scales,p=r.layout.dock,g="left"===p||"right"===p?{maxLines:3,wordBreak:"break-word"}:{},v={up:"M13.6,11 L2.4,11 C2.28954305,11 2.2,10.9104569 2.2,10.8 C2.2,10.756726 2.21403557,10.7146192 2.24,10.68 L7.84,3.21333333 C7.90627417,3.12496777 8.03163444,3.10705916 8.12,3.17333333 C8.13516113,3.18470418 8.14862915,3.1981722 8.16,3.21333333 L13.76,10.68 C13.8262742,10.7683656 13.8083656,10.8937258 13.72,10.96 C13.6853808,10.9859644 13.643274,11 13.6,11 Z",down:"M2.4,4 L13.6,4 C13.7104569,4 13.8,4.08954305 13.8,4.2 C13.8,4.24327404 13.7859644,4.28538077 13.76,4.32 L8.16,11.7866667 C8.09372583,11.8750322 7.96836556,11.8929408 7.88,11.8266667 C7.86483887,11.8152958 7.85137085,11.8018278 7.84,11.7866667 L2.24,4.32 C2.17372583,4.23163444 2.19163444,4.10627417 2.28,4.04 C2.31461923,4.01403557 2.35672596,4 2.4,4 Z",left:"M11,2.4 L11,13.6 C11,13.7104569 10.9104569,13.8 10.8,13.8 C10.756726,13.8 10.7146192,13.7859644 10.68,13.76 L3.21333333,8.16 C3.12496777,8.09372583 3.10705916,7.96836556 3.17333333,7.88 C3.18470418,7.86483887 3.1981722,7.85137085 3.21333333,7.84 L10.68,2.24 C10.7683656,2.17372583 10.8937258,2.19163444 10.96,2.28 C10.9859644,2.31461923 11,2.35672596 11,2.4 Z",right:"M4,13.6 L4,2.4 C4,2.28954305 4.08954305,2.2 4.2,2.2 C4.24327404,2.2 4.28538077,2.21403557 4.32,2.24 L11.7866667,7.84 C11.8750322,7.90627417 11.8929408,8.03163444 11.8266667,8.12 C11.8152958,8.13516113 11.8018278,8.14862915 11.7866667,8.16 L4.32,13.76 C4.23163444,13.8262742 4.10627417,13.8083656 4.04,13.72 C4.01403557,13.6853808 4,13.643274 4,13.6 Z"};"dimension"===e.coloring.fieldType&&(i=function(t){return t.datum.value>=0||-3===t.datum.value});var y="".concat(h,"Legend");return Yy(!0,r,{type:"legend-cat",key:"".concat(a,"-cat"),scale:y in d?y:h,settings:{layout:{scrollOffset:function(){return s?s.get("legendScrollOffset"):void 0},size:-1!==["top","bottom"].indexOf(r.layout.dock)?2:1,direction:u?"rtl":"ltr",horizontal:20},item:{show:i,label:qy({fill:f?f.getStyle(o,"legend.label","color"):void 0,fontSize:f?f.getStyle(o,"legend.label","fontSize"):void 0,fontFamily:f?f.getStyle(o,"legend.label","fontFamily"):"'Source Sans Pro', 'Arial', 'sans-serif'"},g)},navigation:{disabled:n,button:{content:function(t,e){var n=e.direction;return t("i",{style:{"pointer-events":"none",fontSize:"12px",display:"inline-block",fontStyle:"normal",lineHeight:"0",textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizelegibility",margin:"0px"}},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:v[n]})])])}}}},brush:{consume:[{context:"selection",data:["",a],style:{inactive:{opacity:.3}}}]}},{settings:l,style:c})}(t,e,n):"continuous"===e.coloring.type&&function(t,e){var n,r=t.key,i=t.styleReference,a=t.rtl,o=t.settings,s=t.style,u=e.scaleKey,l=e.theme,c="".concat(u,"Range"),h=Qm(t,e);if(!h.show)return!1;var f=h.layout.dock,d="right"===f||"left"===f,p=null===(n=e.scales)||void 0===n?void 0:n[c];return d&&p&&(p.invert=!0),Yy(!0,h,{type:"legend-seq",key:"".concat(r,"-seq"),settings:{fill:u,major:c,length:1,tick:{fill:l?l.getStyle(i,"legend.label","color"):void 0,fontSize:l?l.getStyle(i,"legend.label","fontSize"):void 0,fontFamily:l?l.getStyle(i,"legend.label","fontFamily"):"'Source Sans Pro', 'Arial', 'sans-serif'"},title:{anchor:!a||"top"!==h.layout.dock&&"bottom"!==h.layout.dock?void 0:"right",padding:parseFloat(h.settings.title.fontSize)||16}}},{settings:o,style:s})}(t,e)}function ex(t,e,n){var r=[],i=[],a=tx(t,e,n&&n.navigationDisabled);return r.push(a),a&&"legend-cat"===a.type&&(i.push(function(t){var e=t.key,n=t.requireFailure,r=t.recognizeWith,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:tap-".concat(e),type:"Tap",requireFailure:n,recognizeWith:r,options:{event:"legendtap",interval:10,pointers:1,enable:function(t,n){var r;if(!n)return!0;if(null!=i&&null!==(r=i.interact)&&void 0!==r&&r.enabled&&!i.interact.enabled())return!1;if(!this.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some((function(t){return t.key==="".concat(e,"-cat")})))return!1;var a=n.srcEvent.target;return!!(a&&a.hasAttribute("data-action")&&a.hasAttribute("data-component-key"))||!(!a||!a.childNodes[0]||"BUTTON"!==a.childNodes[0].nodeName)}},events:{legendtap:function(t){t.preventDefault();var e=t.srcEvent.target;e&&e.hasAttribute("data-action")&&e.hasAttribute("data-component-key")&&this.chart.component(e.getAttribute("data-component-key")).emit(e.getAttribute("data-action"))}}}}(t,n)),i.push(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.eventName,r=e.key,i=e.requireFailure,a=e.recognizeWith,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:pan-".concat(r),type:"Pan",requireFailure:i,recognizeWith:a,options:{event:n,pointers:1,threshold:10,enable:function(t,e){var i;return this.started===n||!e||!(null!=o&&null!==(i=o.interact)&&void 0!==i&&i.enabled&&!o.interact.enabled())&&this.chart.componentsFromPoint({x:e.center.x,y:e.center.y}).some((function(t){return t.key==="".concat(r,"-cat")}))}},events:(t={},Ey(t,"".concat(n,"start"),(function(t){t.preventDefault(),this.started!==n&&(this.started=n,this.chart.component("".concat(r,"-cat")).emit("panstart",t))})),Ey(t,"".concat(n,"move"),(function(t){t.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panmove",t)})),Ey(t,"".concat(n,"end"),(function(t){t.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panend",t),this.started=!1})),t)}}(t,n))),{interactions:i,components:r}}function nx(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function rx(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ix(){}var ax=1/.7,ox="\\s*([+-]?\\d+)\\s*",sx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ux="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lx=/^#([0-9a-f]{3,8})$/,cx=new RegExp(`^rgb\\(${ox},${ox},${ox}\\)$`),hx=new RegExp(`^rgb\\(${ux},${ux},${ux}\\)$`),fx=new RegExp(`^rgba\\(${ox},${ox},${ox},${sx}\\)$`),dx=new RegExp(`^rgba\\(${ux},${ux},${ux},${sx}\\)$`),px=new RegExp(`^hsl\\(${sx},${ux},${ux}\\)$`),gx=new RegExp(`^hsla\\(${sx},${ux},${ux},${sx}\\)$`),vx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function yx(){return this.rgb().formatHex()}function mx(){return this.rgb().formatRgb()}function xx(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=lx.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?bx(e):3===n?new Mx(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?wx(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?wx(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=cx.exec(t))?new Mx(e[1],e[2],e[3],1):(e=hx.exec(t))?new Mx(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=fx.exec(t))?wx(e[1],e[2],e[3],e[4]):(e=dx.exec(t))?wx(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=px.exec(t))?Nx(e[1],e[2]/100,e[3]/100,1):(e=gx.exec(t))?Nx(e[1],e[2]/100,e[3]/100,e[4]):vx.hasOwnProperty(t)?bx(vx[t]):"transparent"===t?new Mx(NaN,NaN,NaN,0):null}function bx(t){return new Mx(t>>16&255,t>>8&255,255&t,1)}function wx(t,e,n,r){return r<=0&&(t=e=n=NaN),new Mx(t,e,n,r)}function kx(t){return t instanceof ix||(t=xx(t)),t?new Mx((t=t.rgb()).r,t.g,t.b,t.opacity):new Mx}function Mx(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function _x(){return`#${qx(this.r)}${qx(this.g)}${qx(this.b)}`}function Sx(){const t=Cx(this.opacity);return`${1===t?"rgb(":"rgba("}${Rx(this.r)}, ${Rx(this.g)}, ${Rx(this.b)}${1===t?")":`, ${t})`}`}function Cx(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Rx(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function qx(t){return((t=Rx(t))<16?"0":"")+t.toString(16)}function Nx(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Dx(t,e,n,r)}function Ax(t){if(t instanceof Dx)return new Dx(t.h,t.s,t.l,t.opacity);if(t instanceof ix||(t=xx(t)),!t)return new Dx;if(t instanceof Dx)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Dx(o,s,u,t.opacity)}function Dx(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ox(t){return(t=(t||0)%360)<0?t+360:t}function Ex(t){return Math.max(0,Math.min(1,t||0))}function Ix(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}nx(ix,xx,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:yx,formatHex:yx,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ax(this).formatHsl()},formatRgb:mx,toString:mx}),nx(Mx,(function(t,e,n,r){return 1===arguments.length?kx(t):new Mx(t,e,n,null==r?1:r)}),rx(ix,{brighter(t){return t=null==t?ax:Math.pow(ax,t),new Mx(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Mx(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Mx(Rx(this.r),Rx(this.g),Rx(this.b),Cx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_x,formatHex:_x,formatHex8:function(){return`#${qx(this.r)}${qx(this.g)}${qx(this.b)}${qx(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Sx,toString:Sx})),nx(Dx,(function(t,e,n,r){return 1===arguments.length?Ax(t):new Dx(t,e,n,null==r?1:r)}),rx(ix,{brighter(t){return t=null==t?ax:Math.pow(ax,t),new Dx(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Dx(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Mx(Ix(t>=240?t-240:t+120,i,r),Ix(t,i,r),Ix(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Dx(Ox(this.h),Ex(this.s),Ex(this.l),Cx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Cx(this.opacity);return`${1===t?"hsl(":"hsla("}${Ox(this.h)}, ${100*Ex(this.s)}%, ${100*Ex(this.l)}%${1===t?")":`, ${t})`}`}}));const Tx=Math.PI/180,jx=180/Math.PI,Px=4/29,zx=6/29,Fx=3*zx*zx;function Lx(t){if(t instanceof Bx)return new Bx(t.l,t.a,t.b,t.opacity);if(t instanceof Yx)return Xx(t);t instanceof Mx||(t=kx(t));var e,n,r=Vx(t.r),i=Vx(t.g),a=Vx(t.b),o=Hx((.2225045*r+.7168786*i+.0606169*a)/1);return r===i&&i===a?e=n=o:(e=Hx((.4360747*r+.3850649*i+.1430804*a)/.96422),n=Hx((.0139322*r+.0971045*i+.7141733*a)/.82521)),new Bx(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Bx(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Hx(t){return t>.008856451679035631?Math.pow(t,1/3):t/Fx+Px}function $x(t){return t>zx?t*t*t:Fx*(t-Px)}function Wx(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Vx(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ux(t){if(t instanceof Yx)return new Yx(t.h,t.c,t.l,t.opacity);if(t instanceof Bx||(t=Lx(t)),0===t.a&&0===t.b)return new Yx(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*jx;return new Yx(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Yx(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Xx(t){if(isNaN(t.h))return new Bx(t.l,0,0,t.opacity);var e=t.h*Tx;return new Bx(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}nx(Bx,(function(t,e,n,r){return 1===arguments.length?Lx(t):new Bx(t,e,n,null==r?1:r)}),rx(ix,{brighter(t){return new Bx(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new Bx(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Mx(Wx(3.1338561*(e=.96422*$x(e))-1.6168667*(t=1*$x(t))-.4906146*(n=.82521*$x(n))),Wx(-.9787684*e+1.9161415*t+.033454*n),Wx(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),nx(Yx,(function(t,e,n,r){return 1===arguments.length?Ux(t):new Yx(t,e,n,null==r?1:r)}),rx(ix,{brighter(t){return new Yx(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Yx(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Xx(this).rgb()}}));var Kx=function(t){return"rgba(".concat([(16711680&t)>>16,(65280&t)>>8,255&t,((4278190080&t)>>>24)/255].join(","),")")};function Gx(t){var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.auto,n=Bm(t.resources).auto(e||function(){return{mode:"byDimension",persistent:!1,useDimColVal:!0,byDimDef:{activeDimensionIndex:0,type:"expression",label:""}}}).getDimensionColorMap((function(t,e){var n=e.layout,r=e.app;return Wm(t,{layout:n,app:r})})).getMeasure((function(t,e){var n=e.layout,r=e.app;return Vm(t,{layout:n,app:r})})).getAttributeDimension((function(t,e){var n=e.layout,r=e.model,i=e.app;return Um(t,{layout:n,model:r,app:i})}));return n.getSnapshotData=Hm,n}({resources:t}),n={},r={},i=function(t){return r.settings||(t||console.warn("settings() called before auxiliarySettings()"),r.settings=e.settings()),r.settings},a={config:function(i){if(n=qy({},i),r={},!n.key)throw new Error("Missing key");e.set(qy(qy({},t),n))},auto:function(t){return t?(e.auto(t),a):e.auto()},getAuxiliarySettings:function(t){return r.auxiliarySettings?Promise.resolve(r.auxiliarySettings):e.getAuxiliarySettings(i(!0),t).then((function(t){return r.auxiliarySettings=t||{},r.settings=qy(qy({},r.settings),r.auxiliarySettings),r.scales=void 0,r.color=void 0,r.auxiliarySettings}))},getAuxiliaryData:function(){return e.getAuxiliaryData(i())},getSnapshotData:function(t){var n=i();return e.getAuxiliaryData(n,t).then((function(t){return e.getSnapshotData(n,t)}))},resolveUIColor:function(t){return e.resolveUIColor(t)},settings:function(){var t=i();return{mode:t.mode,type:t.type,label:t.label,field:t.field,fieldType:t.fieldType,nil:t.nil,others:t.others,primary:t.primary}},settingsForMeasure:function(t){var e;return(null===(e=i().measureOverrides)||void 0===e?void 0:e[t])||this.settings()},isSelectionLocked:function(t){var e=t.isMeasureSelectionLocked;return function(t,e){var n=e.isMeasureSelectionLocked;return"field"!==t.mode||("dimension"===t.fieldType?t.isFieldLocked:"measure"!==t.fieldType||n)}(i(),{isMeasureSelectionLocked:e})},palettes:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.colorProps,n=t.coloring,r=t.theme,i=[];if(n&&n.palettes&&r){var a=n.palettes.categorical||e.dimensionScheme,o=r.getDataColorPalettes().filter((function(t){return t.key===a}))[0]||r.getDataColorPalettes()[0];a&&o&&i.push({key:"categorical",colors:o.colors});var s=n.palettes.metric||e.measureScheme,u=r.getDataColorScales().filter((function(t){return t.key===s}))[0];if(u){var l=u.colors[0]?u.colors:[[]].concat(jy(u.colors.slice(1)));l=Array.isArray(l[0])?l.map((function(t){return t.slice().reverse()})):l.slice().reverse(),i.push({key:"quant",colors:l})}}return i}({coloring:i(),colorProps:n.colorProps,theme:n.theme})},scales:function(){return r.scales=r.scales||function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.hc,n=t.coloring,r=t.rtl,i=t.key,a=t.source,o=t.picasso,s={},u=i;if(n){var l={override:!0,domain:n.explicit&&"function"==typeof n.explicit.domain?n.explicit.domain:[].concat(jy((n.explicit||{}).domain||[]),[-3,-2]),range:n.explicit&&"function"==typeof n.explicit.range?n.explicit.range:[].concat(jy((n.explicit||{}).range||[]),[n.others,n.nil])};if("field"===n.mode){if("dimension"===n.fieldType){var c,h=Ym({hc:e,source:a,coloring:n}).data;if(n.legendDataset){var f=0,d={};o.data("q")({data:e}).extract({field:n.field,trackBy:n.valueAccessor,reduce:function(t){var e=t[0];return d[e]=f++,t[0]}}),c={source:"attrDim",extract:{field:"qDimensionInfo/0",filter:function(t){return t.qElemNumber>=0},props:{row:{value:function(t){return d[t.qElemNumber]}}}}}}var p={data:h,range:n.range,domain:n.domain,explicit:l,type:"categorical-color",label:function(t){return t.datum.text&&t.datum.text.value?t.datum.text.value:t.datum.label}};s[u]=p,c&&(s["".concat(u,"Legend")]=qy(qy({},p),{},{data:c})),e&&e.qHasOtherValues&&c&&((c||p.data).amend=[{label:e.qDimensionInfo[0].othersLabel,source:{key:"qHyperCube",field:"qDimensionInfo/0"},row:{value:-3},value:-3}])}else if("measure"===n.fieldType){var g={data:{field:n.field},min:n.min,max:n.max};s[u]=Yy({},g,{type:"categorical"===n.type?"threshold-color":"sequential-color",range:n.range,domain:n.domain,invert:n.reverse}),"sequential-color"===s[u].type&&(s["".concat(u,"Range")]=Yy({},g,{invert:!!r}))}else if("color"!==n.type)throw new Error("UNUSED FIELD")}else if("dimension"===n.mode){var v={data:e.qDimensionInfo.map((function(t,e){return e})),label:function(t){return e.qDimensionInfo[t.datum.value].qFallbackTitle},explicit:l,type:"categorical-color"};s[u]=v}else if("measure"===n.mode){var y={data:e.qMeasureInfo.map((function(t,e){return e})).filter((function(t){var e,r;return!(null!==(e=n.explicit)&&void 0!==e&&null!==(r=e.exclude)&&void 0!==r&&r.includes(t))})),label:function(t){return e.qMeasureInfo[t.datum.value].qFallbackTitle},explicit:l,type:"categorical-color"};s[u]=y}}return s}({hc:n.hc,coloring:i(),key:n.key,source:n.source,picasso:t.picasso}),r.scales},color:function(){return r.color=r.color||function(t){var e=t.coloring,n=t.scales,r=t.key,i=Xm(r),a=Xm("".concat(r,"IsAnOther")),o=function(t,e){var r=t.fieldType,o=t.invalid,s=t.mode,u=t.nil,l=t.others,c=t.primary,h=t.type;return o?function(t){return Gm(t)||a(t)?l:u}:n[e]?function(t){return Gm(t)?l:Km(t)||-2===i(t)&&"dimension"===r||"NaN"===i(t)?u:a(t)?l:t.resources.scale(e)(i(t))||l}:"constant"===s?function(t){return Gm(t)||a(t)?l:Km(t)?u:c}:"color"===h?function(t){return Gm(t)||a(t)?l:Km(t)?u:i(t)||l}:null},s=o(e,r);if(e.measureOverrides){var u=Xm("".concat(r,"MeasureIdx")),l=e.measureOverrides.map((function(t){return t&&o(t)}));return function(t){var e=u(t);return l[e]?l[e](t):s(t)}}return s}({coloring:i(),scales:this.scales(),key:n.key}),r.color},datumProps:function(t){return function(t){var e,n,r=t.hc,i=t.coloring,a=t.scales,o=t.key,s=t.addMeasureIx,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=o,c=i.nil;"field"===i.mode&&i.field?e=i.field:a[o]&&"field"===i.mode&&(e=a[o].data.field||i.field),e?(n={field:e,reduce:"first"},"color"===i.type&&(n.value=function(t){return"NaN"!==t.qNum?Kx(t.qNum):t.qText&&xx(t.qText)?t.qText:c})):"dimension"===i.mode?n=void 0!==i.field?i.field:r.qDimensionInfo.length-1:"measure"===i.mode&&(n=u);var h=Ey({},l,n);return r.qDimensionInfo.length>1&&(h["".concat(l,"IsAnOther")]={fields:r.qDimensionInfo.map((function(t,e){return{field:"qDimensionInfo/".concat(e)}})),value:function(t){return-1!==t.indexOf(-3)}}),s&&(h["".concat(l,"MeasureIdx")]=u),h}({coloring:this.settingsForMeasure(t),scales:this.scales(),key:n.key,hc:n.hc,addMeasureIx:i().measureOverrides},t)},data:function(){var t=i(),e={key:"dummy",data:[["field"],["a"]]};return t.legendDataset?[e,{type:"q",key:"attrDim",data:t.legendDataset.raw(),config:{localeInfo:n.localeInfo}}]:[e]},legend:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.eventName,r=t.key,a=t.viewState,o=t.chart,s=t.rtl,u=t.styleReference,l=void 0===u?"object.legend":u,c=t.settings,h=void 0===c?{}:c,f=t.style,d=void 0===f?{}:f,p=arguments.length>1?arguments[1]:void 0;return ex({eventName:e,key:r,rtl:s,viewState:a,chart:o,styleReference:l,settings:h,style:d},{legendProps:n.legendProps,scaleKey:n.key,coloring:i(),theme:n.theme,hc:n.hc,scales:this.scales()},p)}};return a}var Zx=function(t){return t.baseColor||t.coloring&&t.coloring.baseColor};function Jx(t){var e=t.qHyperCube,n=e.qDimensionInfo,r=e.qMeasureInfo,i=n.some(Zx),a=r.some(Zx),o=t.color.useBaseColors;return"measure"===o&&!a||"dimension"===o&&!i?"off":o}function Qx(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=qy(qy(qy({},t),e),{},{colorProps:qy(qy({},t.colorProps),e.colorProps||{})});return n}var tb=function(t){return t.baseColor||t.coloring&&t.coloring.baseColor};function eb(t){var e,n=t.qHyperCube.qDimensionInfo.some(tb),r=t.qHyperCube.qMeasureInfo.some(tb),i=n?"dimension":void 0;return{mode:"primary",useBaseColors:null!==(e=null!=i?i:r?"measure":void 0)&&void 0!==e?e:"off",paletteColor:null}}var nb=function(){};function rb(t){var e=t.originalArray,n=t.newArray,r=t.matchKey;return Array.isArray(e)&&e.length?(n.forEach((function(t){var n=-1;e.some((function(e,i){return e[r]&&e[r]===t[r]&&(n=i),n})),n>-1?e[n]=t:e.push(t)})),e):n}function ib(t){return(ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ab(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ob(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sb(t,e,n){return e&&ob(t.prototype,e),n&&ob(t,n),t}function ub(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function cb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lb(Object(n),!0).forEach((function(e){ub(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lb(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hb(t,e){return(hb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function db(t,e,n){return(db=fb()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&hb(i,n.prototype),i}).apply(null,arguments)}function pb(t){return function(t){if(Array.isArray(t))return vb(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||gb(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gb(t,e){if(t){if("string"==typeof t)return vb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vb(t,e):void 0}}function vb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var yb=Object.prototype.hasOwnProperty,mb=Object.prototype.toString,xb=Object.defineProperty,bb=Object.getOwnPropertyDescriptor,wb=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===mb.call(t)},kb=function(t){if(!t||"[object Object]"!==mb.call(t))return!1;var e,n=yb.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&yb.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||yb.call(t,e)},Mb=function(t,e){xb&&"__proto__"===e.name?xb(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},_b=function(t,e){if("__proto__"===e){if(!yb.call(t,e))return;if(bb)return bb(t,e).value}return t[e]},Sb=function t(){var e,n,r,i,a,o,s=arguments[0],u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});u<l;++u)if(null!=(e=arguments[u]))for(n in e)r=_b(s,n),s!==(i=_b(e,n))&&(c&&i&&(kb(i)||(a=wb(i)))?(a?(a=!1,o=r&&wb(r)?r:[]):o=r&&kb(r)?r:{},Mb(s,{name:n,newValue:t(c,o,i)})):void 0!==i&&Mb(s,{name:n,newValue:i}));return s};function Cb(t,e,n){if(!t)return-1;var r=n.cache,i=t.origin?t.origin():null;i&&(t=i);var a=r.fields.indexOf(t),o=-1,s=-1;if(-1===a)for(var u=0;u<r.wrappedFields.length;u++)if(s=r.wrappedFields[u].attrDims.map((function(t){return t.instance})).indexOf(t),o=r.wrappedFields[u].attrExps.map((function(t){return t.instance})).indexOf(t),-1!==s||-1!==o){a=u;break}return(a-=e.qArea.qLeft)<0||a>=e.qArea.qWidth?-1:s>=0?function(t){return t[a].qAttrDims.qValues[s]}:o>=0?function(t){return t[a].qAttrExps.qValues[o]}:function(t){return t[a]}}function Rb(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function qb(t){var e=t.cache,n=t.f,r=t.mainCell,i=t.p;t.prop;var a=t.page,o=t.rowIdx,s=t.row,u=t.sourceKey,l=t.target,c=t.targetProp,h=r;if(i.field&&i.field!==n){var f=Cb(i.field,a,{cache:e});if(-1===f)return;h=Sb({qRow:o},f(s))}l[c]=Rb(i,h,{key:u})}function Nb(t,e,n,r){for(var i=Array.isArray(t)?t:[t],a=[],o=0;o<i.length;o++)if(void 0!==i[o].field){for(var s=e.raw(),u=e.key(),l="object"===ib(i[o].field)?i[o].field:e.field(i[o].field),c=r.normalizeConfig(i[o],e),h=c.props,f=c.main,d=Object.keys(h),p=!!i[o].trackBy,g=ib(i[o].trackBy),v={},y=[],m=[],x=0;x<s.qDataPages.length;x++){var b=Cb(l,s.qDataPages[x],{cache:n});if(-1!==b)for(var w=0;w<s.qDataPages[x].qMatrix.length;w++){var k=s.qDataPages[x].qArea.qTop+w,M=Sb({qRow:k},b(s.qDataPages[x].qMatrix[w])),_=Rb(f,M,{key:u});if(!f.filter||f.filter(M)){for(var S=0;S<d.length;S++){var C=h[d[S]],R=C.fields||[C];C.fields&&(_[d[S]]=[]);for(var q=0;q<R.length;q++)qb({cache:n,f:l,mainCell:M,p:R[q],prop:d[S],props:h,page:s.qDataPages[x],rowIdx:k,row:s.qDataPages[x].qMatrix[w],sourceKey:u,target:C.fields?_[d[S]]:_,targetProp:C.fields?q:d[S]});if(C.fields){var N=_[d[S]].map((function(t){return t.value})),A=_[d[S]].map((function(t){return t.label}));_[d[S]]={value:"function"==typeof C.value?C.value(N):void 0!==C.value?C.value:N,label:"function"==typeof C.label?C.label(A):void 0!==C.label?String(C.label):String(_[d[S]].value)}}}p&&r.track({cfg:i[o],itemData:M,obj:_,target:y,tracker:v,trackType:g}),m.push(_)}}}p?a.push.apply(a,pb(r.collect(y,{main:f,propsArr:d,props:h}))):a.push.apply(a,m)}return a}function Ab(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Db(t,e){var n,r,i,a,o,s=new Tb(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=Ob);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)l.push(r=n.children[a]=new Tb(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Ib)}function Ob(t){return t.children}function Eb(t){t.data=t.data.data}function Ib(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Tb(t){this.data=t,this.depth=this.height=0,this.parent=null}function jb(t){if("function"!=typeof t)throw new Error;return t}Tb.prototype=Db.prototype={constructor:Tb,count:function(){return this.eachAfter(Ab)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Db(this).eachBefore(Eb)}};var Pb={depth:-1},zb={};function Fb(t){return t.id}function Lb(t){return t.parentId}function Bb(t,e){"/"===t.charAt(0)&&(t=t.substring(1));for(var n,r=t.split("/"),i=e,a=0;a<r.length;a++){if("*"===r[a]&&Array.isArray(i)){var o=[];n=r.slice(a+1).join("/");for(var s=0;s<i.length;s++){var u=Bb(n,i[s]);Array.isArray(u)?o.push.apply(o,pb(u)):o.push(u)}return o}if(!r[a]&&Array.isArray(i)){var l=new Array(i.length);n=r.slice(a+1).join("/");for(var c=0;c<i.length;c++)l[c]=Bb(n,i[c]);return l}r[a]in i&&(i=i[r[a]])}return i}function Hb(t,e,n){var r=[];if(!t||!t.length)return r;if(e<=0){var i=n>=0?[t[n]]:t;r.push.apply(r,pb(i))}else for(var a=0;a<t.length;a++)t[a].children&&t[a].children.length&&r.push.apply(r,pb(Hb(t[a].children,e-1,n)));return r}function $b(t,e,n){if(t===e)return function(t){return t};if(t>e){var r=Math.max(0,Math.min(100,t-e)),i=pb(Array(r)).map(String.prototype.valueOf,"parent").join(".");return Function("node","return node.".concat(i,";"))}if(e>t){var a=Math.max(0,Math.min(100,e-t));return function(t){return Hb(t.children,a-1,n)}}return!1}function Wb(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];var r=n.allFields;if("function"==typeof t){for(var i=0;i<r.length;i++)if(t(r[i]))return r[i];return!1}if("string"==typeof t){for(var a=0;a<r.length;a++)if(r[a].key()===t||r[a].title()===t)return r[a]}else if(t&&-1!==r.indexOf(t))return t;throw Error("Field not found: ".concat(t))}var Vb=/^qDimensionInfo(?:\/(\d+))?/,Ub=/^\/?qMeasureInfo\/(\d+)/,Yb=/\/qAttrExprInfo\/(\d+)/,Xb=/\/qAttrDimInfo\/(\d+)/;function Kb(t){return(t.qColumnOrder&&t.qColumnOrder.length?t.qColumnOrder:t.qDimensionInfo.map((function(t,e){return e}))).filter((function(e){return e<t.qDimensionInfo.length}))}function Gb(t,e){var n=e.cube;if(!t)return-1;var r=t.origin&&t.origin()?t.origin().key():t.key(),i=!1,a=-1,o=-1,s=-1,u=-1,l=-1,c=r,h=n.qEffectiveInterColumnSortOrder,f=Kb(n);return Vb.test(c)&&(i=!0,a=+Vb.exec(c)[1],c=r.replace(Vb,"")),Ub.test(c)&&("K"===n.qMode?u=+Ub.exec(c)[1]:h&&-1!==h.indexOf(-1)?(u=+Ub.exec(c)[1],l=0):l=+Ub.exec(c)[1],c=c.replace(Ub,"")),c&&(Xb.exec(c)?s=+Xb.exec(c)[1]:Yb.exec(c)&&(o=+Yb.exec(c)[1])),{fieldDepth:(i?"S"===n.qMode?f[a]:h?h.indexOf(a):a:h&&-1!==h.indexOf(-1)?h.indexOf(-1):n.qDimensionInfo.length-("K"===n.qMode?0:1))+1,pseudoMeasureIndex:u,measureIdx:l,attrDimIdx:s,attrIdx:o}}function Zb(t,e){var n,r,i=$b(t.fieldDepth,e.fieldDepth,e.pseudoMeasureIndex);return n=e.measureIdx>=0?function(t){return t.data.qValues[e.measureIdx]}:function(t){return t.data},e.attrDimIdx>=0?r=function(t){var n;return null==t||null===(n=t.qAttrDims)||void 0===n?void 0:n.qValues[e.attrDimIdx]}:e.attrIdx>=0&&(r=function(t){var n;return null==t||null===(n=t.qAttrExps)||void 0===n?void 0:n.qValues[e.attrIdx]}),{nodeFn:i,attrFn:r,valueFn:n}}function Jb(t,e,n){var r=n.key,i={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return i.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(i.value),t.field&&(i.source={key:r,field:t.field.key()}),i}function Qb(t){for(var e=t.propsArr,n=t.props,r=t.item,i=t.itemData,a=t.ret,o=t.sourceKey,s=0;s<e.length;s++){var u=n[e[s]],l=u.fields||[u],c=void 0,h=void 0;u.fields&&(c=[],h=[]);for(var f=function(t){var n=l[t],f=void 0,d=void 0,p=void 0,g=void 0,v=void 0,y=void 0;if("primitive"===n.type?(p=n.value,y=String(n.value)):("function"==typeof n.value&&(f=function(t){return n.value(t,r)}),"function"==typeof n.label&&(d=function(t){return n.label(t,r)}),n.accessor?(g=n.accessor(r),Array.isArray(g)?(v=g.map(n.valueAccessor),n.attrAccessor&&(v=v.map(n.attrAccessor)),f&&(p=v.map(f),f=null),d&&(y=v.map(d),d=null),p=n.reduce?n.reduce(p):p,y=n.reduceLabel?n.reduceLabel(y,p):String(p)):y=p=n.attrAccessor?n.attrAccessor(n.valueAccessor(g)):n.valueAccessor(g)):(p=i,y=i)),u.fields){var m=f?f(p):p;c.push(m),h.push(d&&null!=y?d(y):null!=y?y:String(m))}else{var x=f?f(p):p;a[e[s]]={value:x,label:d?d(y):null!=y?y:String(x)},n.field&&(a[e[s]].source={field:n.field.key(),key:o})}},d=0;d<l.length;d++)f(d);c&&(a[e[s]]={value:"function"==typeof u.value?u.value(c,r):c,label:"function"==typeof u.label?u.label(h,r):h})}}var tw=function(t,e,n){var r="K"===t.qMode?"/qStackedDataPages/*/qData":"/qTreeDataPages/*",i="K"===t.qMode?"qSubNodes":"qNodes",a=Bb(r,t);return a&&a[0]?(e.tree=Db(a[0],n.children||function(t){return t[i]}),e.tree):null};function ew(t){for(var e=t.raw().qDataPages.length?t.raw().qDataPages[0].qMatrix:[],n=function(t){var e=t.raw().qColumnOrder,n=t.fields();return e&&e.length===n.length?e:n.map((function(t,e){return e}))}(t),r=t.fields(),i=t.fields().filter((function(t){return"dimension"===t.type()})).map((function(t){return n.indexOf(r.indexOf(t))})),a=t.fields().filter((function(t){return"measure"===t.type()})).map((function(t){return n.indexOf(r.indexOf(t))})),o={__root:{__id:"__root",qValues:[]}},s=0;s<e.length;s++){for(var u=e[s],l="__root",c=!1,h=0;h<i.length;h++){var f=u[i[h]],d="".concat(l,"__").concat(f.qText);o[d]||(o[d]=cb({__id:d,__parent:l,qValues:[]},f),c=!0),l=d}if(c)for(var p=0;p<a.length;p++){var g=u[a[p]];o[l].qValues.push(g)}}var v=Object.keys(o).map((function(t){return o[t]}));return function(){var t=Fb,e=Lb;function n(n){var r,i,a,o,s,u,l,c=n.length,h=new Array(c),f={};for(i=0;i<c;++i)r=n[i],s=h[i]=new Tb(r),null!=(u=t(r,i,n))&&(u+="")&&(f[l="$"+(s.id=u)]=l in f?zb:s);for(i=0;i<c;++i)if(s=h[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(o=f["$"+u]))throw new Error("missing: "+u);if(o===zb)throw new Error("ambiguous: "+u);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=Pb,a.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(Ib),a.parent=null,c>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=jb(e),n):t},n.parentId=function(t){return arguments.length?(e=jb(t),n):e},n}().id((function(t){return t.__id})).parentId((function(t){return t.__parent}))(v)}var nw=function(t){for(var e=t.propsArr,n=t.props,r=t.cube,i=t.cache,a=t.itemDepthObject,o=t.f,s=0;s<e.length;s++)for(var u=n[e[s]],l=u.fields?u.fields:[u],c=0;c<l.length;c++){var h=l[c];if(h.field!==o){var f=Zb(a,Gb(h.field,{cube:r,cache:i}));h.accessor=f.nodeFn,h.valueAccessor=f.valueFn,h.attrAccessor=f.attrFn}}};function rw(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=e.raw(),a=e.key(),o="S"===i.qMode?ew(e):tw(i,n,t);if(!o)return null;for(var s=o.height,u=[],l=0;l<=s;l++){var c=null;if(l>0)if("S"===i.qMode){var h=Kb(i),f=h[l-1];c=n.fields[f]}else{var d=i.qEffectiveInterColumnSortOrder[l-1];l>i.qEffectiveInterColumnSortOrder.length&&(d=i.qDimensionInfo.length),c=n.fields[d]}var p=r.normalizeConfig(cb(cb({},t),{},{field:c?c.key():void 0}),e),g=p.props,v=p.main,y=Object.keys(g);u[l]={propsArr:y,props:g,main:v};var m=c?Gb(c,{cube:i,cache:n}):{fieldDepth:0};nw({propsArr:y,props:g,cube:i,cache:n,itemDepthObject:m,f:c})}for(var x=o.copy(),b=x.descendants(),w=o.descendants(),k=0;k<w.length;k++){var M=u[w[k].depth].propsArr,_=u[w[k].depth].props,S=u[w[k].depth].main,C=b[k],R=C.data,q=Jb(S,R,{key:a});Qb({propsArr:M,props:_,item:C,itemData:R,ret:q,sourceKey:a,isTree:!0}),w[k].data=q}return o}function iw(t,e,n,r){for(var i=Array.isArray(t)?t:[t],a=[],o=0;o<i.length;o++)if(void 0!==i[o].field){var s=e.raw(),u=e.key();if(!tw(s,n,t))continue;var l="object"===ib(i[o].field)?i[o].field:e.field(i[o].field),c=r.normalizeConfig(i[o],e),h=c.props,f=c.main,d=Object.keys(h),p=Gb(l,{cube:s,cache:n}),g=Zb({fieldDepth:0},p),v=g.nodeFn,y=g.attrFn,m=g.valueFn;nw({propsArr:d,props:h,cube:s,cache:n,itemDepthObject:p,f:l});for(var x=!!i[o].trackBy,b=ib(i[o].trackBy),w={},k=[],M=v(n.tree),_=[],S=0;S<M.length;S++){var C=M[S],R=y?y(m(C)):m(C);if(!f.filter||f.filter(R)){var q=Jb(f,R,{key:u});Qb({propsArr:d,props:h,item:C,itemData:R,ret:q,sourceKey:u}),x&&r.track({cfg:i[o],itemData:R,obj:q,target:k,tracker:w,trackType:b}),_.push(q)}}x?a.push.apply(a,pb(r.collect(k,{main:f,propsArr:d,props:h}))):a.push.apply(a,_)}return a}var aw,ow=(function(t){
/*! javascript-number-formatter - v1.1.11 - http://mottie.github.com/javascript-number-formatter/ * © ecava */
t.exports=function(t,e){if(!t||isNaN(+e))return e;var n,r,i,a,o,s,u,l,c,h,f=t.length,d=t.search(/[0-9\-\+#]/),p=d>0?t.substring(0,d):"",g=t.split("").reverse().join(""),v=g.search(/[0-9\-\+#]/),y=f-v,m=t.substring(y,y+1),x=y+("."===m||","===m?1:0),b=v>0?t.substring(x,f):"";if(n=(e="-"===(t=t.substring(d,x)).charAt(0)?-e:+e)<0?e=-e:0,i=(r=t.match(/[^\d\-\+#]/g))&&r[r.length-1]||".",a=r&&r[1]&&r[0]||",",t=t.split(i),e=+(e=e.toFixed(t[1]&&t[1].length))+"",s=t[1]&&t[1].lastIndexOf("0"),(!(l=e.split("."))[1]||l[1]&&l[1].length<=s)&&(e=(+e).toFixed(s+1)),c=t[0].split(a),t[0]=c.join(""),(o=t[0]&&t[0].indexOf("0"))>-1)for(;l[0].length<t[0].length-o;)l[0]="0"+l[0];else 0==+l[0]&&(l[0]="");if((e=e.split("."))[0]=l[0],u=c[1]&&c[c.length-1].length){for(g="",y=(h=e[0]).length%u,f=h.length,x=0;x<f;x++)g+=h.charAt(x),!((x-y+1)%u)&&x<f-u&&(g+=a);e[0]=g}return e[1]=t[1]&&e[1]?i+e[1]:"","0"!==(r=e.join(""))&&""!==r||(n=!1),p+(n?"-":"")+r+b}}(aw={exports:{}}),aw.exports);function sw(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}var uw={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},lw=/%$/,cw=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,hw=/^\(oct\)/i,fw=/^\(dec\)/i,dw=/^\(hex\)/i,pw=/^\(bin\)/i,gw=/^\(rom\)/i,vw=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i,yw=/#|0/g;function mw(t,e,n,r){return t=t.toString(e),n[1]===n[1].toUpperCase()&&(t=t.toUpperCase()),t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11)),t.replace(".",r||".")}function xw(t,e,n){var r=sw(t);return n?r:new RegExp(r||"",e)}function bw(t,e,n){var r,i,a,o,s,u,l,c,h,f,d,p=t.pattern;p.indexOf("A")>=0&&(p=p.replace("A",""),t.abbreviate=!0),f=e,(d=n)&&(d=sw(d)),f&&(f=sw(f)),h=new RegExp("(?:[#0]+".concat(f,")?[#0]+(?:").concat(d,"[#0]+)?")),o=(a=(a=p.match(h))?a[0]:"")?p.substr(0,p.indexOf(a)):p,s=a?p.substring(p.indexOf(a)+a.length):"",a||(a=p?"#":"##########"),e&&e===n&&(i=(r=a.split(n)).pop(),a=r.join("")+n+i,e=""),u=e,e=/,/.test(n)?"¤":",",u&&(a=a.replace(xw(u,"g"),e)),l=n,n=".",l&&(a=a.replace(xw(l,"g"),n)),c=(c=a.match(/#/g))?c.length:0;var g,v=p.split(l);v[1]&&(g=v[1].match(yw)),t.prefix=o||"",t.postfix=s||"",t.pattern=p,t.maxPrecision=g?g.length:2,t.percentage=lw.test(p),t.numericPattern=a||"",t.numericRegex=new RegExp("".concat(xw(e,null,!0),"|").concat(xw(n,null,!0)),"g"),t.groupTemp=u,t.decTemp=l,t.t=e,t.d=n,t.temp=c}var ww=function(){function t(e,n,r,i,a){ab(this,t),this.localeInfo=e,this.pattern=n,this.thousandDelimiter=r||",",this.decimalDelimiter=i||".",this.type=a||"numeric",this.patternSeparator=";",this.abbreviations=function(t,e){if(!t||!t.qNumericalAbbreviation)return uw;var n={};return t.qNumericalAbbreviation.split(e).forEach((function(t){var e=t.split(":");2===e.length&&(n[e[0]]=e[1])})),n}(e,this.patternSeparator),this.prepare()}return sb(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e,n,r){return this.prepare(e,n,r),this.formatValue(t)}},{key:"prepare",value:function(t,e,n){var r;void 0===t&&(t=this.pattern),void 0===e&&(e=this.thousandDelimiter),void 0===n&&(n=this.decimalDelimiter),t?(this._prepared={positive:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},zero:{d:n,t:e,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},r=this._prepared,t=t.split(this.patternSeparator),r.positive.pattern=t[0],r.negative.pattern=t[1],r.zero.pattern=t[2],vw.test(t[0])&&(r.positive.isFunctional=!0),t[1]?vw.test(t[1])&&(r.negative.isFunctional=!0):r.negative=!1,t[2]?vw.test(t[2])&&(r.zero.isFunctional=!0):r.zero=!1,r.positive.isFunctional||bw(r.positive,e,n),r.negative&&!r.negative.isFunctional&&bw(r.negative,e,n),r.zero&&!r.zero.isFunctional&&bw(r.zero,e,n)):this._prepared={pattern:!1}}},{key:"formatValue",value:function(t){var e,n,r,i,a,o,s,u,l,c=this._prepared,h="",f="",d=t;if(isNaN(t))return"".concat(d);if(t=+t,!1===c.pattern)return t.toString();if(0===t&&c.zero)return(c=c.zero).pattern;if(t<0&&c.negative?(c=c.negative,t=-t):c=c.positive,a=c.d,o=c.t,c.isFunctional)t=function(t,e,n){var r;return cw.test(e)?t=mw(t,Number(/\d{2}/.exec(e)[0]),e,n):hw.test(e)?t=mw(t,8,e,n):fw.test(e)?t=mw(t,10,e,n):dw.test(e)?t=mw(t,16,e,n):pw.test(e)?t=mw(t,2,e,n):gw.test(e)&&(r="",t<0&&(r="-",t=-t),0===(t=Math.floor(t))?t="0":t<=5e5?(t=function(t,e){for(var n,r="",i=Number(String(t).slice(-3)),a=(t-i)/1e3,o=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),s=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();i>0;)for(n=0;n<o.length;n++)if(o[n]<=i){r+=s[n],i-=o[n];break}for(n=0;n<a;n++)r="M".concat(r);return e[1]!==e[1].toUpperCase()&&(r=r.toLowerCase()),r}(t,e),t=r+t):t=e+r+t.toExponential(0)),t}(t,c.pattern,a);else{if(c.percentage&&(t*=100),c.abbreviate){var p,g,v=Object.keys(this.abbreviations).map((function(t){return parseInt(t,10)})).sort((function(t,e){return t-e})),y=v[0];for(s=0,n=Number(Number(t).toExponential().split("e")[1]);y<=n&&s<v.length;)y=v[++s];s>0&&(p=v[s-1]),p&&n>0&&p>0?g=p:(n<0&&p<0||!p)&&(y<0&&y-n<=c.maxPrecision?g=y:p<=n&&!(y>0&&-n<=c.maxPrecision)&&(g=p)),g&&(h=this.abbreviations[g],t/=Math.pow(10,g))}if(r=Math.abs(t),e=c.temp,l=(u=c.numericPattern).split(a)[1],"I"===this.type&&(t=Math.round(t)),i=t,l||"#"!==u.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)t=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var m=Number(t.toFixed(Math.min(20,l?l.length:0)).split(".")[0]),x=u.split(a)[0];if(t=ow(x+=a,m)||"0",l){var b=Math.max(0,Math.min(14,l.length)),w=l.replace(/#+$/,"").length,k=("I"===this.type?0:r%1).toFixed(b).slice(2).replace(/0+$/,"");for(s=k.length;s<w;s++)k+="0";k&&(t+=a+k)}else 0===m&&(i=0)}else if(r>=Math.pow(10,e)||r<1||r<1e-4)0===t?t="0":r<1e-4||r>=1e20?(t=(t=i.toExponential(Math.max(1,Math.min(14,e))-1)).replace(/\.?0+(?=e)/,""),f=""):(t=t.toPrecision(Math.max(1,Math.min(14,e)))).indexOf(".")>=0&&(t=(t=t.replace(t.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"")).replace(".",a));else{for(u+=a,e=Math.max(0,Math.min(20,e-Math.ceil(Math.log(r)/Math.log(10)))),s=0;s<e;s++)u+="#";t=ow(u,t)}t=t.replace(c.numericRegex,(function(t){return t===o?c.groupTemp:t===a?c.decTemp:""})),i<0&&!/^-/.test(t)&&(t="-".concat(t))}return c.prefix+t+f+h+c.postfix}}],[{key:"getStaticFormatter",value:function(){return{prepare:function(){},formatValue:function(t){return"".concat(t)}}}}]),t}();function kw(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.size,a=void 0===i?5e3:i,o=r.multipleArguments,s=void 0!==o&&o,u=r.toKey,l=void 0===u?function(t){return t}:u,c=Object.create(null),h=Object.create(null),f=0,d=0;return(e=s?function(){return n=l.apply(void 0,arguments),e.has(n)?e.get(n):e.set(n,t.apply(void 0,arguments))}:function(r){return n=l(r),e.has(n)?e.get(n):e.set(n,t(r))}).set=function(t,e){return f>=a&&(delete c[h[d]],delete h[d],f--,d++),c[t]=e,h[f]=t,f++,e},e.get=function(t){return c[t]},e.has=function(t){return t in c},e.clear=function(){c=Object.create(null),h=Object.create(null),f=0,d=0},e.size=function(){return f},e}function Mw(t,e,n,r,i){var a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return db(ww,e)}(i,t,e,n,r),o=kw(a.formatValue.bind(a),{toKey:function(t){return isNaN(t)?t:+t}});function s(t){return o(t)}return s.format=function(t,e,n,r){return o.clear(),a.format(e,t,n,r)},s.pattern=function(t){return t&&(o.clear(),a.pattern=t,a.prepare()),a.pattern},s}var _w=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Sw=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Cw=["January","February","March","April","May","June","July","August","September","October","November","December"],Rw=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function qw(t,e){for(var n=t.length;n<e;n++)t="0".concat(t);return t}function Nw(t){var e=t.toString().split(".");return e[1]?e=Number("0.".concat(e[1])):0}var Aw=function(){function t(e,n,r){ab(this,t);var i,a=e||{};a.qCalendarStrings||(a.qCalendarStrings={qLongDayNames:_w,qDayNames:Sw,qLongMonthNames:Cw,qMonthNames:Rw}),this.localeInfo=a,this.locale_days=a.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=a.qCalendarStrings.qDayNames.slice(),this.locale_months=a.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=a.qCalendarStrings.qMonthNames.slice(),n||(n=(ub(i={},"T",a.qTimeFmt||"hh:mm:ss"),ub(i,"D",a.qDateFmt||"YYYY-MM-DD"),ub(i,"TS",a.qTimestampFmt||"YYYY-MM-DD hh:mm:ss"),i)[r]),this.pattern=n}return sb(t,[{key:"clone",value:function(){var e=new t(this.localeInfo,this.pattern);return e.subtype=this.subtype,e}},{key:"format",value:function(t,e){e||(e=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),e=e.replace(/\[.+]|\[|]/g,"");var n,r,i,a,o,s=/t+/gi.test(e);t instanceof Date?(i=s,a=(r=t).getUTCHours(),i&&((a%=12)||(a=12)),(o=r.getUTCDay()-1)<0&&(o=6),n={year:r.getUTCFullYear(),month:r.getUTCMonth(),day:o,date:r.getUTCDate(),h:a,m:r.getUTCMinutes(),s:r.getUTCSeconds(),f:r.getUTCMilliseconds(),t:r.getUTCHours()>=12?"pm":"am"}):(t<0&&(t=-t,e="-".concat(e)),n=function(t,e){var n,r=function(t){var e=t,n=24*Nw(e),r=60*Nw(n),i=60*Nw(r),a=1e3*Nw(i);return{d:Math.floor(e),h:Math.floor(n),m:Math.floor(r),s:Math.floor(i),f:Math.round(a)}}(t),i=r.d,a=r.h,o=r.m,s=r.s,u=r.f,l=0;/w+|t+/gi.test(e)&&(n=new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,Math.round(86400*(t-Math.floor(t))))),isNaN(n.getTime())&&(n=null)),/D+/gi.test(e)||(a+=24*i),/h+/gi.test(e)||(o+=60*a),/m+/gi.test(e)||(s+=60*o),/w+/gi.test(e)&&(l=n?n.getDay()-1:0)<0&&(l=6);var c="";return n&&(c=n.getUTCHours()>=12?"pm":"am"),{year:0,month:0,day:l,date:i,h:a,m:o,s:s,f:u,t:c}}(t,e));var u=function(t,e){return{"Y+|y+":{Y:"".concat(Number("".concat(e.year).slice(-2))),YY:qw("".concat(e.year).slice(-2),2),YYY:qw("".concat(e.year).slice(-3),3),def:function(t){return qw("".concat(e.year),t.length)}},"M+":{M:e.month+1,MM:qw("".concat(e.month+1),2),MMM:t.locale_months_abbr[e.month],def:t.locale_months[e.month]},"W+|w+":{W:e.day,WW:qw("".concat(e.day),2),WWW:t.locale_days_abbr[e.day],def:t.locale_days[e.day]},"D+|d+":{D:e.date,def:function(t){return qw("".concat(e.date),t.length)}},"h+|H+":{h:e.h,def:function(t){return qw("".concat(e.h),t.length)}},"m+":{m:e.m,def:function(t){return qw("".concat(e.m),t.length)}},"s+|S+":{s:e.s,def:function(t){return qw("".concat(e.s),t.length)}},"f+|F+":{def:function(t){var n="".concat(e.f),r=t.length-n.length;if(r>0)for(var i=0;i<r;i++)n+="0";else r<0&&(n=n.slice(0,t.length));return n}},"t{1,2}|T{1,2}":{def:function(t){var n=e.t;return t[0].toUpperCase()===t[0]&&(n=n.toUpperCase()),n.slice(0,t.length)}}}}(this,n),l=[];for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&l.push(c);var h=new RegExp(l.join("|"),"g");return e.replace(h,(function(t){var e,n,r;for(n in u)if(Object.prototype.hasOwnProperty.call(u,n)&&(e=new RegExp(n)).test(t))break;if(!e)return"";for(var i in u[n])if(i===t||i.toLowerCase()===t){void 0===(r=u[n][i])&&(r=u[n][i.toLowerCase()]);break}return void 0===r&&(r=u[n].def),"function"==typeof r&&(r=r(t)),r}))}}]),t}();function Dw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return db(Aw,e)}function Ow(t){return new Date(Date.UTC(1899,11,30+Math.floor(t),0,0,0,Math.round(864e5*(t-Math.floor(t)))))}function Ew(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TS",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=Dw(n,t,e),i=kw(r.format.bind(r),{toKey:function(t){return"object"===ib(t)&&"function"==typeof t.getTime?t.getTime():t}});function a(t){return"IV"!==e?Ow(t):t}function o(t){return t=a(t),i(t)}return o.format=function(t,e){return i.clear(),e=a(e),r.format(e,t)},o.locale=function(n){return r=Dw(n,t,e),i=kw(r.format.bind(r),{toKey:function(t){return"object"===ib(t)?t.getTime():t}}),this},o.qtype=function(t){return void 0!==t&&(e=t,i.clear()),e},o}function Iw(t,e){if(t&&t.qNumFormat&&-1!==["D","T","TS","IV"].indexOf(t.qNumFormat.qType))return Ew(t.qNumFormat.qFmt,t.qNumFormat.qType,e);var n="#",r=e&&void 0!==e.qThousandSep?e.qThousandSep:",",i=e&&void 0!==e.qDecimalSep?e.qDecimalSep:".",a="U",o=t&&!!t.qIsAutoFormat;return t&&t.qNumFormat?(n=t.qNumFormat.qFmt||n,r=t.qNumFormat.qThou||r,i=t.qNumFormat.qDec||i,a=t.qNumFormat.qType||a,o=o&&-1===["M"].indexOf(t.qNumFormat.qType)):o=!0,(o||"U"===a)&&(n="#".concat(i,"##A"),a="U"),Mw(n,r,i,a,e)}function Tw(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.meta,r=e.id,i=e.key,a=e.localeInfo,o=e.fieldExtractor,s=e.value,u=e.type,l=e.sourceField,c=s||("dimension"===u?function(t){return t.qElemNo}:function(t){return t.qValue}),h=function(t){return t.qText||""},f="dimension"===u?"first":"avg",d=Iw(n,a),p="dimension"===u?"first":function(t,e){return d(e)},g={id:function(){return r},key:function(){return i},raw:function(){return n},title:function(){return n.qFallbackTitle||n.label},type:function(){return u},origin:function(){return l},items:function(){return t||(t=o(g)),t},min:function(){return n.qMin},max:function(){return n.qMax},value:c,label:h,reduce:f,reduceLabel:p,formatter:function(){return d},tags:function(){return n.qTags}};return g}function jw(t,e,n,r,i){return(e[t]||[]).map((function(e,a){var o="".concat(r?"".concat(r,"/"):"").concat(t,"/").concat(a),s={instance:Tw(Sb({id:"".concat(n?"".concat(n,"/"):"").concat(o),key:o,meta:e},i))};return s.attrDims=jw("qAttrDimInfo",e,n,o,Sb({},i,{value:function(t){return t.qElemNo},type:"dimension"})),s.attrExps=jw("qAttrExprInfo",e,n,o,Sb({},i,{value:function(t){return t.qNum},type:"measure"})),s.measures=jw("qMeasureInfo",e,n,o,Sb({},i,{value:function(t){return t.qValue},type:"measure"})),s}))}function Pw(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.key,a=r.data,o=r.config,s=void 0===o?{}:o,u={fields:[],wrappedFields:[],allFields:[],virtualFields:[]},l=a;if(!l)throw new Error('Missing "data" input');if(!l.qDimensionInfo)throw new Error('The "data" input is not recognized as a hypercube');var c=Pw.util,h={cache:u,cube:l,localeInfo:s.localeInfo,fieldExtractor:null,pages:null,hierarchy:function(){return null},virtualFields:s.virtualFields},f={key:function(){return i},raw:function(){return l},field:function(t){return Wb(t,h)},fields:function(){return u.fields.slice()},extract:function(t){return h.extractor(t,f,u,c)},hierarchy:function(t){return h.hierarchy(t,f,u,c)},_cache:function(){return u}};"K"===l.qMode||"T"===l.qMode||!l.qMode&&l.qNodesOnDim?(h.extractor=iw,h.hierarchy=rw,h.pages="K"===l.qMode?l.qStackedDataPages:l.qTreeDataPages):"S"===l.qMode?(h.extractor=Nb,h.pages=l.qDataPages,h.hierarchy=rw):h.extractor=function(){return[]},h.fieldExtractor=function(t){return h.extractor({field:t},f,u,c)};var d="S"===l.qMode?function(t){return t.qElemNumber}:void 0,p="S"===l.qMode?function(t){return t.qNum}:void 0;(t=u.wrappedFields).push.apply(t,pb(jw("qDimensionInfo",l,i,"",Sb({},h,{value:d,type:"dimension"})))),(e=u.wrappedFields).push.apply(e,pb(jw("qMeasureInfo",l,i,"",Sb({},h,{value:p,type:"measure"})))),u.fields=u.wrappedFields.map((function(t){return t.instance}));var g=function t(e){e.forEach((function(e){u.allFields.push(e.instance),t(e.measures),t(e.attrDims),t(e.attrExps)}))};return g(u.wrappedFields),(s.virtualFields||[]).forEach((function(t){var e=f.field(t.from),n=Tw(cb({meta:e.raw(),id:"".concat(i,"/").concat(t.key),sourceField:e,fieldExtractor:function(t){return h.extractor({field:t},f,u,c)},key:t.key,type:e.type(),localeInfo:h.localeInfo,value:e.value},t.override||{}));u.virtualFields.push(n)})),(n=u.allFields).push.apply(n,pb(u.virtualFields)),f}var zw=[["qHyperCube","qHyperCubeDef"],["qTreeData","qTreeDataDef"],["qDimensionInfo","qDimensions"],["qMeasureInfo","qMeasures"],["qAttrDimInfo","qAttributeDimensions"],["qAttrExprInfo","qAttributeExpressions"]],Fw=/\/qDimensionInfo(?:\/(\d+))?/,Lw=/\/qMeasureInfo\/(\d+)/,Bw=/\/qAttrDimInfo\/(\d+)(?:\/(\d+))?/,Hw=/\/qAttrExprInfo\/(\d+)/,$w=/\/?qHyperCube/,Ww=/\/?qTreeData/,Vw=function(t){return"".concat(t.substr(0,t.indexOf("/qHyperCubeDef")+14))},Uw=function(t){return"".concat(t.substr(0,t.indexOf("/qTreeDataDef")+13))};function Yw(t,e){var n=t,r=-1,i=-1,a="",o=function(t){return t};$w.test(t)?(a="".concat(n.substr(0,n.indexOf("qHyperCube")+10)),o=Vw):Ww.test(t)&&(a="".concat(n.substr(0,n.indexOf("qTreeData")+9)),o=Uw);var s=!0;if(Fw.test(t)&&(r=+Fw.exec(t)[1]),Lw.test(t)&&(i=+Lw.exec(t)[1]),Bw.test(t)){i=-1,r=0;var u=+Bw.exec(n)[2];isNaN(u)||(r=u,n=n.replace(/\/\d+$/,"")),s=!1}if(Hw.test(t)){var l=i;if(e){i=0;var c=Bb(a,e);i+=(c.qMeasureInfo||[]).length,r>-1?(i=c.qDimensionInfo.slice(0,r).reduce((function(t,e){return t+e.qAttrExprInfo.length}),i),r=-1):(i=c.qDimensionInfo.reduce((function(t,e){return t+e.qAttrExprInfo.length}),i),i=c.qMeasureInfo.slice(0,l).reduce((function(t,e){return t+e.qAttrExprInfo.length}),i)),i+=+Hw.exec(n)[1]}else r>-1?(r=-1,i=+Hw.exec(n)[1]):i+=+Hw.exec(n)[1]+1}return zw.forEach((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t,e)||gb(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),r=e[0],i=e[1];n=n.replace(r,i)})),s&&(n=o(n)),n&&"/"!==n[0]&&(n="/".concat(n)),{measureIdx:i,dimensionIdx:r,path:n}}function Xw(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=n.byCells,a=n.primarySource,o=[],s={},u=t.isActive(),l=!1;return t.brushes().forEach((function(t){var e=Yw(t.id,r);if("range"===t.type&&e.measureIdx>-1&&e.dimensionIdx>-1){var n=t.brush.ranges();n.length&&(l=!0,s.multiRangeSelectTreeDataValues||(s.multiRangeSelectTreeDataValues={path:e.path,ranges:[]}),n.forEach((function(t){return s.multiRangeSelectTreeDataValues.ranges.push({qMeasureIx:e.measureIdx,qDimensionIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})})))}else{if("range"===t.type&&e.measureIdx>-1){var u=t.brush.ranges();u.length&&(l=!0,s.rangeSelectHyperCubeValues||(s.rangeSelectHyperCubeValues={path:e.path,ranges:[]}),u.forEach((function(t){return s.rangeSelectHyperCubeValues.ranges.push({qMeasureIx:e.measureIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!0}})})))}if("range"===t.type&&e.dimensionIdx>-1){var c=t.brush.ranges();c.length&&(l=!0,s.selectHyperCubeContinuousRange||(s.selectHyperCubeContinuousRange={path:e.path,ranges:[]}),c.forEach((function(t){return s.selectHyperCubeContinuousRange.ranges.push({qDimIx:e.dimensionIdx,qRange:{qMin:t.min,qMax:t.max,qMinInclEq:!0,qMaxInclEq:!1}})})))}if("value"===t.type&&e.dimensionIdx>-1)if(i)if(r&&r.qHyperCube&&("P"===r.qHyperCube.qMode||"T"===r.qHyperCube.qMode||"K"===r.qHyperCube.qMode)){var h=r.qHyperCube,f=h.qNoOfLeftDims,d=h.qEffectiveInterColumnSortOrder.indexOf(e.dimensionIdx);if(s.selectPivotCells||(s.selectPivotCells={path:e.path,cells:[]}),t.id===a||!a){var p=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)}));(0===f||d>=f)&&f>-1?p.forEach((function(t){s.selectPivotCells.cells.push({qType:"T",qCol:t,qRow:d-f})})):p.forEach((function(t){s.selectPivotCells.cells.push({qType:"L",qCol:e.dimensionIdx,qRow:t})})),l=!!s.selectPivotCells.cells.length}}else s.selectHyperCubeCells||(s.selectHyperCubeCells={path:e.path,cols:[]}),s.selectHyperCubeCells.cols.push(e.dimensionIdx),t.id!==a&&(a||s.selectHyperCubeCells.values)||(s.selectHyperCubeCells.values=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)})),l=!!s.selectHyperCubeCells.values.length);else{var g=t.brush.values().map((function(t){return+t})).filter((function(t){return!isNaN(t)}));l=!!g.length,o.push({params:[e.path,e.dimensionIdx,g,!1],method:"selectHyperCubeValues"})}}})),!l&&u?[{method:"resetMadeSelections",params:[]}]:(s.rangeSelectHyperCubeValues&&o.push({method:"rangeSelectHyperCubeValues",params:[s.rangeSelectHyperCubeValues.path,s.rangeSelectHyperCubeValues.ranges,[],null===(e=n.orMode)||void 0===e||e]}),s.selectHyperCubeContinuousRange&&o.push({method:"selectHyperCubeContinuousRange",params:[s.selectHyperCubeContinuousRange.path,s.selectHyperCubeContinuousRange.ranges]}),s.selectHyperCubeCells&&o.push({method:"selectHyperCubeCells",params:[s.selectHyperCubeCells.path,s.selectHyperCubeCells.values,s.selectHyperCubeCells.cols]}),s.selectPivotCells&&o.push({method:"selectPivotCells",params:[s.selectPivotCells.path,s.selectPivotCells.cells]}),s.multiRangeSelectTreeDataValues&&o.push({method:"multiRangeSelectTreeDataValues",params:[s.multiRangeSelectTreeDataValues.path,s.multiRangeSelectTreeDataValues.ranges]}),o)}function Kw(t){Pw.util=t.data("matrix").util,t.data("q",Pw),t.formatter("q-number",Mw),t.formatter("q-time",Ew)}function Gw(t){var e=function(t,e,n){if(void 0===t||void 0===e)return n;for(var r=e.split("."),i=t,a=0;a<r.length;++a){var o=r[a];if(void 0===i[o])return n;i=i[o]}return i}(t.layout||{},t.path.split("/").join("."));if(!e)return!1;var n=e.qIsOneAndOnlyOne;return void 0!==n&&n}function Zw(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(null==t||!t.length)return!1;var e=t.filter((function(t){return"object"===Ay(t.data)&&Array.isArray(t.data.fields)})).every((function(t){return t.data.fields.every((function(t){var e=t.raw();return!(!e.qLocked&&e.qCardinal)}))}));return e}function Jw(t){var e=t.brush,n=t.colorField,r=t.legendAlias,i=t.useLegendCube,a=void 0!==i&&i;!n||/qAttrDimInfo/.test(n)?(e.removeKeyAlias("attrDim/qDimensionInfo/0"),r&&e.removeKeyAlias(r),e.addKeyAlias("attrDim/qDimensionInfo/0","qHyperCube/".concat(n))):a&&e.addKeyAlias(r,"qHyperCube/".concat(n))}Kw.qBrushHelper=Xw,Kw.selections=Xw;var Qw="Shift";function tk(t){var e=t.brush,n=t.getConfig;return{interceptor:function(t){var r=e.brushes(),i=n(),a=i.allowSimultaneous,o=i.layout,s=void 0===o?{}:o;r.forEach((function(n){var r,i,o;("range"===n.type||null!==(r=t[0])&&void 0!==r&&r.key&&(null===(i=t[0])||void 0===i?void 0:i.key)!==n.id&&0!==a.indexOf(null===(o=t[0])||void 0===o?void 0:o.key))&&e.clear([])}));var u=t.filter((function(t){return-2!==t.value}));return u.length>1?function(t){var e=t.layout,n=void 0===e?{}:e,r=t.values,i=void 0===r?[]:r;if(null==i||!i.length)return[];var a=Array.from(new Set(i.map((function(t){return t.key})))),o=[];return a.forEach((function(t){var e=Gw({layout:n,path:t}),r=i.filter((function(e){return e.key===t})),a=e?[r.pop()]:r;o.push.apply(o,jy(a))})),o.filter(Boolean)}({layout:s,values:u}):u},rangeInterceptor:function(t){var r=e.brushes(),i=n().allowSimultaneous;return r.filter((function(t){return"value"===t.type})).length?(e.clear([]),t):(r.forEach((function(n){var r=n.id===t[0].key||i.includes(n.id)&&i.includes(t[0].key);"range"!==n.type||r||e.clear([])})),t)}}}var ek=function t(e,n){return n[e]?t(e+1,n):e},nk=function(t,e){var n=e.reduce((function(t,e){return t[e]=!0,t}),{});return t.reduce((function(t,e,r){var i=ek(r,n);return n[i]=!0,t[r]=i,t}),{})};function rk(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.layout,n=t.filtered,r=void 0===n?{}:n,i=(null==e?void 0:e.qHyperCube)||{},a=i.qDimensionInfo,o=void 0===a?[]:a,s=i.qMeasureInfo,u=void 0===s?[]:s;return{dimensions:nk(o,r.dimensions||[]),measures:nk(u,r.measures||[])}}function ik(t){var e=t.selection,n=t.fieldMap,r=e.method,i=e.params;if("selectHyperCubeValues"===r){var a=n.dimensions[i[1]];void 0!==a&&(i[1]=a)}return"rangeSelectHyperCubeValues"===r&&i[1].forEach((function(t){var e=n.measures[t.qMeasureIx];void 0!==e&&(t.qMeasureIx=e)})),"selectHyperCubeContinuousRange"===r&&i[1].forEach((function(t){var e=n.dimensions[t.qDimIx];void 0!==e&&(t.qDimIx=e)})),e}var ak=[],ok=0,sk=function(t){var e=ak.filter((function(t){var e;return null===(e=t.selections)||void 0===e?void 0:e.isActive()}));e.length&&("Enter"===t.key?e.forEach((function(t){return t.selections.confirm()})):"Escape"!==t.key&&"Esc"!==t.key||e.forEach((function(t){return t.selections.cancel()})))},uk=function(){document.addEventListener("keyup",sk)},lk=function(){document.removeEventListener("keyup",sk)},ck=function(t,e){Object.keys(e).forEach((function(n){t.on(n,e[n])}))},hk=function(t,e){Object.keys(e).forEach((function(n){t.removeListener(n,e[n])}))};function fk(t,e,n){if(e&&void 0!==n&&"selectHyperCubeContinuousRange"===t.method){var r=t.params;if(r&&r[1]&&r[1][0]){var i=r[1][0],a=i.qDimIx,o=i.qRange;"undefined"!==a&&o&&!1===o.qMaxInclEq&&o.qMax>=n&&(o.qMaxInclEq=!0)}}}function dk(t){var e=t.chart,n=t.document,r=t.selectionInfo,i=t.eventName,a=t.componentName,o=t.brushName,s=void 0===o?"selection":o,u=t.emit,l=void 0===u?"rangeClear":u,c=r.event===i,h=n.querySelector("[data-key='".concat(a,"-edge-0']"));if(c||!h)return!1;var f=e.component(a);return!!f&&(f.emit(l),"string"==typeof s&&e.brush(s).clear(),f)}function pk(t){var e=t.selectionInfo,n=t.chart,r=t.document,i=t.eventName,a=void 0===i?"discreteRange":i,o=t.componentName,s=void 0===o?"discrete-range-brush":o,u=t.cleared;return dk({selectionInfo:e,chart:n,document:r,eventName:void 0!==u&&u?void 0:a,componentName:s,emit:"areaClear",brushName:t.brushName})}function gk(t){var e=t.selectionInfo,n=t.chart,r=t.document,i=t.eventName,a=void 0===i?"continuousRange":i,o=t.componentName,s=void 0===o?"continuous-range-brush":o,u=t.cleared;return dk({selectionInfo:e,chart:n,document:r,eventName:void 0!==u&&u?void 0:a,componentName:s,brushName:t.brushName})}function vk(t){var e=t.selectionInfo,n=t.chart,r=t.document,i=t.componentName,a=void 0===i?"minor-range-brush":i,o=t.eventName,s=void 0===o?"minorRange":o,u=t.cleared,l=void 0!==u&&u,c=t.brushName,h=dk({selectionInfo:e,chart:n,document:r,eventName:l?void 0:s,componentName:a,brushName:void 0!==c&&c});if(h){var f=h.settings.settings,d=f.scale,p=f.brush,g=n.scale(d).data().fields.map((function(t){return t.id()})),v=n.brush(p),y=v.brushes().filter((function(t){return"range"===t.type&&g.some((function(e){return e===t.id}))}));v&&y.length&&y.forEach((function(t){v.removeRanges(t.brush.ranges().map((function(e){return{key:t.id,range:e}})))}))}}function yk(t){var e=t.selectionInfo,n=t.chart,r=t.document,i=t.selections,a=t.eventName,o=void 0===a?"xAxis":a,s=t.cleared;dk({selectionInfo:e,chart:n,document:r,eventName:void 0!==s&&s?void 0:o,componentName:"".concat(o,"-range-brush"),emit:"areaClear",brushName:!1})&&i.clear()}function mk(t){var e=t.chart,n=t.selectionInfo,r=t.selections,i=t.events,a=void 0===i?["tap"]:i,o=t.brushNames,s=void 0===o?[]:o;if(n&&a.includes(n.event)){var u=n.currentComponent;n.previousComponent!==u&&(r.clear(),s.forEach((function(t){return e.brush(t).end()})))}}function xk(t){var e=t.selectionInfo,n=t.chart,r=t.document,i=t.selections,a=t.eventName,o=void 0===a?"legendRange":a,s=t.componentName,u=void 0===s?"legend-range-brush":s,l=t.cleared,c=void 0!==l&&l,h=t.brushName;dk({selectionInfo:e,chart:n,document:r,eventName:c?void 0:o,componentName:u,brushName:void 0!==h&&h})&&i.clear()}var bk=["chart","document","selections","selectionInfo"],wk=function(t){t.chart,t.document,t.selections,t.selectionInfo;var e=Iy(t,bk);e.clearDiscrete(),e.clearContinuous(),e.clearMinor(),e.clearRange(),e.clearTap(),e.clearLegend()};function kk(t){var e,n=t.lasso;null!=n&&null!==(e=n.active)&&void 0!==e&&e.call(n)&&(null==n||n.action(!1))}function Mk(t){var e,n=t.chart,r=t.selectionInfo,i=t.selectionActions,a=t.actions,o=void 0===a?{}:a,s=t.selections,u=t.selectionEvents;if(!1===i||!1===u)return function(){};var l=(o||{}).lasso,c=void 0!==l&&l,h=i.reset,f=void 0===h?kk:h,d=i.clear,p=!1!==d&&function(t){var e=t.clear,n=void 0===e?wk:e,r=t.selections,i=t.selectionInfo,a=t.chart;return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cleared,e={selections:r,selectionInfo:i,chart:a,document:document,cleared:t};return n(qy({clearDiscrete:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return pk(qy(qy({},e),t))},clearContinuous:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gk(qy(qy({},e),t))},clearMinor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return vk(qy(qy({},e),t))},clearRange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return yk(qy(qy({},e),t))},clearTap:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return mk(qy(qy({},e),t))},clearLegend:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return xk(qy(qy({},e),t))}},e))}}({clear:d,selections:s,selectionInfo:r,chart:n}),g=function(t){var e=t.chart,n=t.lasso,r=t.reset,i=t.clear,a=!1,o={deactivated:function(t){r({e:t,lasso:n})},canceled:function(t){r({e:t,lasso:n}),i({e:t,chart:e,document:document})},cleared:function(t){a||(a=!0,i({e:t,chart:e,document:document,cleared:!0}),a=!1)}};return!1===r&&delete o.deactivated,!1===i&&delete o.cleared,!1===r&&!1===i&&delete o.canceled,o}({chart:n,clear:p,reset:f,lasso:c}),v={};Object.entries(g).forEach((function(t){var e=Ty(t,2),n=e[0],r=e[1];v[n]=function(t,e){return e?function(n){return e({event:n,defaultFunc:t})}:t}(r,u[n])}));var y=function(t){var e=t.selectionEvents,n=t.selections,r=t.selectionInfo,i=t.clear,a=t.chart,o=t.document,s=e.start,u={selections:n,selectionInfo:r,chart:a,document:o},l=function(t){return Object.assign(r,t||{})},c=function(t){var e=t.event,n=t.components;return function(){return function(t){var e=t.selectionInfo,n=t.clear,r=t.event,i=t.components,a=void 0===i?[]:i;(0,t.setSelectionInfo)(qy(qy({},void 0===e?{}:e),{},{event:r,components:a.map((function(t){return t.key})).filter(Boolean)})),n()}({event:e,components:n,clear:i,chart:a,selectionInfo:r,setSelectionInfo:l})}};return"function"==typeof s?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];s(qy(qy({defaultFunc:c({event:t,components:e}),setSelectionInfo:l,clear:i},u),{},{event:t,components:e}))}:function(t){c({event:t,components:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]})()}}({selectionEvents:u,selections:s,selectionInfo:r,clear:p,chart:n,document:document});return null==o||null===(e=o.select)||void 0===e||e.on("start",y),Object.entries(v).forEach((function(t){var e=Ty(t,2),n=e[0],r=e[1];null==s||s.on(n,r)})),function(){var t;null==o||null===(t=o.select)||void 0===t||t.removeListener("start",y),Object.entries(v).forEach((function(t){var e=Ty(t,2),n=e[0],r=e[1];null==s||s.removeListener(n,r)}))}}var _k=[{key:"qHyperCube/qDimensionInfo/0:numeric",includeMax:!1}];function Sk(t){var e=t.chart,n=t.actions,r=t.selections,i=t.picassoQ,a=t.config,o=a.allowSimultaneous,s=void 0!==o&&o,u=a.majorScale,l=void 0===u?void 0:u,c=a.selectionActions,h=(c=void 0===c?{}:c).clear,f=c.reset,d=a.selectionEvents,p=void 0===d?{deactivated:void 0,canceled:void 0,cleared:void 0,start:void 0}:d,g=a.brushEvents,v=void 0===g?{}:g,y=a.brushName,m=void 0===y?"selection":y,x=a.brushMaxListeners,b=void 0===x?20:x,w=a.brushRanges,k=void 0!==w&&w,M=a.interceptors,_=void 0===M?{}:M,S=a.selectionsFn,C=void 0===S?i.selections:S,R=e.brush(m);if("number"==typeof b&&R.setMaxListeners(b),k){var q=!0===k?_k:k;R.configure({ranges:q})}var N={canSelect:!0,getIsSelectionLocked:!1,isInnerDimensionLocked:!1,lockedDimensions:[],singleSelectIndex:0,selectionInfo:{colorField:void 0,components:[],event:void 0,currentComponent:void 0,previousComponent:void 0}},A=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.selections,r=e.brush,i=e.majorScale,a=e.actions,o=e.selectionsFn,s=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).path,u=void 0===s?"/qHyperCubeDef":s;if(!n)return{layout:function(){},filteredFields:function(){},allowSimultaneous:function(){},release:function(){}};var l=++ok,c=null,h={dimensions:[],measures:[]},f=[],d={};n.on=n.on.bind(n),n.isActive=n.isActive.bind(n),n.addListener=n.addListener.bind(n),n.removeListener=n.removeListener.bind(n);var p=tk({brush:r,getConfig:function(){return{layout:c,allowSimultaneous:f}}}),g=p.rangeInterceptor,v=p.interceptor;r.intercept("set-ranges",g),r.intercept("toggle-ranges",g),r.intercept("toggle-values",v),r.intercept("set-values",v),r.intercept("add-values",v),r.on("start",(function(){return n.begin(u)}));var y={activate:function(){},deactivated:function(){return r.end()},cleared:function(){return r.clear()},canceled:function(){return r.end()}};ck(n,y);var m=null==i||null===(t=i.max)||void 0===t?void 0:t.call(i);return null!=a&&a.select?(a.select.on("start",(function(){var t;r.start(),"function"==typeof a.select.getBrushOptions&&(d=(t=a.select).getBrushOptions.apply(t,arguments))})),a.select.on("end",(function(){var t=o(r,d,c),e=rk({layout:c,filtered:h});t.forEach((function(t){var r=ik({selection:t,fieldMap:e});fk(r,a.select.brushSelectionIncludeMax,m),n.select(r)}))}))):r.on("update",(function(){var t=o(r,d,c),e=rk({layout:c,filtered:h});t.forEach((function(t){n.select(ik({selection:t,fieldMap:e}))}))})),0===ak.length&&uk(),ak.push({key:l,selections:n}),{layout:function(t){c=t},filteredFields:function(t){h=t},allowSimultaneous:function(t){f=t},release:function(){c=null;var t=ak.indexOf(ak.filter((function(t){return t.key===l}))[0]);-1!==t&&ak.splice(t,1),ak.length||lk(),hk(n,y)}}}({brush:R,majorScale:l,actions:n,selections:r,picassoQ:i,selectionsFn:C});!function(t){var e=t.brush,n=t.interceptors,r=void 0===n?{}:n;Object.entries(r).forEach((function(t){var n=Ty(t,2),r=n[0],i=n[1];(Array.isArray(i)?i:[i]).forEach((function(t){e.intercept(r,t)}))}))}({brush:R,interceptors:_});var D=function(t){var e=t.chart,n=t.selectionActions,r=t.brush,i=t.actions,a=t.selectionInfo,o=t.selections,s=t.selectionEvents,u=function(t){var e=t.brush,n=t.chart,r=t.selectionInfo,i=t.brushEvents,a=void 0===i?{}:i,o=Object.entries(a).map((function(t){var i=Ty(t,2),a=i[0],o=i[1],s=function(){return o({chart:n,selectionInfo:r})};return e.on(a,s),[a,s]}));return function(){o.forEach((function(t){var n=Ty(t,2),r=n[0],i=n[1];e.removeListener(r,i)}))}}({brush:r,chart:e,selectionInfo:a,brushEvents:t.brushEvents}),l=Mk({chart:e,selectionInfo:a,selectionActions:n,actions:i,selections:o,selectionEvents:s}),c=function(t){var e=t.actions;if(null==e||!e.lasso)return function(){};var n=!1,r=function(t){n||t.key!==Qw||(e.lasso.action(!0),n=!0)},i=function(t){t.key===Qw&&(e.lasso.action(!1),n=!1)};return document.addEventListener("keydown",r),document.addEventListener("keyup",i),function(){document.removeEventListener("keydown",r),document.removeEventListener("keyup",i)}}({actions:i});return function(){u(),l(),c()}}({chart:e,brush:R,actions:n,selections:r,selectionInfo:N.selectionInfo,selectionActions:{clear:h,reset:f},selectionEvents:p,brushEvents:v});if(s){var O=!0===s?jy(Array(15)).map((function(t,e){return"qHyperCube/qMeasureInfo/".concat(e)})):s;A.allowSimultaneous(O)}return{unbindEvents:D,state:N,picassoSelections:A,brush:R}}var Ck=["colorField","useLegendCube"];function Rk(t){var e=t.chart,n=t.selections,r=t.actions,i=void 0!==r&&r,a=t.config,o=void 0===a?{}:a,s=Sk({chart:e,actions:i,selections:n,picassoQ:Kw,config:o}),u=s.unbindEvents,l=s.state,c=s.picassoSelections,h=s.brush,f=o.custom,d=void 0===f?{}:f,p=o.legendAlias,g=void 0===p?void 0:p,v=o.setBrushAliases,y=void 0===v?Jw:v;return{getIsDimensionLocked:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return l.lockedDimensions[t]},getIsSelectionLocked:function(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return null!==(t=null==n||null===(e=n.isLocked)||void 0===e?void 0:e.call(n))&&void 0!==t?t:Zw(r)},getIsSingleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.singleSelectIndex;return l.singleSelectDimensions[t]},getCanSelect:function(){return l.canSelect},getSelectionInfo:function(){return l.selectionInfo},setLayout:function(t){var e=function(t){var e,n,r,i=t.selections,a=t.picassoSelections,o=t.layout,s={lockedDimensions:[],singleSelectDimensions:[]};null!=i&&null!==(e=i.isModal)&&void 0!==e&&e.call(i)&&i.confirm(),a.layout(o);var u=(null!==(n=null==o?void 0:o.qHyperCube)&&void 0!==n?n:{}).qDimensionInfo,l=void 0===u?[]:u;return s.lockedDimensions=l.map((function(t){return!!t.qLocked})),s.singleSelectDimensions=l.map((function(t,e){return Gw({layout:o,path:"qHyperCube/qDimensionInfo/".concat(e)})})),s.singleSelectIndex=function(t){var e,n=((null==t?void 0:t.qHyperCube)||{}).qDimensionInfo,r=void 0===n?[]:n;return null!==(e=r.map((function(t,e){var n;return!(t.qLocked||(null===(n=t.qCardinalities)||void 0===n?void 0:n.qHypercubeCardinal)<=1)&&e})).filter((function(t){return"number"==typeof t}))[0])&&void 0!==e?e:Math.max(r.length-1,0)}(o),s.canSelect=0===l.length||l.some((function(t){return!t.qLocked})),s.dimensionLocked=!(null===(r=l[0])||void 0===r||!r.qLocked),s}({selections:n,picassoSelections:c,layout:t});Object.assign(l,e)},setFilteredFields:function(t){c.filteredFields(t)},setBrushAliases:function(t){var e=t.colorField,n=t.useLegendCube,r=void 0!==n&&n,i=Iy(t,Ck),a=qy({useLegendCube:r,colorField:e,brush:h,legendAlias:g},i);y(qy(qy({},a),{},{defaultFunc:function(){return Jw(a)}}))},destroy:function(){u(),c.release()},custom:qy({},d)}}function qk(t){const e=t.node.desc&&t.node.desc.share;return e?t.formatter("share")(e):""}function Nk(t){return t.formatter("num")(t.node.data.num.value)}function Ak({data:t}){return t?t.label:""}function Dk(t){if(t.dataPoint.auto)return qk;switch(t.dataPoint.labelMode){case"share":return qk;case"value":return Nk;case"none":return null;default:return qk}}function Ok(t,e,n){const r=(n,r=1)=>({component:"fun",selector:n,strategy:{type:"rows",settings:{align:r,fill:".labelCenter"===n?({node:t})=>e.getContrastingColorTo(t.desc.fill):e.getStyle("","","color"),labels:".labelCenter"===n?[{label:Dk(t)}]:[{label:Ak}],linkData:e=>".labelCenter"===n?"none"===t.dataPoint.labelMode?Math.random():`${e.data.value} ${Dk(t)(e)}`:`${e.data.value} ${Ak(e)}`}}});return{key:"funnel-labels",type:"labels",layout:{displayOrder:2},settings:{sources:[r(".labelLeft",0),r(".labelCenter",.5)]},animations:{enabled:n,trackBy:t=>t.data}}}function Ek(t){if(!t.showDimensionTitle||!t.qHyperCube.qDimensionInfo[0].qFallbackTitle)return!1;return{key:"dimension-title",type:"text",text:t.qHyperCube.qDimensionInfo[0].qFallbackTitle,layout:{dock:"top"}}}function Ik({picasso:e}){const n=t.useElement(),r=t.useSelections(),i=t.useModel(),a=t.useApp(),o=t.useTranslator(),s=t.useOptions(),[u,l]=t.useState(),[c,h]=t.useState(),[f,d]=t.useState(),[p,g]=t.useState();return t.useEffect((()=>{const t=function(t){var e,n,r,i,a=t.picasso,o=t.model,s=t.app,u=t.translator,l=t.layoutService,c=void 0===l?void 0:l,h=t.createConfig,f=void 0===h?nb:h,d=t.config,p=void 0===d?{}:d,g=t.custom,v=void 0===g?{}:g,y=p.localeInfo,m=p.key,x=p.theme,b=void 0===x?void 0:x,w=p.auto,k=void 0===w?void 0:w,M=p.definitionPath,_=null==c||null===(e=c.getLayout)||void 0===e?void 0:e.call(c),S={theme:b,key:m,localeInfo:y,layout:_,hc:null==c||null===(n=c.getHyperCube)||void 0===n?void 0:n.call(c),legendProps:null==c||null===(r=c.getLayoutValue)||void 0===r?void 0:r.call(c,"legend"),colorProps:qy(qy({},null==c||null===(i=c.getLayoutValue)||void 0===i?void 0:i.call(c,"color")),{},{useBaseColors:_?Jx(_):void 0})},C=Gx({picasso:a,model:o,app:s,translator:u,auto:k});!1!==k&&C.auto((function(t){return k?k({layout:t,defaultAuto:eb}):eb(t)}));var R=!1;return{getColor:function(){return C.color()},getPaletteColor:function(t){var e=t.index,n=t.color;return C.resolveUIColor({index:e,color:n})},getData:function(){return C.data()},getDatumProps:function(t){return C.datumProps(t)},getSnapshotData:function(){return C.getSnapshotData(M)},getSettingsForMeasure:function(t){return C.settingsForMeasure(t)},getSettings:function(){return C.settings()},getLegend:function(t,e){return C.legend(t,e)},getScales:function(){return C.scales()},getPalettes:function(){return C.palettes()},isSelectionLocked:function(t){var e=t.isMeasureSelectionLocked;return C.isSelectionLocked({isMeasureSelectionLocked:e})},isInitialized:function(){return R},custom:qy({},v),initialize:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).createConfig,e=(void 0===t?f:t)({getUseBaseColors:Jx}),n=Qx(S,e);return C.config(n),C.getAuxiliarySettings(M).then((function(){R=!0}))}}}({picasso:e,model:i,app:a,translator:o,config:{auto:!1,key:"fill"}});n.style.overflow="hidden";const u=e({renderer:{prio:[s.renderer||"svg"]}}).chart({element:n,data:[],settings:{}}),c=Rk({chart:u,selections:r,config:{selectionActions:!1}});return d(c),h(t),l(u),g(function(){var t={};return{get:function(e){return t[e]},set:function(e,n){return t[e]=n,n},has:function(e){return e in t},remove:function(e){delete t[e]},empty:function(){t={}}}}()),()=>{c.destroy(),u.destroy()}}),[]),[u,c,f,p]}function Tk({picasso:e,flags:n}){const r=t.useStaleLayout(),i=t.useTheme(),a=t.useConstraints(),o=t.useRect(),s=t.usePlugins(),u=t.useAppLayout().qLocaleInfo,[l,c,h,f]=Ik({picasso:e,layout:r}),d=t.useOptions(),p=()=>{const t=l.element.clientWidth!==f.get("width")||l.element.clientHeight!==f.get("height");return!1!==d.chartAnimations&&n.isEnabled("IM_1355_ANIMATIONS_FUNNEL")&&!a.active&&!t},[g]=t.usePromise((()=>{if(!c)return Promise.resolve();const t=function(t){return{layout:t,keys:{SCALE:{FILL:"fill"},COMPONENT:{FUNNEL:"fun",FUNNEL_LABELS:"funnel-labels",DIMENSION_TITLE:"dimension-title"}}}}(r),n=function(t){var e=t.picassoInstance,n=t.plugins,r=t.pluginArgs,i=void 0===r?{}:r,a={initialized:!1,definitions:[]};return{initialize:function(){return Oy(Ny().mark((function t(){var r,o,s,u;return Ny().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a.initialized){t.next=2;break}return t.abrupt("return");case 2:return o=Promise.all(n.filter((function(t){return"custom-component"===t.info.type})).map(function(){var t=Oy(Ny().mark((function t(n){var r;return Ny().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.info.componentName){t.next=2;break}throw new Error("plugin-service: Custom component is missing componentName");case 2:return t.next=4,n.fn(qy({},i));case 4:if("object"===Ay(r=t.sent)){t.next=7;break}throw new Error("plugin-service: Custom component needs to be an object");case 7:e.component(n.info.componentName,r);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),s=Promise.all(n.filter((function(t){return"component-definition"===t.info.type})).map((function(t){return t.fn(qy({},i))}))),t.next=6,Promise.all([o,s]);case 6:u=t.sent,a.initialized=!0,(r=a.definitions).push.apply(r,jy(u[1]));case 9:case"end":return t.stop()}}),t)})))()},extendComponents:function(t){return a.initialized?(a.definitions.filter(Boolean).forEach((function(e){var n=Ty(t.filter((function(t){return t.key&&t.key===e.key})),1)[0];if(n){var r=Yy(!0,{},n.brush);Yy(!0,n,e),e.brush&&(n.brush=function(t,e){return"object"===Ay(t)&&Object.keys(t).length?(Array.isArray(e.consume)&&(t.consume=rb({originalArray:t.consume,newArray:e.consume,matchKey:"context"})),Array.isArray(e.trigger)&&(t.trigger=rb({originalArray:t.trigger,newArray:e.trigger,matchKey:"on"})),t):e}(r,e.brush))}else t.push(e)})),t):t}}}({picassoInstance:e,plugins:s,pluginArgs:t});return Promise.all([c.initialize({createConfig:({getUseBaseColors:t})=>({theme:i,colorProps:{...r.color,useBaseColors:t(r)},layout:r,hc:r.qHyperCube})}),n.initialize()]).then((()=>n))}),[r,c]);t.useEffect((()=>{if(!l||!c||!g)return;const t=[{type:"q",key:"qHyperCube",data:r.qHyperCube,config:{localeInfo:u}},...c.getData()],e=function({layout:t,constraints:e,colorService:n,theme:r,pluginService:i,animationsEnabled:a}){const o=function(t){return{...t.getScales()}}(n),s=n.getPalettes(),u=[function({layout:t,constraints:e,colorService:n,animationsEnabled:r}){const i=n.getDatumProps(),a=n.getColor();return{type:"funnel",key:"fun",data:{extract:{field:"qDimensionInfo/0",props:{num:{field:"qMeasureInfo/0"},...i}}},brush:e.select||e.active?{}:{trigger:[{contexts:["selection"],data:[""]}],consume:[{context:"selection",filter:t=>"section"===t.tag,style:{inactive:{opacity:.3}}}]},settings:{num:{ref:"num"},fill:a,mode:t.funnel.mode},animations:{enabled:r,isMainComponent:!0,trackBy:t=>`${t.tag}: ${t.data.value}`}}}({layout:t,constraints:e,colorService:n,animationsEnabled:a}),Ok(t,r,a),Ek(t)];return{palettes:s,style:{"$font-family":r.getStyle("","","fontFamily"),"$font-color":r.getStyle("","","color"),"$font-size":r.getStyle("","","fontSize")},scales:o,components:i.extendComponents(u),formatters:{share:{type:"d3-number",format:".1%"},num:{data:{field:"qMeasureInfo/0"}}}}}({layout:r,constraints:a,colorService:c,theme:i,pluginService:g,animationsEnabled:p});l.update({data:t,settings:e}),f.set("width",l.element.clientWidth),f.set("height",l.element.clientHeight)}),[l,c,i.name(),g,a]),t.useEffect((()=>{l&&(l.update(),f.set("width",l.element.clientWidth),f.set("height",l.element.clientHeight))}),[o.width,o.height]),t.useEffect((()=>{h&&h.setLayout(r)}),[r]),t.onTakeSnapshot((t=>c.getSnapshotData().then((e=>(t.snapshotData=t.snapshotData||{},t.snapshotData.content=t.snapshotData.content||{},t.snapshotData.content.chartData=e,t))).catch((()=>t))))}return function(t){const e=gg();e.use(py),e.component("funnel",My);const{flags:n}=t;return{ext:Sy,qae:{properties:{initial:_y},data:{targets:Cy}},component(){Tk({picasso:e,flags:n})}}}}));
