$qvdFilePath = "C:\path\to\file.qvd"

$qvdReader = [System.IO.BinaryReader]::new([System.IO.File]::OpenRead($qvdFilePath))

$headerSize = $qvdReader.ReadInt32()
$headerText = [System.Text.Encoding]::ASCII.GetString($qvdReader.ReadBytes($headerSize))

$qvdReader.Close()

$pattern = "(?s)<QvdTableHeader>.*</QvdTableHeader>"
$headerTextClean = [regex]::Match($headerText, $pattern).Value

if ($headerTextClean -ne "") {
    Write-Output "Header: $headerTextClean"
} else {
    Write-Output "No header found in the QVD file."
}
