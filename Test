# Set the remote server name and directory to search
$server = "remoteServerName"
$searchPath = "C:\QVDs"

# Create a session to the remote server
$session = New-PSSession -ComputerName $server

# Delete QVD files with NoOfRecords property equal to 0
Invoke-Command -Session $session -ScriptBlock {
    Get-ChildItem $args[0] -Recurse -Include *.qvd | Where-Object { (Get-Content $_.FullName -TotalCount 3)[2] -eq "NoOfRecords=0" } | Remove-Item -Force -Verbose
} -ArgumentList $searchPath

# Close the session
Remove-PSSession $session
