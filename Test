# Set the directory to search for QVD files
$searchPath = "C:\QVDs"

# Get all QVD files in the search directory
$qvdFiles = Get-ChildItem -Path $searchPath -Recurse -Include *.qvd

# Loop through each QVD file and check if it has only column headers
foreach ($qvdFile in $qvdFiles) {
    $fileContent = Get-Content $qvdFile.FullName -TotalCount 3
    if ($fileContent[2] -eq "NoOfRecords=0") {
        Write-Host "QVD file $($qvdFile.Name) has only column headers and no data."
    }
}
