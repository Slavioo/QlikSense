// Define the root directory to search for QVD files
LET RootDirectory = 'C:\Qlik\Data';

// Load all QVD files in the root directory and its subdirectories
FOR Each vFolder in DirList(RootDirectory & '\*', 0, 1)
    FOR Each vFileExtension in 'qvd'
        FOR Each vFileName in FileList(vFolder & '\*' & vFileExtension)
            // Load the QVD file
            $(Must_Include=$(vFileName));
            
            // Check if the QVD file has zero records
            If NoOfRows('$(vFileName)') = 0 Then
                // Write the file path to a CSV file
                Store $(vFileName) into [$(RootDirectory)\ZeroRecordQVDs.csv] (txt, delimiter is ',', no quotes);
            EndIf
        NEXT vFileName
    NEXT vFileExtension
NEXT vFolder
