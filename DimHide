define(["qlik", "jquery", "text!./style.css", "text!./template.html"], function (qlik, $, cssContent, template) {
  'use strict';
  $("<style>").html(cssContent).appendTo("head");

  return {
    template: template,
    initialProperties: {
      qHyperCubeDef: {
        qDimensions: [],
        qMeasures: [],
        qInitialDataFetch: [{
          qWidth: 10,
          qHeight: 50
        }]
      }
    },
    definition: {
      type: "items",
      component: "accordion",
      items: {
        dimensions: {
          uses: "dimensions",
          min: 1
        },
        measures: {
          uses: "measures",
          min: 0
        },
        sorting: {
          uses: "sorting"
        },
        settings: {
          uses: "settings",
          items: {
            hideFirstColumn: {
              ref: "qHyperCubeDef.hideFirstColumn",
              type: "boolean",
              label: "Hide First Column",
              defaultValue: false
            }
          }
        }
      }
    },
    support: {
      snapshot: true,
      export: true,
      exportData: true
    },
    paint: function ($element, layout) {
      var hideFirstColumn = layout.qHyperCubeDef.hideFirstColumn;

      if (hideFirstColumn) {
        $element.find("th:first-child, td:first-child").hide();
      } else {
        $element.find("th:first-child, td:first-child").show();
      }

      return qlik.Promise.resolve();
    },
    controller: ['$scope', function ($scope) {

    }]
  };
});
