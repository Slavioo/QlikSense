$folderPath = "C:\QVDs" # Replace with your folder path
$filePattern = "*.qvd" # Replace with your file extension

# Loop through each file in the directory
Get-ChildItem -Path $folderPath -Filter $filePattern | ForEach-Object {
    try {
        # Load only the QvdTableHeader element into memory
        $xmlDoc = New-Object System.Xml.XmlDocument
        $xmlDoc.Load($_.FullName)
        $qvdTableHeader = $xmlDoc.SelectSingleNode("//QvdTableHeader")

        # Extract the NoOfRecords value from the QvdTableHeader element
        $noOfRecords = $qvdTableHeader.SelectSingleNode("NoOfRecords").InnerText

        # Output the file name if the NoOfRecords value is zero
        if ($noOfRecords -eq "0") {
            Write-Host "$($_.Name) - NoOfRecords: $noOfRecords"
        }
    }
    catch {
        # Handle the error if the file cannot be loaded
        Write-Host "Error loading file: $($_.FullName) - $($_.Exception.Message)"
    }
}
