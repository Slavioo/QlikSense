$folderPath = "C:\QVDs" # Replace with your folder path
$filePattern = "*.qvd" # Replace with your file extension

# Loop through each file in the directory
Get-ChildItem -Path $folderPath -Filter $filePattern | ForEach-Object {
    # Load the QVD file as an XML document
    $xml = New-Object -TypeName System.Xml.XmlDocument
    $xml.Load($_.FullName)

    # Get the NoOfRecords value from the QvdTableHeader element
    $noOfRecords = $xml.SelectSingleNode("//QvdTableHeader/NoOfRecords").InnerText

    # Output the file name and NoOfRecords value
    Write-Host "$($_.Name) - NoOfRecords: $noOfRecords"
}
