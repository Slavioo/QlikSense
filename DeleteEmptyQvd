$folderPath = "C:\QVDs" # Replace with your folder path
$filePattern = "*.qvd" # Replace with your file extension

# Loop through each file in the directory
Get-ChildItem -Path $folderPath -Filter $filePattern | ForEach-Object {
    # Check if first record has data
    $hasData = $false
    $fileContent = Get-Content $_.FullName
    $firstRecord = $fileContent[1]
    $firstRecordData = $firstRecord -split '\t'
    foreach ($data in $firstRecordData) {
        if ($data -ne '') {
            $hasData = $true
            break
        }
    }
    if (!$hasData) {
        # Delete the file
        Remove-Item $_.FullName
        Write-Host "Deleted file: $($_.Name)"
    }
}
