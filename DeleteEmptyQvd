$directoryPath = "C:\QVDFiles"
$files = Get-ChildItem $directoryPath -Filter *.qvd -Recurse

foreach ($file in $files) {
    $content = Get-Content $file.FullName
    $startIndex = $content.IndexOf("<QvdTableHeader>")
    $endIndex = $content.IndexOf("</QvdTableHeader>") + "</QvdTableHeader>".Length
    $headerContent = $content.Substring($startIndex, $endIndex - $startIndex)
    $noOfRecordsStartIndex = $headerContent.IndexOf("<NoOfRecords>") + "<NoOfRecords>".Length
    $noOfRecordsEndIndex = $headerContent.IndexOf("</NoOfRecords>")
    if ($noOfRecordsEndIndex - $noOfRecordsStartIndex -gt 0) {
        $propertyValue = $headerContent.Substring($noOfRecordsStartIndex, $noOfRecordsEndIndex - $noOfRecordsStartIndex)
        Write-Output "File $($file.Name) has NoOfRecords value of $propertyValue"
    } else {
        Write-Output "File $($file.Name) does not have a NoOfRecords property."
    }
}
