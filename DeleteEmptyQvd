$folderPath = "C:\QVDs" # Replace with your folder path
$filePattern = "*.qvd" # Replace with your file extension

# Loop through each file in the directory
Get-ChildItem -Path $folderPath -Filter $filePattern | ForEach-Object {
    # Use Select-Xml to extract the NoOfRecords value from the QvdTableHeader element
    $noOfRecords = Select-Xml -Path $_.FullName -XPath "//QvdTableHeader/NoOfRecords" | Select-Object -ExpandProperty Node

    # Output the file name if the NoOfRecords value is zero
    if ($noOfRecords -eq "0") {
        Write-Host "$($_.Name) - NoOfRecords: $noOfRecords"
    }
}
