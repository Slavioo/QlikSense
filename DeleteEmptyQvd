$folderPath = "C:\QVDs" # Replace with your folder path
$filePattern = "*.qvd" # Replace with your file extension

# Loop through each file in the directory
Get-ChildItem -Path $folderPath -Filter $filePattern | ForEach-Object {
    # Load the QVD file as an XML document
    $xml = New-Object -TypeName System.Xml.XmlDocument
    $xmlText = [System.IO.File]::ReadAllText($_.FullName)
    $xmlText = $xmlText -replace "\x00", "" # Remove null bytes
    $xml.LoadXml($xmlText)

    # Get the NoOfRecords value from the QvdTableHeader element
    $noOfRecords = $xml.SelectSingleNode("//QvdTableHeader/NoOfRecords").InnerText

    # Output the file name if the NoOfRecords value is zero
    if ($noOfRecords -eq "0") {
        Write-Host "$($_.Name) - NoOfRecords: $noOfRecords"
    }
}
