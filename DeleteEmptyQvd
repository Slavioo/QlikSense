$qvdFilePath = "C:\path\to\file.qvd"
$qvdHeaderStart = "<QvdTableHeader"
$qvdHeaderEnd = "</QvdTableHeader>"

# Open the QVD file and seek to the start of the QvdTableHeader section
$qvdFileStream = New-Object System.IO.FileStream($qvdFilePath, [System.IO.FileMode]::Open)
$qvdStreamReader = New-Object System.IO.StreamReader($qvdFileStream)

while ($qvdStreamReader.ReadLine() -notmatch $qvdHeaderStart) {}

# Read the QvdTableHeader section into a string
$qvdHeaderString = ""
while ($line = $qvdStreamReader.ReadLine()) {
    if ($line -match $qvdHeaderEnd) {
        $qvdHeaderString += $line
        break
    }
    $qvdHeaderString += $line
}

# Close the file streams
$qvdStreamReader.Close()
$qvdFileStream.Close()

# Load the QvdTableHeader section as an XML document
$xmlDoc = New-Object System.Xml.XmlDocument
$xmlDoc.LoadXml($qvdHeaderString)

# Extract the NoOfRecords property value
$noOfRecords = $xmlDoc.QvdTableHeader.NoOfRecords

# Output the NoOfRecords value
Write-Host "NoOfRecords: $noOfRecords"
