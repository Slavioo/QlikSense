$qvdFolder = "C:\path\to\qvd\folder"
foreach ($qvdFile in Get-ChildItem $qvdFolder -Filter "*.qvd") {
    $xmlDoc = New-Object System.Xml.XmlDocument
    $xmlDoc.XmlResolver = $null
    $xmlDoc.LoadXml("<QvdTableHeader></QvdTableHeader>")
    $reader = New-Object System.Xml.XmlTextReader($qvdFile.FullName)
    $reader.XmlResolver = $null
    while ($reader.Read()) {
        if ($reader.NodeType -eq [System.Xml.XmlNodeType]::Element -and $reader.Name -eq "QvdTableHeader") {
            $xml = $reader.ReadOuterXml()
            $xmlDoc.LoadXml($xml)
            break
        }
    }
    $reader.Close()
    $noOfRecords = $xmlDoc.QvdTableHeader.NoOfRecords
    Write-Host "Number of records in $($qvdFile.Name): $noOfRecords"
}
