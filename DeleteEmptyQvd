$folderPath = "C:\QVDs" # Replace with your folder path
$filePattern = "*.qvd" # Replace with your file extension

# Loop through each file in the directory
Get-ChildItem -Path $folderPath -Filter $filePattern | ForEach-Object {
    # Check if file has only headers
    $hasData = $false
    $fileContent = Get-Content $_.FullName
    $header = $fileContent[0]
    $data = $fileContent | Select-Object -Skip 1
    if ($data -ne $null) {
        foreach ($line in $data) {
            if ($line -ne $header) {
                $hasData = $true
                break
            }
        }
    }
    if (!$hasData) {
        # Delete the file
        Remove-Item $_.FullName
        Write-Host "Deleted file: $($_.Name)"
    }
}
