DECLARE @ColumnsCSV NVARCHAR(MAX)

-- Execute the stored procedure with the RequestId parameter
EXEC YourStoredProcedure @RequestId = 0

-- Retrieve the column metadata using sys.dm_exec_describe_first_result_set
SELECT @ColumnsCSV = COALESCE(@ColumnsCSV + ',', '') + name
FROM sys.dm_exec_describe_first_result_set(N'EXEC YourStoredProcedure @RequestId = 0', NULL, 0)
WHERE is_hidden = 0

-- Store the CSV string in a single column of another table
INSERT INTO YourResultTable (ColumnNameCSV)
VALUES (@ColumnsCSV)
